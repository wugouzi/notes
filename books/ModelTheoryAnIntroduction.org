#+TITLE: Model Theory for Dummies: An Introduction
#+AUTHOR: David Marker


#+LATEX_HEADER: \input{preamble.tex}
#+EXPORT_FILE_NAME: ../latex/ModelTheoryAnIntroduction/ModelTheoryAnIntroduction.tex
#+LATEX_HEADER: \graphicspath{{../../books/}}
#+STARTUP: noindent
#+STARTUP: overview
#+LATEX_HEADER: \def \Pr {\text{Pr}}
#+LATEX_HEADER: \def \RM {\text{RM}}
* Structures and Theories
** Languages and Structures
   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   A language $\call$ is given by specifying the following data
   1. A set of function symbols $\calf$ and positive integers $n_f$ for each
      $f\in\calf$
   2. a set of relation symbols $\calr$ and positive integers $n_R$ for each
      $R\in\calr$
   3. a set of constant symbols $\calc$
   #+END_definition

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   An \(\call\)-structure $\calm$ is given by the following data
   1. a nonempty set $M$ called the *universe*, *domain* or *underlying set*
      of $\calm$
   2. a function $f^{\calm}:M^{n_f}\to M$ for each $f\in\calf$
   3. a set $R^{\calm}\subseteq M^{n_R}$ for each $R\in\calr$
   4. an element $c^{\calm}\in M$ for each $c\in\calc$
   #+END_definition

   We refer to $f^{\calm},R^{\calm},c^{\calm}$ as the *interpretations* of the
   symbols $f,R$ and $c$. We often write the structure as
   $\calm=(M,f^{\calm},R^{\calm},c^{\calm}:f\in\calf,R\in\calr,c\in\calc)$

   [[index:\(\call\)-embedding]]
   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   Suppose that $\calm$ and $\caln$ are \(\call\)-structures with universes $M$
   and $N$ respectively. An *\(\call\)-embedding* $\eta:\calm\to\caln$ is a
   one-to-one map $\eta:M\to N$ that
   1. $\eta(f^{\calm}(a_1,\dots,a_{n_f}))=f^{\caln}(\eta(a_1),\dots,\eta(a_{n_f}))$
      for all $f\in\calf$ and $a_1,\dots,a_{n_f}\in M$
   2. $(a_1,\dots,a_{m_R})\in R^{\calm}$ if and only if
      $(\eta(a_1),\dots,\eta(a_{m_R}))\in R^{\caln}$ for all $R\in\calr$ and
      $a_1,\dots,a_{m_R}\in M$
   3. $\eta(c^{\calm})=c^{\caln}$ for $c\in\calc$
   #+END_definition


   [[index:substructure]]
   A bijective \(\call\)-embedding is called an *\(\call\)-isomorphism*. If
   $M\subseteq N$ and the inclusion map is an \(\call\)-embedding, we say either
   $\calm$ is a *substrcture* of $\caln$ or that $\caln$ is an *extension*
   of $\calm$

   The *cardinality* of $\calm$ is $\abs{M}$, the cardinality of the universe of \(\calm\)

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   The set of *\(\call\)-terms* is the smallest set $\calt$ s.t.
   1. $c\in\calt$ for each constant symbol $c\in\calc$
   2. each variable symbol $v_i\in\calt$ for $i=1,2,\dots$
   3. if $t_1,\dots,t_{n_f}\in\calt$ and $f\in\calf$ then
      $f(t_1,\dots,n_{n_f})\in\calt$ 
   #+END_definition


   Suppose that $\calm$ is an \(\call\)-structure and that $t$ is a term built
   using variables from $\bar{v}=(v_{i_1},\dots,v_{i_m})$. We want to interpret
   $t$ as a function $t^{\calm}:M^m\to M$. For $s$ a subterm of $t$ and
   $\bar{a}=(a_{i_1},\dots,a_{i_m})\in M$, we inductively define
   $s^{\calm}(\bar{a})$ as follows.
   1. If $s$ is a constant symbol $c$, then $s^{\calm}(\bar{a})=c^{\calm}$
   2. If $s$ is the variable $v_{i_j}$, then $s^{\calm}(\bar{a})=a_{i_j}$
   3. If $s$ is the term $f(t_1,\dots,t_{n_f})$, where $f$ is a function symbol
      of $\call$ and $t_1,\dots,t_{n_f}$ are terms, then 
      $s^{\calm}(\bar{a})=f^{\calm}(t^{\calm}_1(\bar{a}),\dots,t_{n_f}^{\calm}(\bar{a}))$

      
   The function $t^{\calm}$ is defined by $\bar{a}\mapsto t^{\calm}(\bar{a})$

   [[index:atomic formula]]
   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   \phi is an *atomic* *\(\call\)-formula* if \phi is either
   1. $t_1=t_2$ where $t_1$ and $t_2$ are terms
   2. $R(t_1,\dots,t_{n_R})$


   The set of *\(\call\)-formulas* is the smallest set $\calw$ containing the
   atomic formulas s.t.
   1. if $\phi\in\calw$, then $\neg\phi\in\calw$
   2. if $\phi,\psi\in\calw$, then $(\phi\wedge\psi),(\phi\vee\psi)\in\calw$
   3. if $\phi\in\calw$, then $\exists v_i\phi,\forall v_i\phi\in\calw$
   #+END_definition

   We say a variable $v$ *occurs freely* in a formula \phi if it is not
   inside a $\exists v$ or $\forall v$ quantifier; otherwise we say that it's
   *bound*. We call a formula a *sentence* if it has no free variables. We
   often write $\phi(v_1,\dots,v_n)$ to make explicit the free variables in \phi

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   Let \phi be a formula with free variables from
   \(\bar{v}=(v_{i_1},\dots,v_{i_m})\)
    and let
    $\bar{a}=(a_{i_1},\dots,a_{i_m})\in M^m$. We inductively define
    $\calm\vDash\phi\bar{a}$ as follows
   1. If \phi is $t_1=t_2$, then $\calm\vDash\phi(\bar{a})$ if
      $t_1^{\calm}(\bar{a})=t_2^{\calm}(\bar{a})$ 
   2. If \phi is $R(t_1,\dots,t_{m_R})$ then $\calm\vDash\phi(\bar{a})$ if
      $(t_1^{\calm}(\bar{a}),\dots,t_{m_R}^{\calm}(\bar{a}))\in R^{\calm}$
   3. If \phi is $\neg\psi$ then $\calm\vDash\phi(\bar{a})$ if
      $\calm\not\vDash\psi(\bar{a})$
   4. If \phi is $(\psi\wedge\theta)$ then $\calm\vDash\phi(\bar{a})$ if
      $\calm\vDash\psi(\bar{a})$ and
      $\calm\vDash\theta(\bar{a})$
   5. If \phi is $(\psi\vee\theta)$ then $\calm\vDash\phi(\bar{a})$ if
      $\calm\vDash\psi(\bar{a})$ or
      $\calm\vDash\theta(\bar{a})$
   6. If \phi is $\exists v_j\psi(\bar{v},v_j)$ then $\calm\vDash\phi(\bar{a})$
      if there is $b\in M$ s.t. $\calm\vDash\psi(\bar{a},b)$
   7. If \phi is $\forall v_j\psi(\bar{v},v_j)$ then $\calm\vDash\phi(\bar{a})$
      if $\calm\vDash\psi(\bar{a},b)$ for all $b\in M$
   #+END_definition


   If $\calm\vDash\phi(\bar{a})$ we say that $\calm$ *satisfies*
   $\phi(\bar{a})$ or $\phi(\bar{a})$ is *true* in $\calm$

   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   label:prop1.1.8
   Suppose that $\calm$ is a substrcture of $\caln$, $\bar{a}\in M$ and
   $\phi(\bar{v})$ is a quantifier-free formula. Then
   $\calm\vDash\phi(\bar{a})$ if and only if $\caln\vDash\psi(\bar{a})$
   #+END_proposition

   #+BEGIN_proof
   *Claim* If $t(\bar{v})$ is a term and $\bar{b}\in M$ then
   $t^{\calm}(\bar{b})=t^{\caln}(\bar{b})$. 
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   We say that two \(\call\)-strctures $\calm$ and $\caln$ are *elementarily*
   *equivalent* and write $\calm\equiv\caln$ if
   \begin{equation*}
    \calm\vDash\phi\text{ if and only if } \caln\vDash\phi
   \end{equation*}
   for all \(\call\)-sentences \phi
   #+END_definition

   [[index:full theory]]
   We let $\Th(\calm)$, the *full theory* of $\calm$ be the set of
   \(\call\)-sentences \phi s.t. $\calm\vDash\phi$

   #+ATTR_LATEX: :options []
   #+BEGIN_theorem
   label:thm1.1.10
   Suppose that $j:\calm\to\caln$ is an isomorphism. Then $\calm\equiv\caln$
   #+END_theorem

   #+BEGIN_proof
   Show by induction on formulas that $\calm\vDash\phi(a_1,\dots,a_n)$ if and
   only if $\caln\vDash\phi(j(a_1),\dots,j(a_n))$ for all formulas \phi
   #+END_proof
** Theories
   [[index:model]]
   [[index:satisfiable]]
   Let $\call$ be a language. An *\(\call\)-theory* $T$ is a set of
   \(\call\)-sentences. We say that $\calm$ is a *model* of $T$ and write
   $\calm\vDash T$ if $\calm\vDash\phi$ for all sentences $\phi\in T$. A
   theory is *satisfiable* if it has a model.

   [[index:elementary class]]
   A class of \(\call\)-structures $\calk$ is an *elementary class* if there
   is an \(\call\)-theory $T$ s.t. $\calk=\{\calm:\calm\vDash T\}$
   #+ATTR_LATEX: :options [Linear Orders]
   #+BEGIN_examplle
   Let \(\call=\{<\}\), where < is a binary relation symbol. The class of linear
   order is axiomatized by the \(\call\)-sentences
   \begin{align*}
   &\forall x\;\neg(x<x)\\
   &\forall x\forall y\forall z\;((x<y\wedge y<z)\to x<z)\\
   &\forall x\forall y\;(x<y\vee x=y\vee y<x)
   \end{align*}
   #+END_examplle

   #+ATTR_LATEX: :options [Groups]
   #+BEGIN_examplle
   Let $\call=\{\cdot,e\}$ where $\cdot$ is a binary function symbol and $e$ is a 
   constant symbol. The class of groups is axiomatized by
   \begin{align*}
   &\forall x\;e\cdot x=x\cdot e=x\\
   &\forall x\forall y\forall z\;x\cdot(y\cdot z)=(x\cdot y)\cdot z\\
   &\forall x\exists y\;x\cdot y=y\cdot x= e
   \end{align*}
   #+END_examplle

   #+ATTR_LATEX: :options [Ordered Abelian Groups]
   #+BEGIN_examplle
   Let \(\call=\{+,<,0\}\), where + is a binary function, < is a binary relation
   symbol, and 0 is a constant symbol. The axioms for order groups are
   1. the axioms for additive groups
   2. the axioms for linear orders
   3. \(\forall x\forall y\forall z(x<y\to x+z<y+z)\)
   #+END_examplle

   #+ATTR_LATEX: :options [Left \(R\)-modules]
   #+BEGIN_examplle
   Let $R$ be a ring with multiplicative identity 1. Let
   $\call=\{+,0\}\cup\{r:r\in R\}$ where $+$ is a binary function symbol, 0 is a
   constant, and $r$ is a unary function symbol for $r\in R$. In an
   \(R\)-module, we will interpret $r$ as scalar multiplication by $R$. The
   axioms for \(R\)-modules are
   \begin{align*}
   &\forall x\e r(x+y)=r(x)+r(y)\text{ for each }r\in R\\
   &\forall x\e (r+s)(x)=r(x)+s(x)\text{ for each }r,s\in R\\
   &\forall x\e r(s(x))=rs(x)\text{ for } r,s\in R\\
   &\forall x\e 1(x)=x
   \end{align*}
   #+END_examplle
   [[index:ACF]]
   #+ATTR_LATEX: :options [Rings and Fields]
   #+BEGIN_examplle
   Let $\call_r$ be the language of rings $\{+,-,\cdot,0,1\}$, where $+,-$ and $\cdot$
   are binary function symbols and $0$ and $1$ are constants. The axioms for rings are given 
   by
   \begin{align*}
   &\forall x\forall y\forall z\;(x-y=z\leftrightarrow x=y+z)\\
   &\forall x\;x\cdot 0=0\\
   &\forall x\forall y\forall z\;x\cdot(y\cdot z)=(x\cdot y)\cdot z\\
   &\forall x\;x\cdot 1=1\cdot x=x\\
   &\forall x\forall y\forall z\;x\cdot(y+z)=(x\cdot y)+(x\cdot z)\\
   &\forall x\forall y\forall z\;(x+y)\cdot z=(x\cdot z)+(y\cdot z)
   \end{align*}
   We axiomatize the class of fields by adding
   \begin{align*}
   &\forall x\forall y\;x\cdot y=y\cdot x\\
   &\forall x\;(x\neq 0\to\exists y\;x\cdot y=1)
   \end{align*}
   We axiomatize the class of algebraically closed fields by adding to the field axioms the sentences
   \begin{equation*}
   \forall a_0\dots\forall a_{n-1}\exists x\;x^n+\displaystyle\sum_{i=1}^{n-1}
   a_ix^i=0
   \end{equation*}
   for $n=1,2,\dots$. Let \(\ACF\) be the axioms for algebraically closed fields.

   Let $\psi_p$ be the \(\call_r\)-sentence
   $\forall x\;\underbrace{x+\dots+x}_{p\text{-times}}=0$, which asserts that a field has characteristic
   $p$. For $p>0$ a prime, let $\ACF_p=\ACF\cup\{\psi_p\}$ and
   $\ACF_0=\ACF\cup\{\neg\psi_p:p>0\}$ be the theories of algebraically
   closed fields of characteristic $p$ and zero respectively
   #+END_examplle

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   Let $T$ be an \(\call\)-theory and \phi an \(\call\)-sentence. We say that
   \phi is a *logical consequence* of $T$ and write $T\vDash\phi$ if
   $\calm\vDash\phi$ whenever $\calm\vDash T$
   #+END_definition

   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   1. Let $\call=\{+,<,0\}$ and let $T$ be the theory of ordered abelian groups.
      Then $\forall x(x\neq 0\to x+x\neq 0)$ is a logical consequence of $T$
   2. Let $T$ be the theory of groups where every element has order 2. Then\par
      $T\not\vDash\exists x_1\exists x_2\exists x_3(x_1\neq x_2\wedge x_2\neq x_3\wedge x_1\neq x_3)$
   #+END_proposition

   #+BEGIN_proof
   2. \(\Z/2\Z\vDash T\wedge\neg\exists x_1\exists x_2\exists x_3(x_1\neq x_2\wedge x_2\neq x_3\wedge x_1\neq x_3)\)
   #+END_proof
** Definable Sets and Interpretability
   [[index:definable]]
   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   Let $\calm=(M,\dots)$ be an \(\call\)-structure. We say that $X\subseteq M^n$
   is *definable* if and only if there is an \(\call\)-formula 
   $\phi(v_1,\dots,v_n,w_1,\dots,w_m)$ and $\bar{b}\in M^b$ s.t. 
   $X=\{\bar{a}\in M^n:\calm\vDash\phi(\bar{a},\bar{b})\}$. We say that
   $\phi(\bar{v},\bar{b})$ *defines* $X$. We say that $X$ is
   *\(A\)-definable* or *definable over*  $A$ if there is a formula 
   $\psi(\bar{v},w_1,\dots,w_l)$ and $\bar{b}\in A^l$ s.t.
   $\psi(\bar{v},\bar{b})$ defines $X$
   #+END_definition

   A number of examples using $\call_r$, the language of rings
   * Let $\calm=(R,+,-,\cdot,0,1)$ be a ring. Let $p(X)\in R[X]$. Then 
     $Y=\{x\in R:p(x)=0\}$ is definable. Suppose that
     $p(X)=\displaystyle\sum_{i=0}^ma_iX^i$. Let $\phi(v,w_0,\dots,w_n)$ be the
     formula
     \begin{equation*}
     w_n\cdot\underbrace{v\cdots v}_{n\text{-times}}+\dots+w_1\cdot v+w_0=0
     \end{equation*}
     Then $\phi(v,a_0,\dots,a_n)$ defines $Y$. Indeed, $Y$ is \(A\)-definable
     for any $A\supseteq\{a_0,\dots,a_n\}$
   * Let $\calm=(\R,+,-,\cdot,0,1)$ be the field of real numbers. Let
     $\phi(x,y)$ be the formula 
     \begin{equation*}
     \exists z(z\neq 0\wedge y=x+z^2)
     \end{equation*}
     Because $a<b$ if and only if $\calm\vDash\phi(a,b)$, the ordering is
     \(\emptyset\)-definable 
   * Consider the natural numbers $\N$ as an $\call=\{+,\cdot,0,1\}$ structure.
     There is an \(\call\)-formula $T(e,x,s)$ s.t. $\N\vDash T(e,x,s)$ if and
     only if the Turing machine with program coded by $e$ halts on input $x$ in
     at most $s$ steps. Thus the Turing machine with program $e$ halts on input
     $x$ if and only if

 $\N\vDash\exists s\;T(e,x,s)$. So the halting
     computations is definable

     
   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   Let $\calm$ be an \(\call\)-structure. Suppose that $D_n$ is a collection of
   subsets of $M^n$ for all $n\ge 1$ and $\cald=(D_n:n\ge 1)$ is the smallest
   collection s.t. 
   1. $M^n\in D_n$
   2. for all \(n\)-ary function symbols $f$ of $\call$, the graph of $f^{\calm}$
      is in $D_{n+1}$
   3. for all \(n\)-ary relation symbols $R$ of $\call$, $R^{\calm}\in D_n$
   4. for all $i,j\le n$, $\{(x_1,\dots,x_n)\in M^n:x_i=x_j\}\in D_n$
   5. if $X\in D_n$, then $M\times X\in D_{n+1}$
   6. each $D_n$ is cloed under complement, union and intersection
   7. if $X\in D_{n+1}$ and $\pi:M^{n+1}\to M^n$ is the projection 
      $(x_1,\dots,x_{n+1})\mapsto(x_1,\dots,x_n)$, then $\pi(X)\in D_n$
   8. if $X\in D_{n+m}$ and $b\in M^m$, then $\{a\in M^n:(a,b)\in X\}\in D_n$
      

   Thus $X\subseteq M^n$ is definable if and only if $X\in D_n$
   #+END_proposition

   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   Let $\calm$ be an \(\call\)-structure. If $X\subset M^n$ is \(A\)-definable,
   then every \(\call\)-automorphism of $\calm$ that fixes $A$ pointwise fixes
   $X$ setwise(that is, if \sigma is an automorphism of $M$ and $\sigma(a)=a$
   for all $a\in A$, then $\sigma(X)=X$)
   #+END_proposition

   #+BEGIN_proof
   \begin{equation*}
   \calm\vDash\psi(\bar{v},\bar{a})\leftrightarrow
   \calm\vDash\psi(\sigma(\bar{v}),\sigma(\bar{a}))\leftrightarrow
   \calm\vDash\psi(\sigma(\bar{v}),\bar{a})
   \end{equation*}
   In other words, $\bar{b}\in X$ if and only if $\sigma(\bar{b})\in X$
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
    A subset $S$ of a field $L$ is *algebraically independent* over a
    subfield $K$ if the elements of 
    $S$ do not satisfy any non-trivial polynomial equation with
    coefficients in $K$ 
   #+END_definition

   
   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
    The set of real numbers is not definable in the field of complex numbers
   #+END_corollary

   #+BEGIN_proof
   If $\R$ where definable, then it would be definable over a finite
   $A\subset\C$. Let $r,s\in\C$ be algebraically independent over $A$ with
   $r\in\R$ and $s\not\in\R$. There is an automorphism \sigma of $\C$ s.t.
   $\sigma|A$ is the identity and $\sigma(r)=s$. Thus $\sigma(\R)\neq\R$ and
   $\R$ is not definable over $A$
   #+END_proof
   
   We say that an \(\call_0\)-structure $\caln$ is *definably interpreted* in
   an \(\call\)-structure $\calm$ if and only if we can find a definable
   $X\subseteq M^n$ for some $n$ and we can interpret the symbols of $\call_0$
   as definable subsets and functions on $X$ so that the resulting
   \(\call_0\)-structure is isomorphic to $\calm$


   For example, let $K$ be a field and $G$ be $\GL_2(K)$, the group of
   invertible $2\times 2$ matrices over $K$. Let $X=\{(a,b,c,d)\in K^4:ad-bc\neq
   0\}$. Let $f:X^2\to X$ by
   \begin{align*}
   f((a_1,b_1,&c_1,d_1),(a_2,b_2,c_2,d_2))=\\
   &(a_1a_2+b_1c_2,a_1b_2+b_1d_2,c_1a_2+d_1c_2,c_1b_2+d_1d_2)
   \end{align*}
   $X$ and $f$ are definable in $(K,+,\cdot)$, and the set $X$ with operation
   $f$ is isomorphic to $\GL_2(K)$, where the identity element of $X$ is
   $(1,0,0,1)$ 

   Clearly, $(\GL_n(K),\cdot,e)$ is definably interpreted in $(K,+,\cdot,0,1)$.
   A *linear algebraic group* over $K$ is a subgroup of $\GL_n(K)$ defined by
   polynomial equations over $K$. Any linear algebraic group over $K$ is
   definably interpreted in $K$

   Let $F$ be an infinite field and let $G$ be the group of matrices of the form 
   #+ATTR_LATEX: :mode math :environment pmatrix
   | a | b |
   | 0 | 1 |

   where $a,b\in F, a\neq 0$. This group is isomorphic to the group of affine
   transformations $x\mapsto ax+b$, where $a,b\in F$ and $a\neq 0$

   We will show that $F$ is definably interpreted in the group $G$. Let
   \begin{equation*}
    \alpha=\begin{pmatrix}
           1&1\\
           0&1\\
           \end{pmatrix}\text{ and }
   \beta=\begin{pmatrix}
   \tau&0\\
   0&1\\
         \end{pmatrix}
   \end{equation*}
   where $\tau\neq 0$. Let
   \begin{gather*}
   A=\{g\in G:g\alpha=\alpha g\}=\{\begin{pmatrix}
   1&x\\
   0&1\\
                                   \end{pmatrix}:x\in F\}\\
   B=\{g\in G:g\beta=\beta g\}=\{\begin{pmatrix}
   x&0\\
   0&1\\
                                   \end{pmatrix}:x\neq 0\}
   \end{gather*}
   Clearly $A,B$ are definable using parameters \alpha and \beta

   $B$ acts on $A$ by conjugation
   \begin{equation*}
   \begin{pmatrix}
   x&0\\
   0&1
   \end{pmatrix}^{-1}
   \begin{pmatrix}
   1&y\\
   0&1\\
   \end{pmatrix}
   \begin{pmatrix}
   x&0\\
   0&1\\
   \end{pmatrix}=
   \begin{pmatrix}
   1&\frac{y}{x}\\
   0&1
   \end{pmatrix}
   \end{equation*}
   We can define the map $i:A\backslash\{1\}\to B$ by $i(a)=b$ if and only if
   $b^{-1}ab=\alpha$, that is
   \begin{equation*}
   i \begin{pmatrix}
   1&x\\
   0&1
     \end{pmatrix}=
   \begin{pmatrix}
   x&0\\
   0&1
   \end{pmatrix}
   \end{equation*}
   Define an operation $*$ on $A$ by
   \begin{equation*}
   a*b=
   \begin{cases}
   i(b)a(i(b))^{-1}&\text{if } b\neq I\\
   1&\text{if } b=I
   \end{cases}
   \end{equation*}
   where $I$ is the identity matrix. Now $(F,+,\cdot,0,1)\cong (A,\cdot,*,1,\alpha)$


   Very complicated structures can often be interpreted in seemingly simpler
   ones. For example, any structure in a countable language can be interpreted
   in a graph. Let $(A,<)$ be a linear order. For each $a\in A$, $G_A$ will have
   vertices $a,x_1^a,x_2^a,x_3^a$ and contain the subgraph

   \begin{center}
   \begin{tikzpicture}
   \tikzstyle{vertex}=[circle,fill=black,minimum size=1pt,inner sep=2pt]
   \node[vertex,label=left:$x_2^a$] (2) at (0,0) {};
   \node[vertex,label=right:$x^a_3$] (3) at (2,0) {};
   \node[vertex,label=right:$x^a_1$] (1) at (1,-1) {};
   \node[vertex,label=right:$a$] (a) at (1,-2) {};
   \draw (2) -- (3) -- (1) -- (2);
   \draw (a) -- (1);
   \end{tikzpicture}
   \end{center}

   If $a<b$, then $G_A$ will have vertices $y_1^{a,b},y_2^{a,b},y_3^{a,b}$ and
   contain the subgraph
   
   \begin{center}
   \begin{tikzpicture}
   \tikzstyle{vertex}=[circle,fill=black,minimum size=1pt,inner sep=2pt]
   \tikzstyle{empty}=[circle,fill=black,minimum size=1pt,inner sep=0]
   \node[vertex,label=left:$y_2^{a,b}$] (2) at (2,2) {};
   \node[label=left:$y_1^{a,b}$,inner sep=0] (1) at (1,1) {};
   \node[vertex,label=right:$y_3^{a,b}$] (3) at (2,1) {};
   \node[vertex,label=left:$a$] (a) at (0,0) {};
   \node[vertex,label=right:$b$] (b) at (4,0) {};
   \draw (a) -- (2);
   \draw (1) -- (3);
   \draw (2) -- (b);
   \end{tikzpicture}
   \end{center}


   Let $V_A=A\cup\{x_1^a,x_2^a,x_3^a:a\in A\}\cup\{y_1^{a,b},y_2^{a,b},y_3^{a,b}:a,b\in A\text{ and }a<b\}$, and let
   $R_A$ be the smallest symmetric relation containing all edges drawn above.

   For example, if $A$ is the three-element linear order $a<b<c$, then $G_A$ is
   the graph

   \begin{center}
   \begin{tikzpicture}[scale=0.8,transform shape]
   \tikzstyle{vertex}=[circle,fill=black,minimum size=1pt,inner sep=2pt]
   \tikzstyle{empty}=[circle,fill=black,minimum size=1pt,inner sep=0]
   \node[vertex,label=left:$x_2^a$] (a2) at (0,0) {};
   \node[vertex,label=left:$x_2^b$] (b2) at (4,0) {};
   \node[vertex,label=left:$x_2^c$] (c2) at (8,0) {};
   \node[vertex,label=right:$x_1^c$] (c1) at (9,1) {};
   \node[vertex,label=right:$x_1^b$] (b1) at (5,1) {};
   \node[vertex,label=right:$x_1^a$] (a1) at (1,1) {};
   \node[vertex,label=right:$x_3^a$] (a3) at (2,0) {};
   \node[vertex,label=right:$x_3^b$] (b3) at (6,0) {};
   \node[vertex,label=right:$x_3^c$] (c3) at (10,0) {};
   \node[vertex,label=left:$a$] (a) at (1,2) {};
   \node[vertex,label=above:$b$] (b) at (5,2) {};
   \node[vertex,label=right:$c$] (c) at (9,2) {};
   \node[vertex,label=below:$y_1^{a,b}$] (ab1) at (2,2.5) {};
   \node[vertex,label=below:$y_1^{b,c}$] (bc1) at (6,2.5) {};
   \node[vertex,label=below:$y_3^{a,b}$] (ab3) at (3,2.5) {};
   \node[vertex,label=right:$y_2^{a,b}$] (ab2) at (3,3) {};
   \node[vertex,label=below:$y_3^{b,c}$] (bc3) at (7,2.5) {};
   \node[vertex,label=right:$y_2^{b,c}$] (bc2) at (7,3) {};
   \node[vertex,label=below:$y_3^{a,c}$] (ac3) at (5,4) {};
   \node[vertex,label=below:$y_2^{a,c}$] (ac2) at (5,6) {};
   \node[vertex,label=below:$y_1^{a,c}$] (ac1) at (3,4) {};
   \draw (a2) -- (a1) -- (a3) -- (a2);
   \draw (a1) -- (a);
   \draw (b2) -- (b1) -- (b3) -- (b2);
   \draw (b1) -- (b);
   \draw (c2) -- (c1) -- (c3) -- (c2);
   \draw (c1) -- (c);
   \draw (a) -- (ac2);
   \draw (ac2) -- (c);
   \draw (a) -- (ab2);
   \draw (ab1) -- (ab3);
   \draw (ac1) -- (ac3);
   \draw (bc1) -- (bc3);
   \draw (b) -- (bc2);
   \draw (b) -- (ab2);
   \draw (c) -- (bc2);
   \end{tikzpicture}
   \end{center}

   Let $\call=\{R\}$ where $R$ is a binary relation. Let $\phi(x,u,v,w)$ be the
   formula asserting that $x,u,v,w$ are distinct, there are edges
   $(x,u),(u,v),(v,w),(u,w)$ and these are the only edges involving $u,v,w$.
   $G_A\vDash\phi(a,x_1^a,x_2^a,x_3^a)$ for all $a\in A$.

   $\psi(x,y,u,v,w)$ asserts that $x,y,u,v,w$ are distinct. $(x,u),(u,v),(u,w),(v,y)$

   Define $\theta_i(z)$ as follows:
   \begin{align*}
   &\theta_0(z):=\exists u\exists v\exists w\;\phi(z,u,v,w)\\
   &\theta_1(z):=\exists x\exists v\exists w\;\phi(x,z,v,w)\\
   &\theta_2(z):=\exists u\exists u\exists w\;\phi(x,u,z,w)\\
   &\theta_3(z):=\exists x\exists y\exists v\exists w\;\psi(x,y,z,v,w)\\
   &\theta_4(z):=\exists x\exists y\exists u\exists w\;\psi(x,y,u,z,w)\\
   &\theta_5(z):=\exists x\exists y\exists u\exists v\;\psi(x,y,u,v,z)\\
   \end{align*}
   If $a,b\in A$ and $a<b$, then
   \begin{equation*}
   G_A\vDash\theta_0(a)\wedge\theta_1(x^a_1)\wedge\theta_2(x^a_2)\wedge
   \theta_2(x^a_3)
   \end{equation*}
   and 
   \begin{equation*}
   G_A\vDash\theta_3(y_1^{a,b})\wedge\theta_4(y_2^{a,b})\wedge\theta_5(
   y_3^{a,b})
   \end{equation*}
   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   If $(A,<)$ is a linear order, then for all vertices $x$ in $G$, there is a
   unique $i\le 5$ s.t. $G_A\vDash\theta_i(x)$
   #+END_lemma

   Let $T$ be the \(\call\)-theory with the following axioms
   1. $R$ is symmetric and irreflexive
   2. for all $x$, exactly one $\theta_i$ holds
   3. if $\theta_0(x)$ and $\theta_0(y)$ then $\neg R(x,y)$
   4. if $\exists u\exists v\exists w\;\psi(x,y,u,v,w)\\$ then
      $\forall u_1\forall v_1\forall w_1\neg\psi(y,x,u_1,v_1,w_1)$
   5. if $\exists u\exists v\exists w\;\psi(x,y,u,v,w)$ and 
      $\exists u\exists v\exists w\;\psi(y,z,u,v,w)$ then\par
      $\exists u\exists v\exists w\;\psi(x,z,u,v,w)$
   6. if $\theta_0(x)$ and $\theta_0(y)$, then either $x=y$ or 
      $\exists u\exists v\exists w\;\psi(x,y,u,v,w)$ or
      $\exists u\exists v\exists w\;\psi(y,x,u,v,w)$
   7. if $\phi(x,u,v,w)\wedge\phi(x,u',v',w')$, then
      $u=u',v=v',w=w'$
   8. if $\psi(x,y,u,v,w)\wedge\psi(x,y,u',v',w')$, then
      $u'=u,v=v',w=w'$


   If $(A,<)$ is a linear order, then $G_A\vDash T$

   Suppose $G\vDash T$. Let $X_G=\{x\in G:G\vDash\theta_0(x)\}$

   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   If $(A,<)$ is a linear order, then $(X_{G_A},<_{G_A})\cong(A,<)$. Moreover,
   $G_{X_G}\cong G$ for all $G\vDash T$
   #+END_lemma

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   An \(\call_0\)-structure $\caln$ is *interpretable* in an
   \(\call\)-structure $M$ if there is a definable $X\subseteq M^n$, a definable
   equivalence relation $E$ on $X$, and for each symbol of $\call_0$ we can find
   definable \(E\)-invariant sets on X s.t. $X/E$ with the induced structure is
   isomorphic to $\caln$
   #+END_definition
** Answers to Exercises
   #+BEGIN_exercise
   1. transform $\psi$ to CNF
   2. prenex normal form
   #+END_exercise
   #+BEGIN_exercise
   1. 
      \begin{tikzpicture}[scale=0.6]
      \tikzstyle{vertex}=[circle,fill=black,minimum size=1pt,inner sep=2pt]
      \node[vertex,label=above:$s$] (1) at (0,1) {};
      \node[vertex,label=above:$e$] (0) at (0,0) {};
      \node[vertex,label=above:$r$] (2) at (1,0) {};
      \node[vertex,label=above:$rs$] (3) at (1,1) {};
      \end{tikzpicture}
   2. enumerate $\calm$'s functions, relations and constants
   #+END_exercise
   #+BEGIN_exercise
   [fn:stack]
   Note that every \(\call\)-structure $\calm$ of size $\kappa$ is isomorphic to an
   \(\call\)-structure with domain $\kappa$. For each relation symbols, we have $2^\kappa$
   options. If the language has size $\lambda$, this is at most 
   $(2^\kappa)^\lambda=2^{\kappa\cdot\lambda}=2^{\max(\lambda,\kappa)}$
   #+END_exercise

   #+BEGIN_exercise
   \begin{align*}
   T\vDash\phi&\Leftrightarrow\forall \calm\;\calm\vDash T\to\calm\vDash\phi\\
   &\Leftrightarrow\forall \calm\;\calm\vDash T'\to\calm\vDash\phi\\
   &\Leftrightarrow T'\vDash\phi
   \end{align*}
   #+END_exercise
   #+BEGIN_exercise
   Follow the definition
   #+END_exercise

   #+BEGIN_exercise
   Since there is no model $\calm$ s.t. $\calm\vDash T$. It's true that 
   $T\vDash \phi$
   #+END_exercise

   #+BEGIN_exercise
   1. Suppose $\calm\vDash\phi$, then $E^{\calm}$ is an equivalent relation and
      each equivalence class's cardinality is 2
   2. follows from number theory
   3. cite:DBLP:journals/bsl/DurandJMM12
   #+END_exercise

   #+BEGIN_exercise
   TBD
   #+END_exercise

   #+BEGIN_exercise
   $G(f)=\{(\bar{x},\bar{y})\in M^{n+m}\mid\phi(\bar{x},\bar{y})\}$ and 
   $G(g)=\{(\bar{y},\bar{z})\in M^{m+l}\mid\psi(\bar{y},\bar{z})\}$. Hence
   $G(g\circ f)=\{(\bar{x},\bar{z})\in M^{n+l}\mid \phi(\bar{x},\bar{y})
   \wedge \psi(\bar{y},\bar{z})\}$
   #+END_exercise

   #+BEGIN_exercise
   $\phi(\bar{a},b)$ really defines a function and since 
   $\phi(\bar{a},y)\to y=b$
   #+END_exercise

* Basic Techniques
** The Compactness Theorem

   Some points of proofs
   * Proofs are finite
   * (Soundness) If \(T\vdash\phi\), then \(T\vDash\phi\)
   * If \(T\) is a finite set of sentences, then there is an algorithm that,
     when given a sequence of \(\call\)-formulas \sigma and an \(\call\)-sentence \phi,
     will decide whether \sigma is a proof of \phi from $T$

   [[index:recursive]]
   A language $\call$ is *recursive* if there is an algorithm that decides
   whether a sequence of symbols is an \(\call\)-formula. An \(\call\)-theory
   $T$ is *recursive* if there is an algorithm that when given an
   \(\call\)-sentence \phi as input, decides whether $\phi\in T$

   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   label:prop2.1.1
   If \(\call\) is a recursive language and $T$ is a recursive \(\call\)-theory,
   then $\{\phi:T\vdash\phi\}$ is recursively enumerable; that is, there is an
   algorithm that when given \phi as input will halt accepting if $T\vdash\phi$
   and not halt if $T\not\vdash\phi$
   #+END_proposition
   #+BEGIN_proof
   There is $\sigma_0,\sigma_1,\dots$ a computable listing of all finite
   sequence of \(\call\)-formulas. At stage $i$, we check to see whether
   $\sigma_i$ is a proof of \psi from $T$. If it is, then halt.
   #+END_proof

   #+ATTR_LATEX: :options [Gödel's Completeness Theorem]
   #+BEGIN_theorem
   Let $T$ be an \(\call\)-theory and \phi an \(\call\)-sentence, then
   $T\vDash\phi$ if and only if $T\vdash \phi$
   #+END_theorem

   We say that an \(\call\)-theory $T$ is *inconsistent* if
   $T\vdash(\phi\wedge\neg\phi)$ for some sentence \phi.

   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
   $T$ is consistent if and only if $T$ is satisfiable
   #+END_corollary

   #+BEGIN_proof
   Supose that $T$ is not satisfiable, then every model of $T$ is a model of
   $\phi\wedge\neg\phi$. Thus by the Completeness theorem
   $T\vdash(\phi\wedge\neg\phi)$ 
   #+END_proof


   #+ATTR_LATEX: :options [Compactness Theorem]
   #+BEGIN_theorem
   $T$ is satisfiable if and only if every finite subset of $T$ is satisfiable
   #+END_theorem

   #+BEGIN_proof
   If $T$ is not satisfiable, then $T$ is inconsistent. Let \sigma be a proof of
   a contradiction from  $T$. Because \sigma is finite, only finitely many
   assumptions from $T$ are used in the proof. Thus there is a finite
   $T_0\subseteq T$ s.t. \sigma is a proof of a contradiction from $T_0$
   #+END_proof

*** Henkin Constructions
    [[index:finitely satisfiable]]
    A theory $T$ is *finitely satisfiable* if every finite subset of $T$ is
    satisfiable. We will show that every finitely satisfiable theory $T$ is
    satisfiable.

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say that an \(\call\)-theory $T$ has the *witness property* if whenever
    $\phi(v)$ is an \(\call\)-formula with one free variable $v$, then there is
    a constant symbol $c\in\call$ s.t. $T\vdash(\exists v\phi(v))\to\phi(c)\in T$

    An \(\call\)-theory $T$ is *maximal* if for all $\phi$ either $\phi\in T$ or
    $\neg\phi\in T$
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma2.1.6
    Suppose $T$ is a maximal and finitely satisfiable \(\call\)-theory. If
    $\Delta\subseteq T$ is finite and $\Delta\vDash\psi$, then $\psi\in T$
    #+END_lemma

    #+BEGIN_proof
    If $\psi\not\in T$, then $\neg\psi\in T$ but $\Delta\cup\{\psi\}$ is
    unsatisfiable 
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma2.1.7
    Suppose that $T$ is a maximal and finitely satisfiable \(\call\)-theory with
    the witness property. Then $T$ has a model. In fact, if \kappa is a cardinal
    and \(\call\) has at most \kappa constant symbols, then there is
    $\calm\vDash T$ with $\abs{\calm}\le\kappa$
    #+END_lemma
    
    #+BEGIN_proof
    Let $\calc$ be the set of constant symbols of \(\call\). For $c,d\in\calc$,
    we say $c\sim d$ if $c=d\in T$

    *Claim 1* $\sim$ is an equivalence relation. 

    The universe of our model will be $M=\calc/\sim$. Clearly
    $\abs{M}\le\kappa$. We let $c^*$ denote the equivalence class of $c$ and
    interprete $c$ as its equivalence class, that is, $c^{\calm}=c^*$

    Suppose that $R$ is an \(n\)-ary relation symbol of \(\call\)

    *Claim 2* Suppose that $c_1,\dots,c_n,d_1,\dots,d_n\in\calc$ and $c_i\sim d_i$
    for $i=1,\dots,n$, then $R(\bar{c})$ if and only if $R(\bar{d})$

    By Lemma ref:lemma2.1.6, if one of \(R(\bar{c})\) and \(R(\bar{d})\) is
    in $T$, then both are in $T$

    
    \begin{equation*}
    R^{\calm}=\{(c_1^*,\dots,c_n^*):R(c_1,\dots,c_n)\in T\}
    \end{equation*}
    Suppose that $f$ is an \(n\)-ary function symbol of \(\call\) and
    $c_1,\dots,c_n\in\calc$. Because  $\underline{\emptyset\vDash\exists
    vf(c_1,\dots,c_n)=v}$, and $T$ has the witness property, then there is
    $c_{n+1}\in\calc$ s.t. $f(c_1,\dots,c_n)=c_{n+1}\in T$. As above, if
    $d_i\sim c_i$ for $i=1,\dots,n+1$, then $f(d_1,\dots,d_n)=d_{n+1}\in T$.
    Thus we get a well-defined function $f^{\calm}:M^n\to M$ by
    \begin{equation*}
    f^{\calm}(c_1^*,\dots,c_n^*)=d^*\text{ if and only if }f(c_1,\dots,c_n)=d\in T
    \end{equation*}

    *Claim 3* Suppose that $t$ is a term using free variables from
    $v_1,\dots,v_n$. If $c_1,\dots,c_n,d\in\calc$, then $t(c_1,\dots,c_n)=d\in
    T$ if and only if $t^{\calm}(c_1^*,\dots,c_n^*)=d^*$

    (\(\Rightarrow\)) If \(t\) is a constant symbol, then \(c=d\in T\) and
    \(c^{\calm}=c^*=d^*\)

    If \(t\) is the variable \(v_i\), then \(c_i=d\in T\) and 
    \(t^{\calm}(c_1^*,\dots,c_n^*)=c_i^*=d^*\)

    Suppose that the claim is true for \(t_1,\dots,t_m\) and \(t\) is
    \(f(t_1,\dots,t_m)\). Using the witness property and Lemma ref:lemma2.1.6,
    we can find \(d,d_1,\dots,d_n\in\calc\) s.t. \(t_i(c_1,\dots,c_n)=d_i\in T\)
    for \(i\le m\) and \(f(d_1,\dots,d_m)=d\in T\). By our induction hypothesis, 
    \(t_i^{\calm}(c_1^*,\dots,c_n^*)=d_i^*\) and
    \(f^{\calm}(d_1^*,\dots,d_m^*)=d^*\). Thus \(t^{\calm}(c_1^*,\dots,c_n^*)=d^*\)

    ($\Leftarrow$) Suppose $t^{\calm}(c_1^*,\dots,c_n^*)=d^*$. By the witness
    property, there is a $e\in\calc$ s.t. $t(c_1,\dots,c_n)=e\in T$. Using the
    $(\Rightarrow)$ direction of the proof, $t^{\calm}(c_1^*,\dots,c_n^*)=e^*$.
    Thus $e^*=d^*$ and $e=d\in T$


    *Claim 4* For all \(\call\)-formulas $\phi(v_1,\dots,v_n)$ and
    $c_1,\dots,c_n\in\calc$, $\calm\vDash\phi(\bar{c}^*)$ if and only if
    $\phi(\bar{c})\in T$

    Suppose that \(\phi\) is \(t_1=t_2\). By Lemma ref:lemma2.1.6 and the
    witness property, we can find \(d_1\) and \(d_2\) s.t. 
    \(t_1(\bar{c})=d_1,t_2(\bar{c})=d_2\in T\). By Claim 3,
    \(t_i^{\calm}(\bar{c}^*)=d_i^*\). Then
    \begin{align*}
    \calm\vDash\phi(\bar{c}^*)&\Leftrightarrow d_1^*=d_2^*\\
    &\Leftrightarrow d_1=d_2\in T\\
    &\Leftrightarrow t_1(\bar{c})=t_2(\bar{c})\in T
    \end{align*}

    Suppose that \phi is \(R(t_1,\dots,t_m)\). There are \(d_1,\dots,d_m\in\calc\)
    s.t. \(t_i(\bar{c})=d_i\in T\). Thus
    \begin{align*}
    \calm\vDash\phi(\bar{c}^*)&\Leftrightarrow \bar{d}^*\in R^{\calm}\\
    &\Leftrightarrow R(\bar{d})\in T\\
    &\Leftrightarrow\phi(\bar{c})\in T
    \end{align*}
    
    Suppose that the claim is true for \phi. If
    \(\calm\vDash\neg\phi(\bar{c}^*)\), then
    \(\calm\not\vDash\phi(\bar{c}^*)\). By the inductive hypothesis,
    \(\phi(\bar{c})\not\in T\). Thus by maximality, \(\neg\phi(\bar{c})\in T\). On
    the other hand, if \(\neg\phi(\bar{c})\in T\), then because $T$ is finitely
    satisfiable, \(\phi(\bar{c})\not\in T\). Thus, by induction,
    \(\calm\not\vDash\phi(\bar{c}^*)\).

    
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma2.1.8
    Let $T$ be a finitely satisfiable \(\call\)-theory. There is a language
    $\call^*\supseteq\call$ and $T^*\supseteq T$ a finitely satisfiable
    \(\call^*\)-theory s.t. any \(\call^*\)-theory extending $T^*$ has the
    witness property. We can choose $\call^*$ s.t.
    $\abs{\call^*}=\abs{\call}+\aleph_0$ 
    #+END_lemma

    #+BEGIN_proof
    We first show that there is a language $\call_1\supseteq\call$ and a
    finitely satisfiable \(\call_1\)-theory $\call_1\supseteq T$ s.t. for any
    \(\call\)-formula $\phi(v)$ there is an \(\call_1\)-constant symbol $c$ s.t.
    $T_1\vDash(\exists v\phi(v))\to\phi(c)$. For each \(\call\)-formula
    $\phi(v)$, let $c_\phi$ be a new constant symbol and let
    $\call_1=\call\cup\{c_\phi:\phi(v)\text{ an }\call\text{-formula}\}$. For
    each \(\call\)-formula $\phi(v)$, let $\Theta_\phi$ be the
    \(\call_1\)-sentence
    $(\exists v\phi(v))\to\phi(c_\phi)$. Let
    $T_1=T\cup\{\Theta_\phi:\phi(v)\text{ an }\call\text{-formula}\}$

    *Claim* $T_1$ is finitely satisfiable

    Suppose that $\Delta$ is a finite subset of $T_1$. Then
    $\Delta=\Delta_0\cup\{\Theta_{\phi_1},\dots, \Theta_{\phi_n}\}$ where
    $\Delta_0$ is a finite subset of $T$ and there is $\calm\vDash\Delta_0$. We
    will make $\calm$ into an
    \(\call\cup\{c_{\phi_1},\dots,c_{\phi_n}\}\)-structure $\calm'$. If
    $\calm\vDash\exists v\phi(v)$, choose $a_i$ some element of $M$ s.t.
    $\calm\vDash\phi(a_i)$ and let $c_{\phi_i}^{\calm'}=a_i$. Otherwise, let
    $c_{\phi_i}^{\calm'}$ be any element of $\calm$. Clearly
    $\calm'\vDash\Theta_{\phi_i}$ for $i\le n$. Thus $T_1$ is finitely
    satisfiable.

    We now iterate the construction above to build a sequence of languages
    $\call\subseteq\call_1\subseteq\call_2\subseteq\dots$ and a sequence of
    finitely satisfiable \(\call_i\)-theories $T\subseteq T_1\subseteq
    T_2\subseteq\dots$ s.t. if $\phi(v)$ is an \(\call_i\)-formula then there is
    a constant symbol $c\in\call_{i+1}$ s.t. $T_{i+1}\vDash(\exists
    v\phi(v))\to\phi(c)$

    Let $\call^*=\bigcup\call_i$ and $T^*=\bigcup T_i$. 
    If \(\abs{\call_i}\) is the number of relation, function and constant
    symbols in \(\call_i\), then there are at most \(\abs{\call_i}+\aleph_0\)
    formulas in \(\call_i\).
    Thus by induction,
    $\abs{\call^*}=\abs{\call}+\aleph_0$ 
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:2.1.9
    Suppose that $T$ is a finitely satisfiable \(\call\)-theory and \phi is an
    \(\call\)-sentence, then either $T\cup\{\phi\}$ or $T\cup\{\neg\phi\}$ is
    finitely satisfiable
    #+END_lemma

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor2.1.10
    If $T$ is a finitely satisfiable \(\call\)-theory, then there is a maximal
    finitely satisfiable \(\call\)-theory $T'\supseteq T$
    #+END_corollary
    #+BEGIN_proof
    Let $I$ be the set of all finitely satisfiable \(\call\)-theory containing
    $T$. We partially order $I$ by inclusion. If $C\subseteq I$ is a chain, let
    $T_C=\bigcup\{\Sigma:\Sigma\in C\}$. If $\Delta$ is a finite subset of
    $T_C$, then there is a $\Sigma\in C$ s.t. $\Delta\subseteq\Sigma$, so $T_C$
    is finitely satisfiable and $T_C\supseteq\Sigma$ for all $\Sigma\in C$. Thus
    every chain in $I$ has an upper bound, and we can apply Zorn's lemma to find
    a $T'\in I$ maximal w.r.t. the partial order.
    #+END_proof


    #+ATTR_LATEX: :options [strengthening of Compactness Theorem]
    #+BEGIN_theorem
    label:thm2.1.11
    If $T$ is a finitely satisfiable \(\call\)-theory and \kappa is an infinite
    cardinal with $\kappa\ge\abs{\call}$, then there is a model of $T$ of
    cardinality at most \kappa
    #+END_theorem

    #+BEGIN_proof
    By Lemma ref:lemma2.1.8, we can find \(\call^*\supseteq\call\) and 
    \(T^*\supseteq T\) a finitely satisfiable \(\call^*\)-theory s.t. any
    \(\call^*\)-theory extending \(T^*\) has the witness property and the
    cardinality of \(\call^*\) is at most \kappa. By Corollary ref:cor2.1.10, we can
    find a maximal finitely satisfiable \(\call^*\)-theory 
    \(T'\supseteq T^*\). Because \(T'\) has the witness property, Lemma
    ref:lemma2.1.7 ensures that there is \(\calm\vDash T\) with \(\abs{M}\le\kappa\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    Let $\call=\{\cdot,+,<,0,1\}$ and let $\Th(\N)$ be the full \(\call\)-theory
    of the natural numbers. There is $\calm\vDash\Th(\N)$ and $a\in M$ s.t. $a$
    is larger than every natural number
    #+END_proposition

    #+BEGIN_proof
    Let $\call^*=\call\cup\{c\}$ where $c$ is a new constant symbol and let
    \begin{equation*}
    T=\Th(\N)\cup\{\underbrace{1+1+\dots+1}_{n\text{-times}}<c:\text{for }n=1,2,\dots\} 
    \end{equation*}
    If $\Delta$ is a finite subset of $T$ we can make $\N$ a model of $\Delta$ by
    interpreting $c$ as a suitably large natural number. Thus $T$ is finitely
    satisfiable and there is $\calm\vDash T$.
    #+END_proof
    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma2.1.14
    If $T\vDash\phi$, then $\Delta\vDash T$ for some finite $\Delta\subseteq T$
    #+END_lemma
    #+BEGIN_proof
    Suppose not. Let $\Delta\subseteq T$ be finite. Because
    $\Delta\not\vDash\phi$, $\Delta\cup\{\neg\phi\}$ is satisfiable. Thus
    $T\cup\{\neg\phi\}$ is finitely satisfiable and by the compactness theorem,
    $T\not\vDash\phi$ 
    #+END_proof


    
** Complete Theories
   [[index:complete]]
   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   An \(\call\)-theory $T$ is called *complete* if for any \(\call\)-sentence \phi
   either $T\vDash\phi$ or $T\vDash\neg\phi$
   #+END_definition

   For $\calm$ an \(\call\)-structure, then the full theory
   \begin{equation*}
   \Th(\calm)=\{\phi:\phi\text{ is an }\call\text{-sentence and }
   \calm\vDash\phi\}
   \end{equation*}
   is a complete theory.

   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   label:prop2.2.2
   Let $T$ be an \(\call\)-theory with infinite models. If \kappa is an infinite
   cardinal and $\kappa\ge\abs{\call}$, then there is a model of $T$ of
   cardinality \kappa
   #+END_proposition

   #+BEGIN_proof
   Let $\call^*=\call\cup\{c_\alpha:\alpha<\kappa\}$, where each $c_\alpha$ is
   new constant symbol, and let $T^*$ be the \(\call^*\)-theory
   $T\cup\{c_\alpha\neq c_\beta:\alpha,\beta<\kappa,\alpha\neq\beta\}$. Clearly
   if $\calm\vDash T^*$, then $\calm$ is a model of $T$ of cardinality at least
   \kappa.
   Thus by Theorem ref:thm2.1.11, it suffices to show that $T^*$ is finitely
   satisfiable. But if $\Delta\subseteq T^*$ is finite, then $\Delta\subseteq
   T\cup\{c_\alpha\neq c_\beta:\alpha\neq\beta,\alpha,\beta\in I\}$, where $I$
   is a finite subset of \kappa. Let $\calm$ be an infinite model of $T$. We can
   interpret the symbols $\{c_\alpha:\alpha\in I\}$ as $\abs{I}$ distinct
   elements of $M$. Because $\calm\vDash\Delta$, $T^*$ is finitely satisfiable.
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   Let \kappa be an infinite cardinal and let $T$ be a theory with models of
   size \kappa. We say that $T$ is *\kappa-categorical* if any two models of
   $T$ of cardinality \kappa are isomorphic.
   #+END_definition

   Let $\call=\{+,0\}$ be the language of additive groups and let $T$ be the
   \(\call\)-theory of torsion-free divisible Abelian groups. The axioms of $T$
   are the axioms for Abelian groups together with the axioms
   \begin{gather*}
   \forall x(x\neq 0\to\underbrace{x+\dots+x}_{n\text{-times}}\neq 0)\\
   \forall y\exists x\underbrace{x+\dots+x}_{n\text{-times}}=y
   \end{gather*}
   for $n=1,2,\dots$

   
   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   label:prop2.2.4
   The theory of torsion-free divisible Abelian groups is \kappa-categorical for
   all $\kappa>\aleph_0$
   #+END_proposition

   #+BEGIN_proof
   We first argue that models of $T$ are essentially vector spaces over the
   field of rational numbers $\Q$. If $V$ is any vector space over $\Q$, then
   the underlying additive group $V$ is a model of $T$. 
   Check [[https://math.stackexchange.com/questions/1550900/necessary-and-sufficient-conditions-for-an-abelian-group-to-be-a-vector-space-ov/1550954][StackExchange]].
   On the other hand, if
   \(G\vDash T\), \(g\in G\) and \(n\in\N\) with \(g>0\), we can find 
   \(h\in G\) s.t. \(nh=g\). If \(nk=g\), then \(n(h-k)=0\). Because $G$ is
   torsion-free there is a unique \(h\in G\) s.t. \(nh=g\). We call this element 
   \(g/n\). We can view $G$ as a \(\Q\)-vector space under the action
   \(\frac{m}{n}g=m(g/n)\)

   Two \(\Q\)-vector spaces are isomorphic if and only if they have the same
   dimension. Thus the model of $T$ are determined up to isomorphism by their
   dimension. If \(G\) has dimension \lambda, then \(\abs{G}=\lambda+\aleph_0\). If \kappa
   is uncountable and $G$ has cardinality \kappa, then $G$ has dimension \kappa. Thus for
   \(\kappa>\aleph_0\) any two models of $T$ of cardinality \kappa are isomorphic
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   label:lemmamy1
   Field of uncountable cardinality \kappa has transcendence degree \kappa
   [fn:proofkappa]
   #+END_lemma

   #+BEGIN_proof
   We prove the theorem for fields with characteristic \(p=0\). 

   Since each characteristic 0 field contains a copy of \(\Q\) as its prime
   field, we can view $F$ as a field extension over \(\Q\). We will show that
   $F$ has a subset of cardinality \kappa which is algebraically independent over
   \(\Q\).

   We build the claimed subset of $F$ by transfinite induction and implicit use
   of the axiom of choice.

   Let \(S_0=\emptyset\)

   Let \(S_1\) be a singleton containing some element of $F$ which is not
   algebraic over \(\Q\). This is possible since algebraic numbers are countable

   Define \(S_{\alpha+1}\) to be \(S_\alpha\) together with an element of $F$
   which is not a root of any non-trivial polynomial with coefficients in 
   \(\Q\cup S_\alpha\) since there are only 
   \(\abs{\Q\cup S_\alpha}=\aleph_0+\abs{\alpha}<\kappa\) polynomials

   Define \(S_\beta=\displaystyle\bigcup_{\alpha<\beta}S_\alpha\)
   
   Let \(P(x_1,\dots,x_n)\) be a non-trivial polynomial with coefficients in
   \(\Q\) and elements \(a_1,\dots,a_n\) in $F$. W.L.O.G., it is assumed that
   \(a_n\) was added at an ordinal \(\alpha+1\) later than the other elements.
   Then \(P(a_1,\dots,a_{n-1},x_n)\) is a polynomial with coefficients in 
   \(\Q\cup S_\alpha\). Hence \(P(a_1,\dots,a_n)\neq0\).
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   label:prop2.2.5
   \(\ACF_p\) is \kappa-categorical for all uncountable cardinals \kappa
   #+END_proposition

   #+BEGIN_proof
   Two algebraically closed fields are isomorphic if and only if they have the
   same characteristic and transcendence degree. See
   [[file:AdvancedModernAlgebra.org::Application of Zorn's Lemma]]. By Lemma
   ref:lemmamy1, an algebraically closed field of transcendence degree \lambda has
   cardinality \(\lambda+\aleph_0\).
   #+END_proof

   #+ATTR_LATEX: :options [Vaught's Test]
   #+BEGIN_theorem
   label:thm2.2.6
   Let $T$ be a satisfiable theory with no finite models that is
   \kappa-categorical for some infinite cardinal \(\kappa\ge\abs{\call}\). Then
   $T$ is complete
   #+END_theorem

   #+BEGIN_proof
   Suppose $T$ is not complete. Then there is a sentence \phi s.t. 
   \(T\not\vDash\phi\) and \(T\not\vDash\neg\phi\). Because
   \(T\not\vDash\psi\) if and only if \(T\cup\{\neg\psi\}\) is satisfiable, the
   theories \(T_0=T\cup\{\phi\}\) and \(T_1=T\cup\{\neg\phi\}\) are satisfiable.
   Because $T$ has no finite models, both \(T_0\) and \(T_1\) have infinite
   models. By Proposition ref:prop2.2.2 we can find \(\calm_0\) and
   \(\calm_1\) of cardinality \kappa with \(\calm_i\vDash T_i\). Because \(\calm_0\)
   and \(\calm_1\) disagree about \phi, they are not elementarily equivalent, and
   hence by Theorem ref:thm1.1.10, nonisomorphic. 
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   We say that an \(\call\)-theory $T$ is *decidable* if there is an algorithm
   that when given an \(\call\)-sentence \phi as input decides whether \(T\vDash\phi\)
   #+END_definition

   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   label:lemma2.2.8
   Let $T$ be a recursive complete satisfiable theory in a recursive language
   \(\call\). Then $T$ is decidable
   #+END_lemma

   #+BEGIN_proof
   Because $T$ is satisfiable \(A=\{\phi:T\vDash\phi\}\) and
   \(B=\{\phi:T\vDash\neg\phi\}\) are disjoint. Because $T$ is consistent 
   \(A\cup B\) is the set of all \(\call\)-sentences. By the Completeness
   Theorem, \(A=\{\phi:T\vdash\phi\}\) and \(B=\{\phi:T\vdash\neg\phi\}\). By
   Proposition ref:prop2.1.1 $A$ and $B$ are recursively enumerable. But any
   recursively enumerable set with a recursively enumerable complement is
   recursive. 
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
   For $p=0$ or $p$ prime, \(ACF_p\) is decidable. In particular, \(\Th(\C)\),
   the first-order theory  of the field of complex numbers, is decidable
   #+END_corollary

   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
   Let \phi be a sentence in the language of rings. The following are equivalent
   1. \phi is true in the complex number
   2. \phi is true in every algebraically closed field of characteristic zero
   3. \phi is true in some algebraically closed field of characteristic zero
   4. There are arbitrarily large primes $p$ s.t. \phi is true in some
      algebraically closed field of characteristic $p$
   5. There is an $m$ s.t. for all \(p>m\), \phi is true in all algebraically
      closed fields of characteristic $p$
   #+END_corollary

   #+BEGIN_proof
   By Proposition ref:prop2.2.5 and Vaught's Test, \(\ACF_p\) is complete.

   \((2)\to(5)\). Suppose that \(\ACF_0\vDash\phi\). By Lemma ref:lemma2.1.14,
   there is a finite \(\Delta\subseteq\ACF_0\) s.t. \(\Delta\vDash\phi\). Thus
   if we choose \(p\) large enough, then \(\ACF_p\vDash\Delta\).

   \((4)\to(2)\). Suppose \(\ACF_0\not\vDash\phi\). Because \(\ACF_0\) is
   complete, \(\ACF_0\vDash\neg\phi\).
   #+END_proof
   
** Up and Down

   
   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   If \(\calm\) and \(\caln\) are \(\call\)-structures, then an
   \(\call\)-embedding \(j:\calm\to\caln\) is called an *elementary embedding* if
   \begin{equation*}
   \calm\vDash\phi(a_1,\dots,a_n)\leftrightarrow\caln\vDash\phi(j(a_1),\dots,j(a_n))
   \end{equation*}
   for all \(\call\)-formulas \(\phi(v_1,\dots,v_n)\) and all \(a_1,\dots,a_n\in
   M\)

   If \(\calm\) is a substructure of \(\caln\), we say that it is an *elementary
   substructure* and write \(\calm\prec\caln\) if the inclusion map is elementary.
   \(\caln\) is an *elementary extension* of \(\calm\)
   #+END_definition

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   \(\calm\) is an \(\call\)-structure. Let \(\call_M\) be the language where we
   add to \(\call\) constant symbols \(m\) for each element of $M$. The *atomic
   diagram* of \(\calm\) is
   \(\{\phi(m_1,\dots,m_n):\phi\) is either an atomic \(\call\)-formula or the negation of an atomic
   \(\call\)-formula and
   \(\calm\vDash\phi(m_1,\dots.m_n)\}\).
   The *elementary diagram* of $\calm$ is 
   \begin{equation*}
   \{\phi(m_1,\dots,m_n):\calm\vDash\phi(m_1,\dots,m_n),\phi\text{ an 
   \(\call\)-formula}\}
   \end{equation*}

   We let \(\Diag(\calm)\) and \(\Diag_{\el}(\calm)\) denote the atomic and
   elementary diagrams of \(\calm\)
   #+END_definition

   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   label:lemma2.3.3
   1. Suppose that \(\caln\) is an \(\call_M\)-structure and
      \(\caln\vDash\Diag(\calm)\), then viewing \(\caln\) as an
      \(\call\)-structure, there is an \(\call\)-embedding of \(\calm\) into \(\caln\)
   2. If \(\caln\vDash\Diag_{\el}(\calm)\), then there is an elementary
      embedding of \(\calm\) into \(\caln\)
   #+END_lemma

   #+BEGIN_proof
   1. Let \(j:M\to N\) by \(j(m)=m^{\caln}\). If \(m_1\neq m_2\in\Diag(\calm)\);
      thus \(j(m_1)\neq j(m_2)\) so $j$ is an embedding. If \(f\) is a function
      symbols of \(\call\) and \(f^{\calm}(m_1,\dots,m_n)=m_{n+1}\), then
      \(f(m_1,\dots,m_n)=m_{n+1}\) is a formula in \(\Diag(\calm)\) and 
      \(f^{\caln}(j(m_1),\dots,j(m_n))=j(m_{n+1})\). If \(R\) is a relation symbol
      and \(\bar{m}\in R^{\calm}\), then \(R(m_1,\dots,m_n)\in\Diag(\calm)\) and 
      \((j(m_1),\dots,j(m_{n}))\in R^{\caln}\). Hence \(j\) is an
      \(\call\)-embedding
   2. $j$ is elementary.

   #+END_proof

   #+ATTR_LATEX: :options [Upward Löwenheim–Skolem Theorem]
   #+BEGIN_theorem
   Let \(\calm\) be an infinite \(\call\)-structure and \kappa be an infinite
   cardinal \(\kappa\ge\abs{\calm}+\abs{\call}\). Then, there is \(\caln\) an
   \(\call\)-structure of cardinality \kappa and \(j:\calm\to\caln\) is elementary
   #+END_theorem

   #+BEGIN_proof
   Because \(\calm\vDash\Diag_{\el}(\calm)\), \(\Diag_{\el}(\calm)\) is
   satisfiable. By Theorem ref:thm2.1.11, there is
   \(\caln\vDash\Diag_{\el}(\calm)\) of cardinality \kappa. By Lemma ref:lemma2.3.3,
   there is an elementary \(j:\calm\to\caln\)
   #+END_proof

   #+ATTR_LATEX: :options [Tarski-Vaught Test]
   #+BEGIN_proposition
   label:prop2.3.5
   Suppose that \(\calm\) is a substructure of \(\caln\). Then \(\calm\) is an
   elementary substructure if and only if, for any formula \(\phi(v,\bar{w})\) and 
   \(\bar{a}\in M\), if there is \(b\in N\) s.t.
   \(\caln\vDash\phi(b,\bar{a})\), then there is \(c\in M\) s.t.
   \(\caln\vDash\phi(c,\bar{a})\) 
   #+END_proposition

   #+BEGIN_proof
   We need to show that for all \(\bar{a}\in M\) and all \(\call\)-formulas
   \(\psi(\bar{v})\)
   \begin{equation*}
   \calm\vDash\psi(\bar{a})\Leftrightarrow\caln\vDash\psi(\bar{a})
   \end{equation*}

   In Proposition ref:prop1.1.8, we showed that if \(\phi(\bar{v})\) is quantifier
   free then \(\calm\vDash\phi(\bar{a})\) if and only if \(\phi(\bar{a})\)
   #+END_proof

   We say that an \(\call\)-theory $T$ has *built-in Skolem functions* if for all
   \(\call\)-formulas \(\phi(v,w_1,\dots,w_n)\) there is a function symbol $f$ s.t.
   \(T\vDash\forall\bar{w}((\exists v\phi(v,\bar{w}))\to\phi(f(\bar{w}),\bar{w}))\). In other words, there are
   enough function symbols in the language to witness all existential statements.

   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   label:lemma2.3.6
   Let \(T\) be an \(\call\)-theory. There are \(\call^*\supseteq\call\) and 
   \(T^*\supseteq T\) an \(\call^*\)-theory s.t. \(T^*\) has built-in Skolem
   functions, and if \(\calm\vDash T\), then we can expand \(\calm\) to 
   \(\calm^*\vDash T^*\). We can choose \(\call^*\) s.t.
   \(\abs{\call^*}=\abs{\call}+\aleph_0\).

   We call \(T^*\) a *skolemization* of $T$
   #+END_lemma

   #+BEGIN_proof
   We build a sequence of languages
   \(\call=\call_0\subseteq\call_1\subseteq\dots\) and \(\call_i\)-theories
   \(T_i\) s.t. \(T=T_0\subseteq T_1\subseteq\dots\)

   Given \(\call_i\), let \(\call_{i+1}=\call\cup\{f_\phi:\phi(v,w_1,\dots,w_n)\text{ an }\call_i\text{-formula},n=1,2,\dots\}\),
   where \(f_\phi\) is an \(n\)-ary function symbol. For \(\phi(v,\bar{w})\) an
   \(\call_i\)-formula, let \(\Psi_\phi\) be the sentence
   \begin{equation*}
   \forall\bar{w}((\exists v\phi(v,\bar{w}))\to\phi(f_\phi(\bar{w}),\bar{w}))
   \end{equation*}
   and let \(T_{i+1}=T_i\cup\{\Psi_\phi:\phi\text{ an }\call_i\text{-formula}\}\)

   *Claim* If \(\calm\vDash T_i\), then we can interpret the function symbols of
   \(\call_{i+1}\backslash\call_i\) so that \(\calm\vDash T_{i+1}\)

   Let \(c\) be some fixed element of $M$. If \(\phi(v,w_1,\dots,w_n)\) is an
   \(\call_i\)-formula, we find a function \(g:M^n\to M\) s.t. 
   \(\bar{a}\in M^n\) and \(X_{\bar{a}}=\{b\in M:\calm\vDash\phi(b,\bar{a})\}\)
   is nonempty, then \(g(\bar{a})\in X_{\bar{a}}\), and if
   \(X_{\bar{a}}=\emptyset\), then \(g(\bar{a})=c\). Thus if 
   \(\calm\vDash\exists v\phi(v,\bar{a})\), then
   \(\calm\vDash\phi(g(\bar{a}),\bar{a})\). If we interpret \(f_\phi\) as
   \(g\), then \(\calm\vDash\Psi_\phi\)

   Let \(\call^*=\bigcup\call_i\) and \(T^*=\bigcup T_i\). If \(\phi(v,\bar{w})\)
   is an \(\call^*\)-formula, then \(\phi\in\call_i\) for some $i$ and 
   \(\Psi_\phi\in T_{i+1}\subseteq T^*\), so \(T^*\) has built in Skolem
   functions. By iterating the claim, we see that for any \(\calm\vDash T\) we
   can interpret the symbols of \(\call^*\backslash\call\) to make
   \(\calm\vDash T^*\)

   \(\abs{\call_{i+1}}=\abs{\call_i}+\aleph_0\)

   #+END_proof

   #+ATTR_LATEX: :options [Löwenheim–Skolem Theorem]
   #+BEGIN_theorem
   Suppose that \(\calm\) is an \(\call\)-structure and \(X\subseteq M\), there
   is an elementary submodel \(\caln\) of \(\calm\) s.t. \(X\subseteq N\) and 
   \(\abs{\caln}\le\abs{X}+\abs{\call}+\aleph_0\)
   #+END_theorem

   #+BEGIN_proof
   By Lemma ref:lemma2.3.6, we may assume that \(\Th(\calm)\) has built in
   Skolem functions (otherwise we may extend \(\call\) to some \(\call^*\)). Let
   \(X_0=X\). Given \(X_i\), let \(X_{i+1}=X_i\cup\{f^{\calm}(\bar{a}):f\text{ an
   }n\text{-ary function symbol},\bar{a}\in X^n_i,n=1,2,\dots\}\). Let
   \(N=\bigcup X_i\), then \(\abs{N}\le\abs{X}+\abs{\call}+\aleph_0\)
   If \(f\) is an \(n\)-ary function symbol of \(\call\) and \(\bar{a}\in N^n\),
   then \(\bar{a}\in X^n_i\) for some $i$ and 
   \(f^{\calm}(\bar{a})\in X_{i+1}\subseteq N\). Thus \(f^{\calm}|N:N^n\to N\). Thus
   we can interpret \(f\) as \(f^{\caln}=f^{\calm}|N^n\). If $R$ is an \(n\)-ary
   relation symbol, let \(R^{\caln}=R^{\calm}\cap N^n\). If \(c\) is a constant
   symbol of \(\call\), there is a Skolem function \(f\in\call\) s.t. 
   \(f(x)=c^{\calm}\) for all \(x\in M\) (for example, \(f\) is the Skolem
   function for the formula \(v=c\)) . Thus \(c^{\caln}\in N\)

   If \(\phi(v,\bar{w})\) is any \(\call\)-formula, \(\bar{a},b\in M\) and
   \(\calm\vDash\phi(b,\bar{a})\), then
   \(\calm\vDash\phi(f(\bar{a}),\bar{a})\) for some function symbol \(f\) of
   \(\call\). By construction, \(f^{\calm}(\bar{a})\in N\). Thus by Proposition
   ref:prop2.3.5 \(\caln\prec\calm\)
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   A *universal sentence* is one of the form \(\forall\bar{v}\phi(\bar{v})\), where
   \phi is quantifier-free. We say that an \(\call\)-theory $T$ has a *universal
   axiomatization* if there is a set of universal \(\call\)-sentences \Gamma s.t. 
   \(\calm\vDash\Gamma\) if and only if \(\calm\vDash T\) for all
   \(\call\)-structures \(\calm\)
   #+END_definition

   #+ATTR_LATEX: :options []
   #+BEGIN_theorem
   An \(\call\)-theory $T$ has a universal axiomatization if and only if
   whenever \(\calm\vDash T\) and \(\caln\) is a substructure of \(\calm\),
   then \(\caln\vDash T\). In other words, a theory is preserved under
   substructure if and only if it has a universal axiomatization
   #+END_theorem

   #+BEGIN_proof
   Suppose that \(\caln\subseteq\calm\). By Proposition ref:prop1.1.8, if
   \(\phi(\bar{v})\) is a quantifier-free formula and \(\bar{a}\in N\), then
   \(\caln\vDash\phi(\bar{a})\) if and only if \(\phi(\bar{a})\). Thus if
   \(\calm\vDash\forall\bar{v}\phi(\bar{v})\), then so does \(\caln\)

   Suppose that \(T\) is preserved under substructures. Let
   \(\Gamma=\{\phi:\phi\text{ is universal and }T\vDash\phi\}\). Clearly, if
   \(\caln\vDash T\), then \(\caln\vDash\Gamma\). For the other direction,
   suppose that \(\caln\vDash\Gamma\). We claim that \(\caln\vDash T\)

   *Claim* \(T\cup\Diag(\caln)\) is satisfiable

   Suppose not. Then, by the Compactness Theorem, there is a finite
   \(\Delta\subseteq\Diag(\caln)\) s.t. \(T\cup\Delta\) is not satisfiable. Let
   \(\Delta=\{\psi_1,\dots,\psi_n\}\). Let \(\bar{c}\) be the new constant
   symbols from \(N\) used in \(\psi_1,\dots,\psi_n\) and say
   \(\psi_i=\phi_i(\bar{c})\), where \(\phi_i\) is a quantifier-free
   \(\call\)-formula. Because the constants in \(\bar{c}\) do not occur in $T$, if
   there is a model of \(T\cup\{\exists\bar{v}\bigwedge\phi_i(\bar{v})\}\), then
   by interpreting \(\bar{c}\) as witness to the existential formula,
   \(T\cup\Delta\) would be satisfiable. Thus
   \(T\vDash\forall\bar{v}\bigvee\neg\phi_i(\bar{v})\). As the latter formula
   is universal, \(\forall\bar{v}\bigvee\neg\phi_i(\bar{v})\in\Gamma\),
   contradicting \(\caln\vDash\Gamma.\)

   By Lemma ref:lemma2.3.3, there is \(\calm\vDash T\) with
   \(\calm\supseteq\caln\). Because $T$ is preserved under substructure,
   \(\caln\vDash T\) and \Gamma is a universal axiomatization
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   Suppose that \((I,<)\) is a linear order. Suppose that \(\calm_i\) is an
   \(\call\)-structure for \(i\in I\). We say that \((\calm_i:i\in I)\) is a
   chain of \(\call\)-strctures if \(\calm_i\subseteq\calm_j\) for \(i<j\). If
   \(\calm_i\prec\calm_j\) for \(i<j\), we call \((\calm_i:i\in I)\) an 
   *elementary chain*
   #+END_definition

   If \((\calm_i:i\in I)\) is a nonempty chain of structures, then we can define
   \(\calm=\bigcup_{i\in I}\calm_i\), the union of the chain, as follows. 
   \(M=\bigcup_{i\in I}M_i\). if \(c\) is a constant in the language, then
   \(c^{\calm_i}=c^{\calm_j}\) for all \(i,j\in I\). Let
   \(c^{\calm}=c^{\calm_i}\).

   Suppose that \(\bar{a}\in M\). Because $I$ is linearly ordered, we can find
   \(i\in I\) s.t. \(\bar{a}\in M_i\). If \(f\) is a function symbol of
   \(\call\) and \(i<j\), then \(f^{\calm_i}(\bar{a})=f^{\calm_j}(\bar{a})\).
   Thus \(f^{\calm}=\bigcup_{i\in I}f^{\calm_i}\) is a well-defined function.
   Similarly, \(R^{\calm}=\bigcup_{i\in I}R^{\calm_i}\)

   #+ATTR_LATEX: :options []
   #+BEGIN_proposition
   label:prop2.3.11
   Suppose that \((I,<)\) is a linear order and \((\calm_i:i\in I)\) is an
   elementary chain. Then \(\calm=\bigcup_{i\in I}\calm_i\) is an elementary
   extension of each \(\calm_i\)
   #+END_proposition

   #+BEGIN_proof
   We prove by induction on formulas that 
   \begin{equation*}
   \calm\vDash\phi(\bar{a})\Leftrightarrow\calm_i\vDash\phi(\bar{a})
   \end{equation*}
   for all \(i\in I\), all formulas \(\phi(\bar{v})\), and all \(\bar{a}\in M_i^n\) 

   Because \(\calm_i\) is a substructure of \(\calm\), by Proposition
   ref:prop1.1.8 this is true for all atomic \phi. \(\neg\phi\) and
   \(\phi\vee\psi\) is easy.

   Suppose that \(\phi\) is \(\exists v\psi(v,\bar{w})\) and the chain holds for
   \psi. If \(\calm_i\vDash\psi(b,\bar{a})\), then so does \(\calm\). Thus if
   \(\calm_i\vDash\phi(\bar{a})\), then so does \(\calm\). On the other hand,
   if \(\calm\vDash\psi(b,\bar{a})\), there is \(j\ge i\) s.t. \(b\in M_j\). By
   induction, \(\calm_j\vDash\psi(b,\bar{a})\), so
   \(\calm_j\vDash\phi(\bar{a})\). Because \(\calm_i\prec\calm_j\), \(\calm_i\vDash\phi(\bar{a})\)
   #+END_proof


** Back and Forth

*** Dense Linear Orders
    Let \(\call=\{<\}\) and let DLO be the theory of dense linear orders without
    endpoints. DLO is axiomatized by the axioms for linear orders plus the
    axioms
    \begin{align*}
    &\forall x\forall y\;(x<y\to \exists z\;x<z<y)\\
    &\forall x\exists y\exists z\; y<x<z
    \end{align*}
    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm2.4.1
    The theory DLO is \(\aleph_0\)-categorical and complete
    #+END_theorem

    #+BEGIN_proof
    Let \((A,<)\) and \((B,<)\) be two countable models of DLO. Let
    \(a_0,a_1,a_2,\dots\) and \(b_0,b_1,b_2,\dots\) be one-to-one enumerations
    of \(A\) and \(B\). We will build a sequence of partial bijections
    \(f_i:A_i\to B_i\) where \(A_i\subset A\) and \(B_i\subset B\) are finite
    s.t. \(f_0\subseteq f_1\subseteq\dots\) and if \(x,y\in A_i\) and \(x<y\),
    then \(f_i(x)<f_i(y)\). We call \(f_i\) a *partial embedding*. We will build
    these sequences s.t. \(A=\bigcup A_i\) and \(B=\bigcup B_i\). In this case,
    \(f=\bigcup f_i\) is the desired isomorphism from \((A,<)\) to \((B,<)\)

    At odd stages of the construction we will ensure that \(\bigcup A_i=A\), and
    at even stages we will ensure that \(\bigcup B_i=B\)

    _stage 0_: Let \(A_0=B_0=f_0=\emptyset\)

    _stage \(n+1=2m+1\)_: We will ensure that \(a_m\in A_{n+1}\).

    If \(a_m\in A_n\), then let \(A_{n+1}=A_n\), \(B_{n+1}=B_n\) and
    \(f_{n+1}=f_n\). Suppose that \(a_m\not\in A_n\). To add \(a_m\) to the
    domain of our partial embedding, we must find \(b\in B\backslash B_n\) s.t.
    \begin{equation*}
    \alpha<a_m\Leftrightarrow f_n(\alpha)<b
    \end{equation*}
    for all \(\alpha\in A_n\). In other words, we must find \(b\in B\), which is
    the image under \(f_n\) of the cut of \(a_m\) in \(A_n\). Exactly one of the
    following holds:
    1. \(a_m\) is greater than every element of \(A_n\), or
    2. \(a_m\) is than than every element of \(A_n\), or
    3. there are \alpha and \(\beta\in A_n\) s.t. \(\alpha<\beta\),\(\gamma\le\alpha\) or
       \(\gamma\ge\beta\) for all \(\gamma\in A_n\) and \(\alpha<a_m<\beta\)


    In case 1 because \(B_n\) is finite and \(B\vDash\DLO\),we can find 
    \(b\in B\) greater than every element of \(B_n\). Similar for case 2. In
    case 3, because \(f_n\) is a partial embedding, \(f_n(\alpha)<f_n(\beta)\) and we can
    choose \(b\in B_n\) s.t. \(f_n(\alpha)<b<f_n(\beta)\). Note that 
    \begin{equation*}
    \alpha<a_m\Leftrightarrow f_n(\alpha)<b
    \end{equation*}
    for all \(\alpha\in A_n\)

    _stage \(n+1=2m+2\)_: We will ensure \(b_m\in B_{n+1}\)

    Again, if \(b_m\) is already in \(B_n\), then we make no changes. Otherwise,
    we must find \(a\in A\) s.t. the image of the cut of \(a\) in \(A_n\) is the
    cut of \(b_m\) in \(B_n\). This is done in odd case.

    Clearly, at odd stages we have ensured that \(\bigcup A_n=A\) and at even
    stages we have ensured that \(\bigcup B_n=B\). Because each \(f_n\) is a
    partial embedding, \(f=\bigcup f_n\) is an isomorphism from \(A\) onto \(B\)

    But there are no finite dense linear orders, Vaught's test implies that DLO
    is complete
    #+END_proof

*** The Random Graph
    Let \(\call=\{R\}\), where $R$ is a binary relation symbol. We will consider
    an \(\call\)-theory containing the graph axioms \(\forall x\;\neg R(x,x)\) and 
    \(\forall x\forall y\; R(x,y)\to R(y,x)\). Let \(\psi_n\) be the "extension
    axiom"
    \begin{equation*}
    \forall x_1\dots\forall x_n\forall y_1\dots\forall y_n\;
    \left(\displaystyle\bigwedge_{i=1}^n\bigwedge_{j=1}^nx_1\neq y_j\to
    \exists z\;\bigwedge_{i=1}^n(R(x_i,z)\wedge\neg R(y_i,z))
    \right)
    \end{equation*}
    We let $T$ be the theory of graphs where we add 
    \(\{\exists x\exists y\; x\neq y\}\cup\{\psi_n:n=1,2,\dots\}\) to the graph
    axioms. A model of $T$ is a graph where for any finite disjoint sets \(X\)
    and \(Y\) we can find a vertex with edges going to every vertex in $X$ and
    no vertex in \(Y\)
    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    $T$ is satisfiable and \(\aleph_0\)-categorical. In particular, $T$ is
    complete and decidable
    #+END_theorem

    #+BEGIN_proof
    We first build a countable model of $T$. Let \(G_0\) be any countable graph

    *Claim* There is a graph \(G_1\supseteq G_0\) s.t. \(G_1\) is countable and if
    \(X\) and $Y$are disjoint finite subsets of \(G_0\) then there is 
    \(z\in G_1\) s.t. \(R(x,z)\) for \(x\in X\) and \(\neg R(y,z)\) for \(y\in
    Y\)

    Let the vertices of \(G_1\) be the vertices of \(G_0\) plus new vertices
    \(z_X\) for each \(X\subseteq G_0\). The edges of \(G_1\) are the edges of
    \(G\) together  with new edges between \(x\) and \(z_X\) whenever 
    \(X\subseteq G_0\) is finite and \(x\in X\).

    We iterate this construction to build a sequence of countable graphs 
    \(G_0\subset G_1\subset\dots\) s.t. if \(X\) and \(Y\) are disjoint finite
    subsets of \(G_i\), then there is \(z\in G_{i+1}\) s.t. \(R(x,z)\) for
    \(x\in X\) and \(\neg R(y,z)\) for \(y\in Y\). Thus \(G=\bigcup G_n\) is a
    countable model of \(T\)

    Next we show that \(T\) is \(\aleph_0\)-categorical. Let \(G_1\) and \(G_2\)
    be countable models of \(T\). Let \(a_0,a_1,\dots\) list \(G_1\), and let
    \(b_0,b_1,\dots\) list \(G_2\). We will build a sequence of finite partial
    one-to-one maps \(f_0\subseteq f_1\subseteq f_2\subseteq\dots\) s.t. for all
    \(x,y\) in the doamin of \(f_s\),
    \begin{equation*}
    G_1\vDash R(x,y)\Leftrightarrow G_2\vDash R(f_s(x),f_s(y))
    \end{equation*}
    Let \(f_0=\emptyset\)
    _stage \(s+1=2i+1\)_: We make sure that \(a_i\) is in the domain
    
    If \(a_i\) is in the domain of \(f_s\), let \(f_{s+1}=f_s\). If not, let
    \(\alpha_1,\dots,\alpha_m\) list the domain of \(f_s\) and let 
    \(X=\{j\le m:R(\alpha_j,a_i)\}\) and let \(Y=\{j\le m:\neg
    R(\alpha_j,a_i)\}\). Because 
    \(G_2\vDash T\), we can find \(b\in G_2\) s.t. \(G_2\vDash
    R(f_s(\alpha_j),b)\) for \(j\in X\) and 
    \(G_2\vDash\neg R(f_s(\alpha_j),b)\) for \(j\in Y\). Let
    \(f_{s+1}=f_s\cup\{(a_i,b)\}\). 
    
    _stage \(s+1=2i+2\)_: Similar
    #+END_proof

    Let \(\calg_N\) be the set of all graphs with vertices \(\{1,2,\dots,N\}\).
    We consider a probability measure on \(\calg_N\) where we make all graphs
    equally likely. This is the same as constructing a random graph where we
    independently decide whether there is an edge between \(i\) and \(j\) with
    probability \(\frac{1}{2}\). For any \(\call\)-sentence \phi,
    \begin{equation*}
    p_N(\phi)=\frac{\abs{\{G\in\calg_N:G\vDash\phi\}}}{\abs{\calg_N}}
    \end{equation*}
    is the probability that a random element of \(\calg_N\) satisfies \phi

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma2.4.3
    \(\lim_{N\to\infty}p_N(\psi_n)=1\)
    #+END_lemma

    #+BEGIN_proof
    Fix $n$. Let \(G\) be a random graph in \(\calg_N\) where \(N>2n\). Fix 
    \(x_1,\dots,x_n,y_1,\dots,y_n,z\in G\) distinct. Let \(q\) be the
    probability that 
    \begin{equation*}
    \neg\left(
    \displaystyle\bigwedge_{i=1}^n(R(x_i,z))\wedge\neg R(y_i,z)
    \right)
    \end{equation*}
    Then \(q=1-2^{-2n}\). Because these probabilities are independent, the
    probability that 
    \begin{equation*}
    G\vDash\neg\exists z\neg\left(
    \displaystyle\bigwedge_{i=1}^n(R(x_i,z))\wedge\neg R(y_i,z)
    \right)
    \end{equation*}
    is \(q^{N-2n}\). Let $M$ be the number of pairs of disjoint subsets of \(G\)
    of size $n$. Thus
    \begin{equation*}
    p_N(\neg\psi_n)\le Mq^{N-2n}<N^{2n}q^{N-2n}
    \end{equation*}
    Because \(q<1\)
    \begin{equation*}
    \lim_{N\to\infty}p_N(\neg\psi_n)=\lim_{N\to\infty}N^{2n}q^N=0
    \end{equation*}
    #+END_proof

    #+ATTR_LATEX: :options [Zero-One Law for Graphs]
    #+BEGIN_theorem
    label:thm2.4.4
    For any \(\call\)-sentence \phi either \(\lim_{N\to\infty}p_N(\phi)=0\) or 
    \(\lim_{N\to\infty}p_N(\phi)=1\). Moreover, \(T\) axiomatizes
    \(\{\phi:\lim_{N\to\infty}p_N(\phi)=1\}\), the *almost sure theory graphs*. The
    almost sure theory of graphs is decidable and complete
    #+END_theorem

    #+BEGIN_proof
    If \(T\vDash\phi\), then there is \(n\) s.t. if \(G\) is a graph and
    \(G\vDash\psi_n\), then \(G\vDash\phi\). Thus,
    \(p_N(\phi)\ge\phi_N(\psi_n)\) and by Lemma ref:lemma2.4.3, \(\lim_{N\to\infty}p_N(\phi)=1\).
    #+END_proof

*** Ehrenfeucht-Fraïssé Games
    Let \(\call\) be a language and \(\calm=(M,\dots)\) and \(\caln=(N,\dots)\)
    be two \(\call\)-structures with \(M\cap N=\emptyset\). If \(A\subseteq M\),
    \(B\subseteq N\) and \(f:A\to B\), we wsay that \(f\) is a *partial embedding*
    if \(f\cup\{(c^{\calm},c^{\caln}):c\text{ a constant of }\call\}\)is a bijection
    preserving all relations and functions of \(\call\)

    We will define an infinite two-player game \(G_\omega(\calm,\caln)\). We
    will call the two players player \rom{1} and player \rom{2}; together they
    will build a partial embedding \(f\) from \(M\) to \(N\). A play of the game
    will consist of \omega stages. At the \(i\)th-stage, player \rom{1} moves first
    and either plays \(m_i\in M\), challenging player \rom{2} to put \(m_i\)
    into the domain of \(f\), or \(n_i\in N\), challenging player \rom{2} to put
    \(n_i\) into the range. If player \rom{1} plays \(m_i\in M\), then player
    \rom{2} must play \(n_i\in N\), whereas if player \rom{1} plays 
    \(n_i\in M\), then player \rom{2} must play \(m_i\in M\). Player \rom{2} wins the
    play of the game if \(f=\{(m_i,n_i):i=1,2,\dots\}\) is the graph of a
    partial embedding.

    A *strategy* for player \rom{2} in \(G_\omega(\calm,\caln)\) is a function \tau
    s.t. if player \rom{1}'s first \(n\) moves are \(c_1,\dots,c_n\) , then
    player \rom{2}'s \(n\)th move will be \(\tau(c_1,\dots,c_n)\). We say that
    player \rom{2} uses the strategy \tau in the play of the game if the play looks
    like
    #+ATTR_LATEX: :align cc
    | Player \rom{1} | Player \rom{2}        |
    | \(c_1\)        |                       |
    |                | \(\tau(c_1)\)         |
    | \(c_2\)        |                       |
    |                | \(\tau(c_1,c_2)\)     |
    | c_3            |                       |
    |                | \(\tau(c_1,c_2,c_3)\) |
    | \(\vdots\)     | \(\vdots\)            |


    We say that \tau is a *winning strategy* for player \rom{2}, if for any sequence
    of plays \(c_1,\dots\) player \rom{1} makes, player \rom{2} will win by
    following \tau. We define strategies for player \rom{1} analogously

    For example, suppose that \(\calm,\caln\vDash\DLO\). Then player \rom{2}
    has a winning strategy. Suppose that up to stage $n$ they have built a
    partial embedding \(g:A\to B\). If player \rom{1} plays \(a\in M\), then
    player \rom{2} plays \(b\in N\) s.t. the cub $b$ makes in \(B\) is the image
    of the cut of \(a\) in \(A\) under \(g\). Similar for player \rom{1}'s
    \(b\in N\)

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    If \(\calm\) and \(\caln\) is countable, then the second player has a wining
    strategy in \(G_\omega\) if and only if \(\calm\cong\caln\)
    #+END_proposition

    #+BEGIN_proof
    If \(\calm\cong\caln\), player \rom{2} can win by playing according to the
    isomorphism

    Suppose that player \rom{2} has a winning strategy. Let \(m_0,m_1,\dots\)
    list \(M\) and \(n_0,n_1,\dots\) list $N$. Consider a play of the game where
    the second player uses the winning strategy and the first player plays 
    \(m_0,n_0,m_1,n_1,m_2,n_2,\dots\). If \(f\) is the partial embedding build
    during this play of the game then the domain of \(f\) is $M$ and the range
    of \(f\) is $N$. Thus \(f\) is an isomorphism
    #+END_proof

    [[index:Ehrenfeucht-Fraïssé Games]]

    _Fix \(\call\) a finite language with no function symbols_, and let \(\calm\)
    and \(\caln\) be \(\call\)-structures. We define a game \(G_n(\calm,\caln)\)
    for \(n=1,2,\dots\). The game will have \(n\) rounds similar to \omega rounds
    . Player \rom{2} wins if
    \(\{(a_i,b_i):i=1,\dots,n\}\) is the graph of a partial embedding from
    \(\calm\) into \(\caln\). We call \(G_n(\calm,\caln)\) an 
    *Ehrenfeucht-Fraïssé Games*
    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    Let \(\call\) be a finite language without function symbols and let
    \(\calm\) and \(\caln\) be \(\call\)-structures. Then \(\calm\equiv\caln\)
    if and only if the second player has a wining strategy in
    \(G_n(\calm,\caln)\) for all \(n\)
    #+END_theorem

    We need several lemmas.

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    One of the players has a winning strategy in \(G_n(\calm,\caln)\)
    #+END_lemma

    #+BEGIN_proof
    Suppose that player \rom{2} does not have a winning strategy. Then there is
    some move player \rom{1} can make in round one so that player \rom{2} has no
    move available to force a win. Player \rom{1} makes that move. Now, whatever
    player \rom{2} does, there is still a move that if made by player \rom{1}
    means that player \rom{2} cannot force a win.
    #+END_proof

    We inductively define \(\text{depth}(\phi)\), the *quantifier depth* of an
    \(\call\)-formula \phi, as follows
    
    \(\text{depth}(\phi)=0\) if and only if \phi is quantifier-free

    \(\text{depth}(\neg\phi)=\text{depth}(\phi)\)
    
    \(\text{depth}(\phi\wedge\psi)=\text{depth}(\phi\vee\psi)=
    \max\{\text{depth}(\phi),\text{depth}(\psi)\}\)

    \(\text{depth}(\exists v\phi)=\text{depth}(\phi)+1\)

    We say that \(\calm\equiv_n\caln\) if
    \(\calm\vDash\phi\Leftrightarrow\caln\vDash\phi\) for all sentences of
    depth at most $n$. We will show player \rom{2} has a winning strategy in
    \(G_n(\calm,\caln)\) if and only if \(\calm\equiv_n\caln\)

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    For each \(n\) and \(l\), there is a finite list of formulas
    \(\phi_1,\dots,\phi_k\) of depth at most \(n\) in free variables
    \(x_1,\dots,x_l\) s.t. every formula of depth at most $n$ in free variables
    \(x_1,\dots,x_l\) is equivalent to some \(\phi_i\)
    #+END_lemma

    #+BEGIN_proof
    We first prove this for quantifier-free formulas. Because \(\call\) is
    finite and has no function symbols, there are only finitely many atomic
    \(\call\)-formulas in free variables \(x_1,\dots,x_l\). Let
    \(\sigma_1,\dots,\sigma_s\) list all such formulas.

    If \phi is a Boolean combination of formulas \(\tau_1,\dots,\tau_s\), then
    there is \(S\) a collection of subsets of \(\{1,\dots,s\}\) s.t.
    \begin{equation*}
    \vDash\phi\leftrightarrow\displaystyle
    \bigvee_{X\in S}\left(\bigwedge_{i\in X}\tau_i\wedge
    \bigwedge_{i\not\in X}\neg\tau_i
    \right)
    \end{equation*}
    This gives a list of \(2^{2^s}\) formulas s.t. every Boolean combination of
    \(\tau_1,\dots,\tau_s\) is equivalent to a formula in this list. In
    particular, because quantifier free formulas are Boolean combinations of
    atomic formulas, there is a finite list of depth-zero formulas s.t. every
    depth-zero formula is equivalent to one in the list.

    Because formulas of depth \(n+1\) are Boolean combinations of 
    \(\exists v\phi\) and \(\forall v\phi\) where \phi has depth at most \(n\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    Let \(\call\) be a finite language without function symbols and \(\calm\)
    and \(\caln\) be \(\call\)-structures. The second player has a winning
    strategy in \(G_n(\calm,\caln)\) if and only if \(\calm\equiv_n\caln\)
    #+END_lemma

    #+BEGIN_proof
    Induction on \(n\)

    Suppose that \(\calm\equiv_n\caln\). Consider a play of the game where in
    round one player \rom{1} plays \(a\in M\). We claim that there is
    \(b\in\caln\) s.t. \(\calm\vDash\phi(a)\Leftrightarrow\caln\vDash\phi(b)\)
    whenever \(\depth(\phi)<n\). Let \(\phi_0(v),\dots,\phi_m(v)\) list, up to
    equivalance, all formulas of depth less than \(n\). Let 
    \(X=\{i\le m:\calm\vDash\phi_i(a)\}\), and let \(\Phi(v)\) be the formula
    \begin{equation*}
    \displaystyle\bigwedge_{i\in X}\phi_i(v)\wedge\bigwedge_{i\not\in X}
    \neg\phi_i(v)
    \end{equation*}
    Then, \(\depth(\exists v\Phi(v))\le n\) and \(\calm\vDash\Phi(a)\); thus
    there is \(b\in N\) s.t. \(\caln\vDash\Phi(b)\). Player \rom{2} plays \(b\)
    in round one

    If \(n=1\), the game has now concluded and \(a\mapsto b\) is a partial
    embedding so player \rom{2} wins. Suppose that \(n>1\)

    Let \(\call^*=\call\cup\{c\}\), where \(c\) is a new constant symbol. View
    \(\calm\) and \(\caln\) as \(\call^*\)-structures \((\calm,a)\) and
    \((\caln,b)\) where we interpret the new constant as \(a\) and \(b\)
    respectively. Because 
    \begin{equation*}
    \calm\vDash\phi(a)\Leftrightarrow\caln\vDash\phi(b)
    \end{equation*}
    for \(\phi(v)\) an \(\call\)-formula with \(\depth(\phi)<n\),
    \((\calm,a)\equiv_{n-1}(\caln,b)\). By induction, player \rom{2} has a
    winning strategy in \(G_{n-1}((\calm,a),(\caln,b))\). If player's second
    play is \(d\), player \rom{2} responds as if \(d\) was player \rom{1}'s
    first play in \(G_{n-1}((\calm,a),(\caln,b))\)' and continues playing using
    this strategy, that is, in round $i$ player \rom{1} has plays
    \(a,d_2,\dots,d_i\), then player \rom{2} plays \(\tau(d_2,\dots,d_i)\), where 
    \(\tau\) is his winning strategy in \(G((\calm,a),(\caln,b))\).
    #+END_proof

*** Scott-Karp Analysis
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \(\call\) be a language and \kappa an infinite cardinal. The formulas of the infinitary
    logic \(\call_{\kappa,\omega}\) are defined inductively as follows:
    1. Every atomic \(\call\)-formula is a formula of \(\call_{\kappa,\omega}\)
    2. If \(X\) is a set of formulas of \(\call_{\kappa,\omega}\) s.t. all of the free variables come from a fixed
       finite set and \(\abs{X}<\kappa\), then
       \begin{equation*}
       \bigwedge_{\phi\in X}\phi \quad\text{ and }\quad\bigvee_{\phi\in X}\phi
       \end{equation*}
       are formulas of \(\call_{\kappa,\omega}\)
    3. If \phi s a formula of \(\call_{\kappa,\omega}\), then so are \(\neg\phi\), \(\forall v\;\phi\) and \(\exists v\;\phi\)


    We say that \phi is a formula of \(\call_{\infty,\omega}\) if it is an \(\call_{\kappa,\omega}\)-formula for some infinite
    cardinal \kappa.
    #+END_definition

** Exercises
   #+BEGIN_exercise
   label:ex2.5.1
   We say that an ordered group \((G,+,<)\) is *Archimedean* if for all
   \(x,y\in G\) with \(x,y>0\) there is an integer \(m\) s.t.
   \(\abs{x}<m\abs{y}\). Show that there are non-Archimedean fields elementarily
   equivalent to the field of real numbers
   #+END_exercise

   #+BEGIN_exercise
   label:ex2.5.10
   Let \(T\) be an \(\call\)-theory and \(T_\forall\) be all of the universal
   sentences \phi s.t. \(T\vDash\phi\). Show that \(\cala\vDash T_\forall\) if and only
   if there is \(\calm\vDash T\) with \(\cala\subseteq\calm\)
   #+END_exercise

   #+BEGIN_proof
   Comes from [[http://www.math.uni-konstanz.de/~eleftheriou/teaching/Masterarbeit.pdf][Quantifier Elimination Tests and Examples]]
   
   Consider the theory \(T'=T\cup\Diag(\cala)\) in the language \(\call_A\). We
   will show by contradiction that \(T'\) is satisfiable.

   Suppose that \(T'\) is not satisfiable. Then by the Compactness Theorem,
   already some finite subset \(\Delta\subseteq T'\) is not satisfiable. By forming
   conjunctions we may assume that the part of \Delta coming from \(\Diag(\cala)\)
   consists only of one formula \(\phi(\bar{a})\) for some \(\bar{a}\in\ A\), where
   \(\phi(\bar{a})\) is a conjunction of atomic formulas and the negation of atomic
   formulas. Thus we will assume that \(T\cup\{\phi(\bar{a})\}\) is not satisfiable.

   On the other hand, viewing \(T\) as an \(\call_{\bar{a}}\)-theory, and because
   \(T\cup\{\phi(\bar{a})\}\) is not satisfiable, we obtain
   \(T\vDash\neg\phi(\bar{a})\). We will show that this implies
   \(T\vDash\forall\bar{v}\neg\phi(\bar{v})\): Let \(\calc\) be an
   \(\call\)-structure with \(\calc\vDash T\). Let \(n\) be the number of
   components in \(\bar{a}\) and \(c_1,\dots,c_n\in C\). Let \(C'\) be the
   \(\call_{\bar{a}}\)-structure which expands \(\calc\) by the constant symbols
   that we interpret as \(c_1,\dots,c_n\) respectively. Then \(\calc'\vDash T\) and
   hence \(\calc'\vDash\neg\phi(\bar{c})\). As this follows for any tuple in
   \(C\), we get \(\calc\vDash\forall\bar{v}\neg\phi(\bar{v})\)

   Since \(T_\forall\) consists exactly of the universal formulas which hold in all
   models of \(T\), we obtain \(T_\forall\vDash\forall x\neg\phi(x)\). Hence also
   \(\cala\vDash\forall x\neg\phi(x)\), a contradiction

   Therefore \(T'\) is indeed satisfiable
   #+END_proof

   #+BEGIN_exercise
   Suppose that \(\calm_0\subset\calm_1\subset\calm_2\), \(\calm_0\prec\calm_2\) and \(\calm_1\prec\calm_2\). Show that \(\calm_0\prec\calm_1\)
   #+END_exercise

   #+BEGIN_proof
   In \(L(M_0)\), \(\fM_0\prec\calm_2\) iff \(\fM_2\vDash\Diag(\fM_0)\). As \(\calm_1\prec\calm_2\), \(\fM_1\vDash\Diag(\fM_0)\). Thus in the
   original language, \(\calm_0\prec\calm_1\)
   #+END_proof

   #+ATTR_LATEX: :options [Amalgamation]
   #+BEGIN_exercise
   label:ex2.5.11
   Suppose that \(\calm_0\), \(\calm_1\) and \(\calm_2\) are \(\call\)-structures and \(j_i:\calm_0\to\calm_i\) is an elementary
   embedding for \(i=1,2\). Show that there is an \(\call\)-structure \(\caln\) and elementary
   embedding \(f_i:\calm_i\to\caln\) s.t. \(f_1\circ j_1=f_2\circ j_2\).t
   #+END_exercise

   #+BEGIN_proof
   Guide from [[https://math.stackexchange.com/questions/1134284/prove-elementary-amalgamation-theorem-in-model-theory][stack]].

   Consider \(\call_+=\call(M_1\sqcup_{M_0} M_2)\) (this set is the disjoint union of \(M_1\) and \(M_2\) where elements
   \(j_0(x)\) and \(j_1(x)\) are identified.
   \begin{equation*}
   M_1\sqcup_{M_0}M_2=M_1\sqcup M_2/\sim
   \end{equation*}
   where \(a\sim b\) iff \(a=j_1(x)\) and \(b=j_2(x)\))
   We want to show that the \(\call_+\)-theory
   \begin{equation*}
   \Th_{M_1}(\calm_1)\cup\Th_{M_2}(\calm_2)
   \end{equation*}
   is finitely satisfiable. For any \(\varphi(\barm_1)\in\Th_{M_1}(\calm_1)\) and \(\psi(\barm_2)\in\Th_{M_2}(\calm_2)\). As
   both \(\exists\barx\varphi(\barx)\) and \(\exists\bary\psi(\bary)\) are belong to \(\Th(\calm_0)\), \(\calm_0\vDash\varphi(\bara)\)
   and \(\calm_0\vDash\psi(\barb)\). Then \(\calm_1\vDash\varphi(j_1(\bara))\wedge\psi(j_1(\barb))\). Then we can just
   interpret \(\barm_1\) as \(j_1(\bara)\) and \(\barm_2\) as \(j_1(\barb)\).

   Thus we have a model \(\caln\) of the theory and \(\caln\vDash\forall x\in M\;j_1(x)=j_2(x)\). Let \(f_1\) and \(f_2\)
   be the inclusion
   #+END_proof

* Algebraic Examples

** Quantifier Elimination
    Let \(\phi(a,b,c)\) be the formula
    \begin{equation*}
    \exists x\;ax^2+bx+c=0
    \end{equation*}
    By the quadratic formula,
    \begin{equation*}
    \R\vDash\phi(a,b,c)\leftrightarrow[(a\neq 0\wedge b^2-4ac\ge 0)\vee(a=0\wedge(b\neq 0\vee c=0))]
    \end{equation*}
    whereas in the complex numbers
    \begin{equation*}
    \C\vDash\phi(a,b,c)\leftrightarrow(a\neq 0\vee b\neq 0\vee c=0)
    \end{equation*}
   #+ATTR_LATEX: :options []
   #+BEGIN_definition
   We say that a theory $T$ has *quantifier elimination* if for every formula \phi
   there is a quantifier-free formula \psi s.t.
   \begin{equation*}
   T\vDash\phi\leftrightarrow\psi
   \end{equation*}
   #+END_definition

   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   Let \((A,<)\) and \((B,<)\) be countable dense linear orders,
   \(a_1,\dots,a_n\in A\), \(b_1,\dots,b_n\in B\), s.t. \(a_1<\dots<a_n\) and
   \(b_1,\dots<b_n\). Then there is an isomorphism \(f:A\to B\) s.t.
   \(f(a_i)=b_i\) for all \(i=1,\dots,n\)
   #+END_lemma
   
   #+BEGIN_proof
   Modify the proof of Theorem ref:thm2.4.1 starting with
   \(A_0=\{a_1,\dots,a_n\}\), \(B_0=\{b_1,\dots,b_n\}\), and the partial
   isomorphism \(f_0:A_0\to B_0\), where \(f_0(a_i)=b_i\).
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_theorem
   DLO has quantifier elimination
   #+END_theorem
   #+BEGIN_proof
   First, suppose that \(\phi\) is a sentence. If \(\Q\vDash\phi\), then
   because DLO is complete, \(\DLO\vDash\phi\), and 
   \begin{equation*}
   \DLO\vDash\phi\leftrightarrow x_1=x_1
   \end{equation*}
   whereas if \(\Q\vDash\neg\phi\)
   \begin{equation*}
   \DLO\vDash\phi\leftrightarrow x_1\neq x_1
   \end{equation*}

   Now suppose that \phi is a formula with free variables \(x_1,\dots,x_n\) where
   \(n\ge1\). We will show that there is a quantifier-free formula \psi with free
   variables from among \(x_1,\dots,x_n\) s.t.
   \begin{equation*}
   \Q\vDash\forall\bar{x}(\phi(\bar{x})\leftrightarrow\psi(\bar{x}))
   \end{equation*}
   Because DLO is complete,
   \begin{equation*}
   \DLO\vDash\forall\bar{x}(\phi(\bar{x})\leftrightarrow\psi(\bar{x}))
   \end{equation*}
   so this will suffices.

   For \(\sigma:\{(i,j):1\le i<j\le n\}\to3\), let \(\chi_\sigma(x_1,\dots,x_n)\) be the formula
   \begin{equation*}
   \displaystyle\bigwedge_{\sigma(i,j)=0}x_i=x_j\wedge
   \bigwedge_{\sigma(i,j)=1}x_i<x_j\wedge
   \bigwedge_{\sigma(i,j)=2}x_i>x_j
   \end{equation*}
   We call \(\chi_\sigma\) a *sign condition*.

   Let \(\call\) be the language of linear orders and \phi be an
   \(\call\)-formula with \(n\ge1\) free variables. Let \(\Lambda_\phi\) be the
   set of sign conditions s.t. there is \(\bar{a}\in\Q\) s.t.
   \(\Q\vDash\chi_\sigma(\bar{a})\wedge\phi(\bar{a})\)

   
   _case 1:_ \(\Lambda_\phi=\emptyset\)

   Then \(\Q\vDash\forall\bar{x}\neg\phi(\bar{x})\) and
   \(\Q\vDash\phi(\bar{x})\leftrightarrow x_1\neq x_1\)

   _case 2:_ \(\Lambda_\phi\neq\emptyset\)

   Let
   \begin{equation*}
   \psi_\phi(\bar{x})=\displaystyle\bigwedge_{\sigma\in\Lambda_\phi}\chi_\sigma(\bar{x})
   \end{equation*}

   By choice of \(\Lambda_\phi\),
   \begin{equation*}
   \Q\vDash\phi(\bar{x})\to\psi_\phi(\bar{x})
   \end{equation*}

   On the other hand, suppose that \(\bar{b}\in\Q\) and
   \(\Q\vDash\psi_\phi(\bar{b})\). Let \(\sigma\in\Lambda_\phi\) s.t. \(\Q\vDash\chi_\sigma(\bar{b})\).
   There is \(\bar{a}\in\Q\) s.t. \(\Q\vDash\phi(\bar{a})\wedge\chi_\sigma(\bar{a})\). By Theorem
   ref:thm2.4.1, there is \(f\), an automorphism of \((\Q,<)\) s.t.
   \(f(\bar{a})=\bar{b}\). By Theorem ref:thm1.1.10, \(\Q\vDash\phi(\bar{b})\).
   Thus \(\phi(\bar{b})\leftrightarrow\psi_\phi(\bar{b})\)
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_theorem
   label:thm3.1.4
   Suppose that \(\call\) contains a constant symbol \(c\), \(T\) is an
   \(\call\)-theory, and \(\phi(\bar{v})\) is an \(\call\)-formula. The following
   are equivalent:
   1. There is a quantifier-free \(\call\)-formula \(\psi(\bar{v})\) s.t.
      \(T\vDash\forall\bar{v}(\phi(\bar{v})\leftrightarrow\psi(\bar{v}))\)
   2. If \(\calm\) and \(\caln\) are models of \(T\), \(\cala\) is an
      \(\call\)-structure, \(\cala\subseteq\calm\), and \(\cala\subseteq\caln\),
      then \(\calm\vDash\phi(\bar{a})\) if and only if \(\caln\vDash\phi(\bar{a})\)
      for all \(\bar{a}\in\cala\)
   #+END_theorem

   #+BEGIN_proof
   \((1)\to(2)\). Suppose that \(T\vDash\forall\bar{v}(\phi(\bar{v})\leftrightarrow\psi(\bar{v}))\),
   where \psi is quantifier-free. Let \(\bar{a}\in\cala\), where \(\cala\) is a
   common substructure of \(\calm\) and \(\caln\) and the latter structures are
   models of \(T\). In Proposition ref:prop1.1.8, we saw that quantifer-free
   formulas are preserved under substructure and extension. Thus
   \begin{align*}
   \calm\vDash\phi(\bar{a})&\Leftrightarrow\calm\vDash\psi(\bar{a})\\
   &\Leftrightarrow\cala\vDash\psi(\bar{a})\\
   &\Leftrightarrow\caln\vDash\psi(\bar{a})\\
   &\Leftrightarrow\caln\vDash\phi(\bar{a})
   \end{align*}

   \((2)\to(1)\). First, if \(T\vDash\forall\bar{v}\phi(\bar{v})\), then
   \(T\vDash\forall\bar{v}(\phi(\bar{v})\leftrightarrow c=c)\).Second, if
   \(T\vDash\forall\bar{v}\neg\phi(\bar{v})\), then
   \(T\vDash\forall\bar{v}(\phi(\bar{v})\leftrightarrow c\neq c)\).

   Thus, we may assume that both \(T\cup\{\phi(\bar{v})\}\) and \(T\cup\{\neg\phi(\bar{v})\}\)
   are satisfiable

   Let  \(\Gamma(\bar{v})=\{\psi(\bar{v}):\psi\text{ is quantifier free and }T\vDash\forall\bar{v}(\phi(\bar{v})\to\psi(\bar{v}))\}\).
   Let \(d_1,\dots,d_m\) be new constant symbols. We will show that \(T\cup\Gamma(\bar{d})\vDash\phi(\bar{d})\). Then, by
   compactness, there are  \(\psi_1,\dots,\psi_n\in\Gamma\) s.t. <<Problem2>>
   #+LATEX: \wu{
   Let \(p(\barv)=\{\psi(\barv)\to\phi(\barv)\mid \psi(\barv)\in\Gamma(\barv)\}\). Then \(T\vDash p(\bard)\) and we apply the compactness.
   #+LATEX: }
   \begin{equation*}
   T\vDash\forall\bar{v}\left(\displaystyle\bigwedge_{i=1}^n\psi_i(\bar{v})\to\phi(\bar{v})
   \right)
   \end{equation*}
   Thus
   \begin{equation*}
   T\vDash\forall\bar{v}\left(\displaystyle\bigwedge_{i=1}^n\psi_i(\bar{v})\leftrightarrow
   \phi(\bar{v})
   \right)
   \end{equation*}
   and \(\displaystyle\bigwedge_{i=1}^n\psi_i(\bar{v})\) is quantifier-free

   *Claim* \(T\cup\Gamma(\bar{d})\vDash\phi(\bar{d})\)

   Suppose not. Let \(\calm\vDash T\cup\Gamma(\bar{d})\cup\{\neg\phi(\bar{d})\}\). Let \(\cala\)
   be the substructure of \(\calm\) generated by \(\bar{d}\)

   Let \(\Sigma=T\cup\Diag(\cala)\cup\phi(\bar{d})\). If \Sigma is unsatisfiable, then there are
   quantifier-free formulas \(\psi_1(\bar{d}),\dots,\psi_n(\bar{d})\in\Diag(\cala)\) s.t.
   \begin{equation*}
   T\vDash\forall\bar{v}\left(
   \displaystyle\bigwedge_{i=1}^n\psi_i(\bar{v})\to\neg\phi(\bar{v})
   \right)
   \end{equation*}
   #+LATEX: \wu{
   as \(T\cup\Diag(\cala)\) is consistent. The only evildoer is \(\phi(\bard)\). Then we
   have \(T\cup\Diag(\cala)\vDash\phi(\bard)\) and again by compactness.
   #+LATEX: }
   But then
   \begin{equation*}
   T\vDash\forall\bar{v}\left(\phi(\bar{v})\to
   \displaystyle\bigvee_{i=1}^n\neg\psi_i(\bar{v})
   \right)
   \end{equation*}
   so \(\displaystyle\bigvee_{i=1}^n\neg\psi_i(\bar{v})\in\Gamma\) and
   \(\cala\vDash\displaystyle\bigvee_{i=1}^n\neg\psi_i(\bar{d})\), a
   contradiction. Thus, \Sigma is satisfiable

   Let \(\caln\vDash\Sigma\). Then \(\caln\vDash\phi(\bar{d})\). Because
   \(\Sigma\supseteq\Diag(\cala)\), \(\cala\subseteq\caln\), by Lemma ref:lemma2.3.3.
   But \(\calm\vDash\neg\phi(\bar{d})\); thus \(\caln\vDash\neg\phi(\bar{d})\), a contradiction
   #+END_proof

   if \(\call\) doesn't contain a constant symbol, there are no quantifier-free sentences, but for each
   sentence we can find a quantifier-free formula \(\psi(v_1)\) s.t. \(T\vDash\phi\leftrightarrow\psi(v_1)\)

   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   label:lemma3.1.5
   Let \(T\) be an \(\call\)-theory. Suppose that for every quantifier-free
   \(\call\)-formula \(\theta(\bar{v},w)\) there is a quantifier-free formula
   \(\psi(\bar{v})\) s.t. \(T\vDash\exists w\theta(\bar{v},w)\leftrightarrow\psi(\bar{v})\). Then \(T\)
   has quantifier elimination
   #+END_lemma

   #+BEGIN_proof
   Let \(\phi(\bar{v})\) be an \(\call\)-formula. We wish to show to show that
   \(T\vDash\forall\bar{v}(\phi(\bar{v})\leftrightarrow\psi(\bar{v}))\) for some quantifier-free
   formula \(\psi(\bar{v})\)

   If \phi is quantifier-free, there is nothing to prove. Suppose that for
   \(i=0,1\), \(T\vDash\forall\bar{v}(\theta_i(\bar{v})\leftrightarrow\psi_i(\bar{v}))\), where
   \(\psi_{i}\) is quantifier-free.

   If \(\phi(\bar{v})=\neg\theta_0(\bar{v})\), then
   \(T\vDash\forall\bar{v}(\phi(\bar{v})\leftrightarrow\neg\psi_0(\bar{v}))\)

   Suppose that \(T\vDash\forall\bar{v}(\theta(\bar{v},w)\leftrightarrow\psi_0(\bar{v},w))\), where
   \(\psi_0\) is quantifier-free and \(\phi(\bar{v})=\exists w\theta(\bar{v},w)\). Then
   \(T\vDash\forall\bar{v}(\phi(\bar{v})\leftrightarrow\exists w\psi_0(\bar{v},w))\). By our assumptions,
   there is a quantifier-free \(\psi(\bar{v})\) s.t.
   \(T\vDash\forall\bar{v}(\exists w\psi_0(\bar{v},w)\leftrightarrow\psi(\bar{v}))\). But then
   \(T\vDash\forall\bar{v}(\phi(\bar{v})\leftrightarrow\psi(\bar{v}))\)

   #+END_proof

   Combining Theorem ref:thm3.1.4 and Lemma ref:lemma3.1.5 gives us the
   following test for quantifier elimination (Restrict the form of \phi)
   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
   label:cor3.1.6
   <<Problem3>>
   Let \(T\) be an \(\call\)-theory. Suppose that for all quantifier-free
   formulas \(\phi(\bar{v},w)\), if \(\calm,\caln\vDash T\), \(\cala\) is a common
   substructure of \(\calm\) and \(\caln\), \(\bar{a}\in A\), and there is
   \(b\in M\) s.t. \(\calm\vDash\phi(\bar{a},b)\), then there is \(c\in N\) s.t.
   \(\caln\vDash\phi(\bar{a},c)\). Then $T$ has a quantifier elimination
   #+END_corollary

   #+BEGIN_proof
   Check this notes [[http://www.math.uni-konstanz.de/~eleftheriou/teaching/Masterarbeit.pdf][Quantifier Elimination Tests and Examples]]

   We need to show that \(T\vDash\forall\bar{v}(\exists w\phi(\bar{v},w)\leftrightarrow\psi(\bar{v}))\).
   Suppose that \(\calm\vDash\exists w\phi(\bar{v},w)\), then
   \(\caln\vDash\exists w\phi(\bar{v},w)\). Note that \(\calm\) and \(\caln\) are interchangeable.

   We are actually talks about \(\exists v\phi(\bara,v)\)
   #+END_proof

*** Divisible Abelian Groups
    In Proposition ref:prop2.2.4 we showed that the theory of nontrivial torsion-free divisible
    Abelian groups is \kappa-categorical for uncountable cardinals and hence complete by Vaught's test.

    Work with the language \(\call=\{+,-,0\}\) because its convenient

    Let \(\DAG\) be the \(\call\)-theory of nontrivial torsion-free divisible Abelian
    groups

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma3.1.7
    Suppose \(G\) and \(H\) are nontrivial torsion free divisible Abelian
    groups, \(G\subseteq H\), \(\psi(\bar{v},w)\) is quantifier-free,
    \(\bar{a}\in G\), \(b\in H\), and \(H\vDash\phi(\bar{a},b)\). Then there is
    \(c\in G\) s.t. \(G\vDash\phi(\bar{a},c)\)
    #+END_lemma

    #+BEGIN_proof
    We first note that \psi can be put in disjunctive normal form, namely there are atomic or negated
    atomic formulas \(\theta_{i,j}(\barv,w)\) s.t.
    \begin{equation*}
    \psi(\barv,w)\leftrightarrow\bigvee_{i=1}^n\bigwedge_{j=1}^m\theta_{i,j}(\barv,w)
    \end{equation*}

    Because \(H\vDash\psi(\bar{a},b)\),
    \(H\vDash\bigwedge_{j=1}^m\theta_{i,j}(\bar{a},b)\) for some \(i\). Thus, without
    loss of generality, we may assume that \psi is a conjunction of atomic and
    negated atomic formulas. If \(\theta(v_1,\dots,v_m,w)\) is an atomic formula,
    then for some integers \(n_1,\dots,n_m,m\), \(\theta(\bar{v},w)\) is
    \(\sum n_iv_i+mw=0\)

    Thus we may assume that
    \begin{equation*}
    \psi(\bar{a},w)=\displaystyle\bigwedge_{i=1}^s\sum_{j=1}^mn_{i,j}a_j+m_iw=0\wedge
    \bigwedge_{i=1}^s\sum_{j=1}^mn_{i,j}'a_j+m_i'w\neq0
    \end{equation*}
    Let \(g_i=\sum n_{i,j}a_j\) and \(h_i=\sum n_{i,j}'a_j'\). Then \(g_i,h_i\in G\) and
    \begin{equation*}
    \psi(\bar{a},w)\leftrightarrow\bigwedge g_i+m_iw=0\wedge\bigwedge h_i+m_i'w\neq0
    \end{equation*}

    If any \(m_i\neq0\), then \(b=-g_i/m_i\in G\) and \(G\vDash\theta(\bar{a},b)\),
    so suppose that \(\psi(\bar{a},w)=\bigwedge h_i+m_i'w\neq0\). Thus
    \(\psi(\bar{a},w)\) is satisfied by any element of \(H\) that is not equal to
    any one of \(\frac{-h_1}{m_1'},\dots,\frac{-h_s}{m_s'}\). Because \(G\) is
    infinite, there is an element  of \(G\) satisfying \(\psi(\bar{a},w)\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma3.1.8
    Suppose that \(G\) is a torsion-free Abelian group. Then there is a
    torsion-free divisible Abelian group $H$, called the *divisible hull* of
    \(G\), and an embedding \(i:G\to H\) s.t. if \(j:G\to H'\) is an embedding of
    \(G\) into a torsion-free divisible Abelian group, then there is \(h:H\to H'\) s.t.
    \(j=h\circ i\)
    #+END_lemma

    #+BEGIN_proof
    If \(G\) is the trivial group, then we take \(H=\Q\) since every torsion
    free divisible Abelian group can be viewed as a vector space over \(\Q\). So
    suppose that \(G\) is non-trivial

    Let \(X=\{(g,n):g\in G,n\in\N,n>0\}\). We think of \((g,n)\) as \(g/n\)

    We define an equivalence relation \(\sim\) on \(X\) by \((g,n)\sim(h,m)\) if and
    only if \(mg=nh\). Let \(H=X/\sim\). For \((g,n)\in X\), let \([(g,n)]\) denote
    the \(\sim\)-class of \((g,n)\). We define \(+\) on \(H\) by
    \([(g,n)]+[(h,m)]=[(mg+nh,mn)]\). We must show that \(+\) is well defined

    Suppose that \((g_0,n_0)\sim(g,n)\). We claim that
    \((mg_0+n_0h,mn_0)\sim(mg+nh,mn)\).

    Similarly we can define \(-\) by \([(g,n)]-[(h,m)]=[(mg-nh,mn)]\). It is
    easy to show that \((H,+)\) is an Abelian group

    If \([(g,m)]\in H\) and \(n>0\), then \(n[(g,m)]=[(ng,m)]\). If
    \((ng,m)\sim(0,k)\), then \(kng=0\). Because \(k,n>0\) and \(G\) is torsion
    free, \(g=0\). Then \([(g,m)]=[(0,1)]\). Thus \(H\) is torsion free.

    Suppose that \([(g,m)]\in H\) and \(n>0\), then \(n[(g,mn)]=[(g,m)]\). Thus
    \(H\) is divisible.

    We can embed \(G\) into \(H\) by the map \(i(g)=[(g,1)]\)

    Suppose that \(H'\) is a divisible torsion-free Abelian group and
    \(j:G\to H'\) is an embedding. Let \(h:H\to H'\) by \(h([g,n])=j(g)/n\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm3.1.9
    \(\DAG\) has quantifier elimination
    #+END_theorem

    #+BEGIN_proof
    Suppose that \(G_0\) and \(G_1\) are torsion-free divisible Abelian groups,
    \(G\) is a common subgroup of \(G_0\) and \(G_1\), \(\bar{g}\in G\),
    \(h\in G_0\) and \(G_0\vDash\phi(\bar{g},h)\), where \phi is quantifier-free.
    Let \(H\) be the divisible hull of \(G\). Because we can embed \(H\) into
    \(G_0\), by Lemma ref:lemma3.1.7, \(H\vDash\exists w\phi(\bar{g},w)\). Because
    we can embed \(H\) into \(G_1\), there is \(h'\in G_1\) s.t.
    \(G_1\vDash\phi(\bar{g},h')\). By Corollary ref:cor3.1.6, DAG has
    quantifier elimination
    #+END_proof

    Quantifier elimination gives us a good picture of the definable sets in
    a model of \(\DAG\). Suppose that \(\phi(v_1,\dots,v_n,w_1,\dots,w_m)\) is an atomic
    formula. Then there are integers \(k_1,\dots,k_n\) and \(l_1,\dots,l_m\) s.t.
    \(\phi(\bar{v},\bar{w})\leftrightarrow\sum k_ix_i+\sum l_iy_i=0\). If \(G\vDash\DAG\) and
    \(a_1,\dots,a_m\in G\), \(\phi(\bar{v},\bar{a})\) defines
    \(\{\bar{g}\in G^n:\sum k_ig_i+\sum l_ia_i=0\}\), a hyperplane in \(G^n\). Because
    any \(\call\)-formula \(\phi(\bar{v},\bar{w})\) is equivalent in DAG to a
    Boolean combination of atomic \(\call\)-formulas, every definable subset of
    \(G^n\) is a Boolean combination of hyperplanes

    In particular, suppose that \(\bar{a}\in G^m\) and \(\phi(v,\bar{a})\) defines a
    subset of \(G\). The "hyperplanes" in \(G\) are just single points. Thus,
    \(\{g\in G:G\vDash\phi(g,\bar{a})\}\) is either finite or cofinite. Thus
    every definable subset of \(G\) was definable already in the language of equality

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say that an \(\call\)-theory $T$ is *strongly minimalx* if for any
    \(\calm\vDash T\) every definable subset of \(M\) is either finite or cofinite
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    DAG is strongly minimal
    #+END_corollary


    If \(T\) is a theory then \(T_\forall\) is the set of all universal consequences
    of \(T\). In Exercise ref:ex2.5.10 we saw that \(\cala\vDash T_\forall\) if and
    only if there is \(\calm\vDash T\) with \(\cala\subseteq\calm\). One
    consequence of Lemma ref:lemma3.1.8 is that every torsion-free Abelian group
    is a substructure of a nontrivial divisible Abelian group. Because the
    axioms for torsion-free Abelian groups are universal, /\(\DAG_\forall\) is exactly/
    /the theory of torsion-free Abelian groups./

    We say that a theory \(T\) has *algebraically prime models* if for any
    \(\cala\vDash T_\forall\) there is \(\calm\vDash T\) and an embedding
    \(i:\cala\to\calm\) s.t. for all \(\caln\vDash T\) and embeddings
    \(j:\cala\to\caln\) there is \(h:\calm\to\caln\) s.t. \(j=h\circ i\).
    #+BEGIN_center
    \begin{tikzcd}
    \cala\vDash T_\forall\arrow[r,"i"]\arrow[rd,"j"']&\calm\vDash T\arrow[d,"h"]\\
    &\caln\vDash T
    \end{tikzcd}
    #+END_center

    If \(\calm,\caln\vDash T\) and \(\calm\subseteq\caln\), we say that
    \(\calm\) is *simply closed* in \(\caln\) and write \(\calm\prec_s\caln\) if
    for any quantifier free formula \(\phi(\bar{v},w)\) and any \(\bar{a}\in M\),
    if \(\caln\vDash\exists w\;\phi(\bar{a},w)\) then so does \(\calm\). Lemma
    ref:lemma3.1.7 says that if \(G\) and \(H\) are models of DAG and
    \(G\subseteq H\), then \(G\prec_s H\)

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor3.1.12
    Suppose that \(T\) is an \(\call\)-theory s.t.
    1. \(T\) has algebraically prime models and
    2. \(\calm\prec_s\caln\) whenever \(\calm\subseteq\caln\) are models of
       \(T\)


    Then \(T\) has quantifier elimination
    #+END_corollary



    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    An \(\call\)-theory \(T\) is *model-complete* \(\calm\prec\caln\) whenever
    \(\calm\subseteq\caln\) and \(\calm,\caln\vDash T\)
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    If \(T\) has quantifier elimination, then \(T\) is model-complete
    #+END_proposition

    #+BEGIN_proof
    Suppose that \(\calm\subseteq\caln\) are models of \(T\). Let \(\phi(\bar{v})\)
    be an \(\call\)-formula, and let \(\bar{a}\in M\). There is a quantifier-free
    formula \(\psi(\bar{v})\) s.t. \(\calm\vDash\forall\bar{v}(\phi(\bar{v}\leftrightarrow\psi(\bar{v})))\).
    Because quantifier-free formulas are preserved under substructures and
    extensions, \(\calm\vDash\psi(\bar{a})\) if and only if
    \(\caln\vDash\psi(\bar{a})\). Thus \(\calm\prec\caln\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    label:prop3.1.15
    Let \(T\) be a model-complete theory. Suppose that there is
    \(\calm_0\vDash T\) s.t. \(\calm_0\) embeds into every model of \(T\). Then
    \(T\) is complete
    #+END_proposition

    #+BEGIN_proof
    If \(\calm\vDash T\), then \(\calm_0\prec \calm\). In particular
    \(\calm_0\equiv\calm\).
    #+END_proof

    Because \((\Q,+,0)\) embeds in every model of DAG, this gives another proof
    of the completeness of DAG

*** Ordered Divisible Abelian Groups
    Let \(\call=\{+,0,<,0\}\) and let \(\ODAG\) be the theory of nontrivial divisible
    ordered Abelian groups.  The axioms for ordered Abelian groups are universal
    and hence contained in \(\ODAG_\forall\).

    We start by trying to identify \(\ODAG_\forall\). Axioms for ordered Abelian groups are universal and
    hence contained in \(\ODAG_\forall\). We claim that these axioms suffice. We must show that every
    ordered Abelian group embeds in an ordered divisible Abelian group. Because ordered groups are
    torsion-free, it suffices to show that the ordering of the group extends to an ordering of the
    divisible hull.

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma3.1.16
    Let \(G\) be an ordered Abelian group and \(H\) be the divisible hull of
    \(G\). We can order \(H\) s.t. \(i:G\to H\) is order-preserving,
    \((H,+,<)\vDash\ODAG\) and if \(H'\vDash\ODAG\) and \(j:G\to H'\) is an
    embedding, then there is an embedding \(h:H\to H'\) s.t. \(j=h\circ i\)
    #+END_lemma

    #+BEGIN_proof
    We let \(\frac{g}{n}\) denote \([(g,n)]\). We can order \(H\) by
    \(\frac{g}{n}<\frac{h}{m}\) if and only if \(mg<nh\). If \(g<h\), then
    \(\frac{g}{1}<\frac{h}{1}\) so this extends the ordering of \(G\). If
    \(\frac{g_1}{n_1}<\frac{g_2}{n_2}\) and
    \(\frac{h_1}{m_1}\le \frac{h_2}{m_2}\), then \(n_2g_1<n_1g_2\) and
    \(m_2h_1\le m_1h_2\). Then,
    \begin{equation*}
    m_1m_2n_2g_1+n_1n_2m_2h_1<m_1m_2n_1g_2+n_1n_2m_1h_2
    \end{equation*}
    and
    \begin{equation*}
    \frac{m_1g_1+n_1h_1}{m_1n_1}<\frac{m_2g_2+n_2h_2}{m_2n_2}
    \end{equation*}
    Thus, < makes \(H\) an ordered group

    If \(H'\) is another ordered disivible Abelian group and \(j:G\to H'\) is an
    embedding, let \(h\) be as in Lemma ref:lemma3.1.8
    #+END_proof

    To prove quantifier elimination, we must how that if \(G\) and \(H\) are
    ordered divisible Abelian groups and \(G\subseteq H\), then \(G\prec_s H\)

    Suppose that \(\phi(v,\bar{w})\) is a quantifier-free formula,
    \(\overbar{a}\in G\), and for some \(b\in H\), \(H\vDash\phi(b,\bar{a})\).
    As above, it suffices to consider the case where \phi is a conjunction of
    atomic and negated atomic formulas. If \(\theta(v,\overbar{w})\) is atomic,
    then \theta is equivalent to either \(\sum n_iw_i+mv=0\) or
    \(\sum n_iw_i+mv>0\) for some \(n_i,m\in\Z\). In particular, there is an
    element \(g\in G\) s.t. \(\theta(v,\overbar{a})\) is of the form \(mv=g\) or
    \(mv>g\). Also not that for any formula \(mv\neq g\) is equivalent to
    \(mv>g\) or \(-mv>g\). Thus we may assume that
    \begin{equation*}
    \phi(v,\overbar{a})\leftrightarrow\bigwedge m_iv=g_i
    \bigwedge n_iv>h_i
    \end{equation*}
    where \(g_i,h_i\in G\) and \(m_i,n_i\in\Z\)

    If there is actually a conjunct \(m_iv=g_i\), then we must have
    \(b=\frac{g_i}{m_i}\in G\); otherwise
    \(\phi(v,\overbar{a})=\bigwedge m_iv>h_i\). Let
    \(k_0=\min\{\frac{h_i}{m_i}:m_i<0\}\) and
    \(k_i=\max\{\frac{h_i}{m_i}:m_i>0\}\). Then \(c\in H\) satisfies
    \(\phi(v,\overbar{a})\) if and only if \(k_0<v<k_1\). Because \(b\)
    satisfies \phi, we must have \(k_0<k_1\). But any ordered divisible Abelian
    group is densely ordered because if \(g<h\) then \(g<\frac{g+h}{2}<h\), so
    there is \(d\in G\) s.t. \(k_0<d<k_1\). Thus \(G\prec_s H\)

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor3.1.17
    ODAG is a complete decidable theory with quantifier elimination. In
    particular, every ordered divisible Abelian group is elementarily equivalent
    to \(\Q,+,<\)
    #+END_corollary

    #+BEGIN_proof
    By Lemma ref:lemma3.1.16, \(\ODAG_\forall\) is the theory of ordered Abelian
    groups and ODAG has algebraically prime models. From Corollary ref:cor3.1.12
    we see that ODAG has quantifier elimination. The ordered group of rational
    embeds into every ordered divisible Abelian group; thus by Proposition
    ref:prop3.1.15, ODAG is complete. Because ODAG has a recursive
    axiomatization, it is decidable by Lemma ref:lemma2.2.8
    #+END_proof

    ODAG is not strongly minimal. For example, \(\{a\in\Q:a<0\}\) is infinite
    and coinfinite. On the other hand, /definable subsets are quite
    well-behaved/. Suppose that \(G\) is an ordered divisible Abelian group and
    \(X\subseteq G\) definable. By quantifier elimination, \(X\) is a Boolean
    combination of sets defined by atomic formulas. If \(\phi(v,w_1,\dots,w_n)\)
    is atomic, then there are integers \(k_0,\dots,k_n\) s.t. \phi is equivalent
    to either
    \begin{equation*}
    k_0v+\sum k_iw_i=0
    \end{equation*}
    or
    \begin{equation*}
    k_0v+\sum k_iw_i>0
    \end{equation*}
    If \(\overbar{a}\in G^n\), in the first case \(\phi(v,\overbar{a})\) defines
    a finite set whereas in the second case it defines an interval. It follows
    that \(X\) is a finite union of points and intervals with endpoints in
    \(G\cup\{\pm\infty\}\)

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say the an ordered structure \((M,<,\dots)\) is *o-minimal* if for any
    definable \(X\subseteq M\) there are finitely many intervals
    \(I_1,\dots,I_m\) with endpoints in \(M\cup\{\pm\infty\}\) and a finite set
    \(X_0\) s.t. \(X=X_0\cup I_1\cup\dots\cup I_m\)
    #+END_definition

*** Presburger Arithmetic
    Let \(\call=\{+,-,<,0,1\}\) and consider the \(\call\)-theory of the ordered
    group of integers.  In fact this theory will not have quantifer elimination
    in the language \(\call\). Let \(\psi_n(v)\) be the formula
    \begin{equation*}
    \exists y\; v=\underbrace{y+\dots+y}_{n\text{-times}}
    \end{equation*}
    It turns out that this is the only obstruction to quantifer elimination.
    Let \(\call^*=\call\cup\{P_n:n=2,3,\dots\}\) where \(P_n\) is a unary
    predicate which we will interpret as the elements divisible by \(n\). We will see that
    the \(\call^*\)-theory of \(\Z\) has quantifier elimination and is decidable. Because we are only
    adding predicates for sets that we define already in the language \(\call\), we will not change the
    definable sets (See Exercise ref:ex1.4.15)

    For any language \(\call\) and \(\call\)-theory \(T\), there is a language
    \(\call'\supseteq\call\) and an \(\call'\)-theory \(T'\supseteq T\) s.t. for
    any \(\calm\vDash T\) we can interpret the new symbols of \(\call'\) to
    make \(\calm'\vDash T'\) s.t. for any subset of \(M^k\) definable using
    \(\call'\) is already definable using \(\call\), and any \(\call'\)-formula
    is equivalent to an atomic \(\call'\)-formula

    Let \(\call'=\call\cup\{R_\phi:\phi\text{ an $\call$-formula}\}\), where if
    \phi is a formula in \(n\) free variables, \(R_\phi\) is an \(n\)-ary
    predicate symbol. Let \(T'\) be the theory obtained by adding to \(T\) the
    sentences
    \begin{equation*}
    \forall\overbar{v}(\phi(\overbar{v})\leftrightarrow R_\phi(\overbar{v}))
    \end{equation*}

    Consider the \(\call^*\)-theory, which we call \(\Pr\) for *Presburger arithmetic*, with axioms:
    1. axioms for ordered Abelian groups
    2. \(0<1\)
    3. \(\forall x(x\le0\vee x\ge1)\)
    4. \(\forall x(P_n(x)\leftrightarrow\exists y\;x=\underbrace{y+\dots+y}_{n\text{-times}})\), for \(n=2,3,\dots\)
    5. \(\forall x\bigvee_{i=0}^{n-1}[P_n(x+\underbrace{1+\dots+1}_{i\text{ times}})\wedge\bigwedge_{j\neq i}\neg P_n(x+\underbrace{1+\dots+1}_{j\text{ times}})]\)
       for \(n=2,3,\dots\)


    Suppose that \((G,+,-,<,0,1)\) is a model of Pr. For each \(n\), axiom (4)
    asserts that \(P_n^G=nG\). Axiom (5) asserts that
    \(\frac{G}{nG}\cong \frac{\Z}{n\Z}\)

    Axioms 1,2,3 and 5 are universal, whereas axiom 4 is not. Let us define a theory \(T\) that we
    will eventually show is \(\Pr_\forall\). The axioms for \(T\) are:

    axioms 1,2,3 and 5
    6. [@6] \(P_n\) is closed under + and -
    7. \(\forall x,y\;(\underbrace{y+\dots+y}_{n\text{ times}}=x)\to P_n(x)\)
    8. (for \(m\) dividing \(n\)) \(\forall x(P_m(x)\to P_n(x))\)
    9. \(\forall x(P_{kn}(\underbrace{x+\dots+x}_{k\text{ times}})\to P_n(x))\) for \(k,n=2,3,\dots\)


    6 ensures that the \(P_n\) are additive subgroups. Axiom 7 asserts that \(nG\subset P_n\). Axiom 8
    asserts that if \(m\mid n\), then \(P_n\subset P_m\). Axiom 9 asserts that if \(kx\in P_{kn}\)
    then \(x\in P_n\). Clearly \(T\subseteq\Pr_{\forall}\)

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    Let \((G,+,<,P_2,P_3,\dots)\vDash T\). There is \(H\supseteq G\) s.t. \(H\vDash\Pr\) and if \(H'\supseteq G\) and \(H'\vDash\Pr\),
    then there is \(h:H\to H'\) s.t. \(h|G\) is the identity
    #+END_lemma

    #+BEGIN_proof

    #+END_proof


** Algebraically Closed Fields
   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   [[https://math.stackexchange.com/questions/1612597/acf-universal-is-the-theory-of-integral-domains][Check]] this.

   \(\ACF_\forall\) is the theory of integral domains

   \(\ACF_\forall\) axiomatize the theory of integral domains. Actually this is what we want as we
   consider integral domains later and prove a stronger version
   #+END_lemma

   Consider a different version. Let \(\call=\{0,1,+,-,*\}\) be the language of rings and \(T\) is the
   theory of fields, then \(T_\forall\) is the theory of integral domains. For if \(R\) is an integral
   domain, then it is a subring of its field of fractions \(K\), and \(K\vDash T\) and hence \(R\vDash T_\forall\)
   by Exercise ref:ex2.5.10. So any integral domain models \(T_\forall\). Conversely, if \(S\) is a ring
   and \(S\vDash T_\forall\) then we need to check that \(S\) is an integral domain, so we need to
   check \(0\neq 1\), that \(xy=yx\) and that \(xy=0\Rightarrow x=0\vee y=0\).


   #+BEGIN_proof
   The axioms for integral domains are universal consequences of \(\ACF\). If \(D\)
   is an integral domain, then the algebraic closure of the fraction field of
   \(D\) is a model of \(\ACF\). Because every integral domain is a subring of an
   algebraically closed field, \(\ACF_\forall\) is the theory of integral
   domains by Exercise ref:ex2.5.10
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_theorem
   label:thm3.2.2
   \(\ACF\) has quantifier elimination
   #+END_theorem

   #+BEGIN_proof
   We will apply Corollary ref:cor3.1.12. If \(D\) is an integral domain, then
   the algebraic closure of the fraction field of \(D\) embeds into any
   algebraically closed field containing \(D\). Thus \(\ACF\) has algebraically prime
   models

   To prove quantifier elimination, we need only show that if \(K\) and \(F\) are
   algebraically closed fields, \(F\subseteq K\), \(\phi(x,\overbar{y})\) is
   quantifier-free, \(\overbar{a}\in F\), and \(K\vDash\phi(b,\overbar{a})\)
   for some \(b\in K\), then \(F\vDash\exists v\;\phi(v,\overbar{a})\)

   As in Lemma ref:lemma3.1.7, we may assume that \(\phi(x,\overbar{y})\) is a
   conjunction of atomic and negated atomic formulas. In the language of rings,
   atomic formulas \(\phi(v_1,\dots,v_n)\) are of the form \(p(\overbar{v})=0\),
   where \(p\in\Z[x_1,\dots,x_n]\). If \(p(X,\overbar{Y})\in\Z[X,\overbar{Y}]\),
   we can view \(p(X,\overbar{a})\) as a polynomial in \(F[X]\). Thus there are
   polynomials \(p_1,\dots,p_n,q_1,\dots,q_m\in F[X]\) s.t.
   \(\phi(v,\overbar{a})\) is equivalent to
   \begin{equation*}
   \bigwedge_{i=1}^np_i(v)=0\wedge
   \bigwedge_{i=1}^mq_i(v)\neq0
   \end{equation*}
   If any of the polynomials \(p_i\) are nonzero, then \(b\) is algebraic over
   \(F\). In this case, \(b\in F\) because \(F\) is algebraically closed. Thus
   we may assume that \(\phi(v,\overbar{a})\) is equivalent to
   \begin{equation*}
   \bigwedge_{i=1}^mq_i(v)\neq0
   \end{equation*}
   But  \(q_i(X)=0\) has only finitely many solutions for each \(i\le m\). Thus
   there are only finitely many elements of \(F\) that do not satisfy \(F\).
   Because algebraically closed fields are infinite, there is a \(c\in F\) s.t.
   \begin{equation*}
   F\vDash\phi(c,\overbar{a})
   \end{equation*}
   #+END_proof

   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
   label:cor3.2.3
   ACF is model-complete and \(\ACF_p\) is complete where \(p=0\) or \(p\) is prime
   #+END_corollary
   #+BEGIN_proof
   Suppose that \(K,L\vDash\ACF_p\). Let \phi be any sentence in the language
   of rings. By quantifer elimination, there is a quantifer-free sentence \psi
   s.t.
   \begin{equation*}
   \ACF\vDash\phi\leftrightarrow\psi
   \end{equation*}
   Because quantifer-free sentences are preserved under extension and
   substructure,
   \begin{equation*}
   K\vDash\psi\Leftrightarrow\F_p\vDash\psi\Leftrightarrow L\vDash\psi
   \end{equation*}
   Thus \(K\equiv L\) and \(\ACF_p\) is complete
   #+END_proof

*** Zariski Closed and Constructible Sets
    Let \(K\) be a field. If \(S\subseteq K[X_1,\dots,X_n]\), let
    \(V(S)=\{a\in K^n:p(a)=0\text{ for all }p\in S\}\). If \(Y\subseteq K^n\),
    we let
    \(I(Y)=\{f\in K[X_1,\dots,X_n]:f(\overbar{a})=0\text{ for all
    }\overbar{a}\in Y\}\).
    We say \(X\subseteq K^n\) is *Zariski closed* if \(X=V(S)\) for some
    \(S\subseteq K[X_1,\dots,X_n]\)

    The *radical* of an ideal \(I\) in a commutative ring \(R\)
    , denoted by \(\sqrt{I}\), is defined as
    \begin{equation*}
    \sqrt{I}=\{r\in R\mid r^n\in I\text{ for some }n\in\Z^+\}
    \end{equation*}

    \(I\) is a radical ideal iff \(I=\sqrt{I}\)

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma3.2.4
    Let \(K\) be a field
    1. If \(X\subseteq K^n\), then \(I(X)\) is a radical ideal
    2. If \(X\) is Zariski closed, then \(X=V(I(X))\)
    3. If \(X\) and \(Y\) are Zariski closed and \(X\subseteq Y\subseteq K^n\),
       then \(I(Y)\subseteq I(X)\)
    4. If \(X,Y\subseteq K^n\) are Zariski closed, then \(X\cup Y=V(I(X)\cap
       I(Y))\) and \(X\cap Y=V(I(X)+I(Y))\)
    #+END_lemma

    #+BEGIN_proof
    1. Suppose that \(p,q\in I(X)\) and \(f\in K[X_1,\dots,X_n]\). If
       \(a\in X\), then \(p(a)+q(a)=f(a)p(a)=0\). Thus \(p+q,fp\in I(X)\) and
       \(I(X)\) is an ideal. If \(f^n\in I(X)\) and \(a\in X\), then
       \(f^n(a)=0\) so \(f(a)=0\). Thus \(f\in I(X)\) and \(I(X)\) is a radical ideal
    2. If \(a\in X\) and \(p\in I(X)\), then \(p(a)=0\). Thus
       \(X\subseteq V(I(X))\). If \(a\in V(I(X))\setminus X\), then there is
       \(p\in I(X)\) s.t. \(p(a)\neq0\), a contradiction
    3. If \(p\in I(Y)\) and \(a\in X\), then \(p(a)=0\) and \(I(Y)\subseteq
       I(X)\). By (2), if \(I(X)=I(Y)\), then \(X=Y\)
    4. If \(p\in I(X)\cap I(Y)\), then \(p(a)=0\) for \(a\in X\) or \(a\in Y\).
       Thus \(X\cup Y\subseteq V(I(X)\cap I(Y))\). If \(a\not \in X\cup Y\),
       there are \(p\in I(X)\) and \(q\in I(Y)\) s.t. \(p(a)\neq0\) and
       \(q(a)\neq0\). But then \(p(a)q(a)\neq0\). Because \(pq\in I(X)\cap
       I(Y)\), \(a\not\in V(I(X)\cap I(Y))\)

       If \(a\in X\cap Y\), \(p\in I(X)\), \(q\in I(Y)\), then \(p(a)+q(a)=0\).
       Thus \(X\cap Y\subseteq V(I(X)+I(Y))\). If \(a\not\in X\), then there is
       \(p\in I(X)\subseteq I(X)+I(Y)\) s.t. \(p(a)\neq0\). Thus \(a\not\in
       V(I(X)+I(Y))\). Similarly, if \(a\not\in Y\), then \(a\not\in V(I(X)+I(Y))\)
    #+END_proof

    #+ATTR_LATEX: :options [Hilbert's Basis Theorem]
    #+BEGIN_theorem
    If \(K\) is a field, then the polynomial ring \(K[X_1,\dots,X_n]\) is a
    Noetherian ring, (i.e., there are no infinite ascending chains of ideals).
    In particular, every ideal is finitely generated
    #+END_theorem

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    1. There are no infinite descending sequences of Zariski closed sets
    2. If \(X_i\) is Zariski closed for \(i\in I\), then there is a finite
       \(I_0\subseteq I\) s.t.
       \begin{equation*}
       \bigcap_{i\in I}X_i=\bigcap_{i\in I_0}X_i
       \end{equation*}
       In particular, an arbitrary intersection of Zariski closed sets is
       Zariski closed
    #+END_corollary

** Exercises
    #+BEGIN_exercise
    label:ex3.4.3
    1. Show that the theory of \((\Z,s)\) has quantifier elimination where \(s(x)=x+1\). Show that
       this theory is strongly minimal and that \(\acl(A)\) is the set of elements "reachable" from \(A\)
    2. Show that the theory of \((\N,s)\) does not have quantifier elimination
    #+END_exercise

    #+BEGIN_proof
    [[https://math.stackexchange.com/questions/3203714/exercise-3-4-3-in-david-markers-model-theory][StackExchange]]

       Let \(T=\Th((\Z,s))\), suppose \(\fM,\fN\vDash T\), \((\Z,s)\) is a common substructure of \(\fM\)
       and \(\fN\). For any quantifier free \varphi,
       \begin{equation*}
       \varphi(\barv,w)\leftrightarrow\bigvee_{i=1}^n\bigwedge_{j=1}^m\theta_{i,j}(\barv,w)
       \end{equation*}
       where each \(\theta_{i,j}(\barv,w)\) is atomic or negated atomic formula.

       Atomic formula of \(\call=\{s\}\) is \(s^m(x)=s^n(y)\) for \(m,n\in\N\). Thus if \(\fM\vDash\varphi(\bara,b)\)
      \begin{equation*}
       \varphi(\bara,x)\leftrightarrow\bigwedge_{i}s^{m_i}(x)=s^{n_i}(a_i)\wedge\bigwedge_is^{m_i'}(x)\neq s^{n_i'}(a_i)
      \end{equation*}
       For \((\Z,s)\), \(\forall x,y(s(x)=s(y)\to x=y)\in T\).

    But this is not true in \((\N,s)\) as we can't
       establish comparison without a base element. Thus
       \begin{equation*}
       \varphi\leftrightarrow\bigwedge_is^{m_i}(x_i)=y_i\wedge\bigwedge_is^{m_i'}(x'_i)\neq y_i'
       \end{equation*}
    #+END_proof
* Realizing and Omitting Types

** Types
    Suppose that \(\calm\) is an \(\call\)-structure and \(A\subseteq M\). Let \(\call_A\) be the language obtained by
    adding to \(\call\) constant symbols for each \(a\in A\). We can naturally view \(\calm\) as
    an \(\call_A\)-structure by interpreting the new symbols in the obvious way. Let \(\Th_A(\calm)\) be the
    set of all \(\call_A\)-sentences true in \(\calm\). Note that \(\Th_A(\calm)\subseteq\Diag_{el}(\calm)\)

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \(p\) be the set of \(\call_A\)-formulas in free variables \(v_1,\dots,v_n\). We call \(p\) an
    *\(n\)-type* if \(p\cup\Th_A(\calm)\) is satisfiable. We say that \(p\) is a *complete \(n\)-type*
    if \(\phi\in p\) or \(\neg\phi\in p\) for all \(\call_A\)-formulas \phi with free variables from \(v_1,\dots,v_n\). We
    let \(S_n^{\calm}(A)\) be the set of all complete \(n\)-types.
    #+END_definition

    #+BEGIN_remark
    Wu's remark: guess here \(p\cup\Th_A(\calm)\) is satisfiable means that there is a model \(\fN\vDash\Th_A(\calm)\)
    that realizes \(p\), which is slightly different from "there is an elementary extension
    of \(\fM\) that realizes \(p\)"
    #+END_remark

    Consider \(\calm=(\Q,<)\)and \(A=\N\), let \(q(v)=\{\phi(v)\in\call_A:\calm\vDash\phi(\frac{1}{2})\}\). \(q(v)\) is a complete 1-type

    We sometimes refer to incomplete types as *partial types*

    By the compactness theorem, we could replace "satisfiable" by "finitely satisfiable"

    If \(\calm\) is any \(\call\)-structure, \(A\subset M\), and \(\bara=(a_1,\dots,a_n)\in M^n\), let
    \(\tp^{\calm}(\bara/A)=\{\phi(v_1,\dots,v_n)\in\call_A:\calm\vDash\phi(a_1,\dots,a_n)\}\). Then \(\tp^{\calm}(\bara/A)\) is a
    complete \(n\)-type. We write \(\tp^{\calm}(\bara)\) for \(\tp^{\calm}(\bara/\emptyset)\)

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    If \(p\) is an \(n\)-type over \(A\), we say that \(\bara\in M^n\) *realizes* \(p\) if \(\calm\vDash\phi(\bara)\)
    for all \(\phi\in p\). If \(p\) is not realized in \(\calm\) we say that \(\calm\) *omits* \(p\).
    #+END_definition

    \(1/2\) realizes \(q(v)\). And there are many realizations of \(q(v)\) in \(\calm\). Suppose
    that \(r\in\Q\) and \(0<r<1\). We can construct an automorphism \sigma of \(\calm\) that fixes every natural
    number but \(\sigma(1/2)=r\). Because \sigma fixes all elements of \(A\), \sigma is also
    an \(\call_A\)-automorphism. By Theorem ref:thm1.1.10
    \begin{equation*}
    \calm\vDash\phi(1/2)\Longleftrightarrow\calm\vDash\phi(r)
    \end{equation*}
    In fact, the elements of \(\Q\) that realize \(q(v)\) are exactly the rational number \(s\) s.t. \(0<s<1\)

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    label:prop4.1.3
    Let \(\calm\) be an \(\call\)-structure, \(A\subseteq M\), and \(p\) an \(n\)-type over \(A\). There is \(\caln\) an
    elementary extension of \(\calm\) s.t. \(p\) is realized in \(\caln\).
    #+END_proposition

    #+BEGIN_proof
    Let \(\Gamma=p\cup\Diag_{\el}(\calm)\). We claim that \Gamma is satisfiable

    Suppose that \Delta is a finite subset of \Gamma. W.L.O.G., \Delta is the single formula
    \begin{equation*}
    \phi(v_1,\dots,v_n,a_1,\dots,a_m)\wedge\psi(a_1,\dots,a_m,b_1,\dots,b_l)
    \end{equation*}
    where \(a_1,\dots,a_m\in A\), \(b_1,\dots,b_l\in M\setminus A\), \(\phi(\barv,\bara)\in p\) and \(\calm\vDash\psi(\bara,\barb)\).
    Let \(\caln_0\) be a model of the satisfiable set of sentences \(p\cup\Th_A(\calm)\).
    Because \(\exists\barw\psi(\bara,\barw)\in\Th_A(\calm)\),
    \begin{equation*}
    \caln_0\vDash\phi(\barv,\bara)\wedge\exists\barw\psi(\bara,\barw)
    \end{equation*}
    By interpreting \(b_1,\dots,b_l\) as witnesses to \(\exists\barw\psi(a_1,\dots,a_m,\barw)\), we make \(\caln_0\vDash\Delta\).
    Thus \Delta is satisfiable.

    By the Compactness Theorem, \Gamma is satisfiable. Let \(\caln\vDash\Gamma\). Because \(\caln\vDash\Diag_{\el}(\calm)\), the map
    that sends \(m\in M\) to the interpretation of the constant symbol \(m\) in \(\caln\) is an elementary
    embedding. Let \(c_i\in N\) be the interpretation of \(v_i\). Then \((c_1,\dots,c_n)\) is a realization
    of \(p\).
    #+END_proof

    If \(\caln\) is an elementary extension of \(\calm\), then \(\Th_A(\calm)=\Th_A(\caln)\). Thus \(S_n^{\calm}(A)=S_n^{\caln}(A)\)

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    \(p\in S_n^{\calm}(A)\) iff there is an elementary extension \(\caln\) of \(\calm\) and \(\bara\in N^n\) s.t. \(p=\tp^{\caln}(\bara/A)\)
    #+END_corollary

    #+BEGIN_proof
    If \(\bara\in N^n\), then \(\tp^{\caln}(\bara/A)\in S_n^{\caln}(A)=S_n^{\calm}(A)\).

    On the other hand if \(p\in S_n^{\calm}(A)\), then by Proposition ref:prop4.1.3 there is an elementary
    extension \(\caln\) of \(\calm\) and \(\bara\in\calm\) realizing \(p\). Because \(p\) is complete,
    if \(\phi(\barv)\in\call_A\), then exactly one of \(\phi(\barv)\) and \(\neg\phi(\barv)\) is in \(p\).
    Thus \(\phi(\barv)\in\tp^{\caln}(\bara/A)\) iff \(\phi(\barv)\in p\) and \(p=\tp^{\caln}(\bara/A)\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    label:prop4.1.5
    Suppose that \(\calm\) is an \(\call\)-structure and \(A\subseteq M\). Let \(\bara,\barb\in M^n\)
    s.t. \(\tp^{\calm}(\bara/A)=\tp^{\calm}(\barb/A)\). Then there is \(\caln\) an elementary extension of \(\calm\)
    and \sigma an automorphism of \(\caln\) fixing all elements of \(A\) s.t. \(\sigma(\bara)=\barb\).
    #+END_proposition

    [[index:partial elementary]]

    If \(\calm\) and \(\caln\) are \(\call\)-structures and \(B\subseteq M\), we say that \(f:B\to N\) is a *partial*
    *elementary map* iff
    \begin{equation*}
    \calm\vDash\phi(\barb)\Longleftrightarrow\caln\vDash\phi(f(\barb))
    \end{equation*}
    for all \(\call\)-formulas \phi and all finite sequences \(\barb\in B\)

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma4.1.6
    Let \(\calm,\caln,B\) be as above and let \(f:B\to N\) be partial elementary. If \(b\in M\), there is an
    elementary extension \(\caln_1\) of \(\caln\) and \(g:B\cup\{b\}\to \caln_1\) a partial elementary map extending \(f\).
    #+END_lemma

    #+BEGIN_proof
    Let \(\Gamma=\{\phi(v,f(a_1),\dots,f(a_n)):\calm\vDash\phi(b,a_1,\dots,a_n),a_1,\dots,a_n\in B\}\cup\Diag_{\el}(\caln)\). Note that here we
    have the range of \(f\) and therefore the range of \(\phi(f(\barb))\)

    Suppose that we find a structure \(\caln_1\) and an element \(c\in N_1\) satisfying all of the formulas
    in \Gamma, then we are done.

    Thus it suffices to show that \Gamma is satisfiable. By the Compactness Theorem it suffices to show
    that every finite subset of \Gamma is satisfiable in \(\caln\). Taking conjunctions, it is enough to show
    that if \(\calm\vDash\phi(\b,a_1,\dots,a_n)\), then \(\caln\vDash\exists v\phi(v,f(a_1),\dots,f(a_n))\) but this is clear because
    \(\calm\vDash\exists v\phi(v,a_1,\dots,a_n)\) and \(f\) is partial elementary
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor4.1.7
    If \(\calm\) and \(\caln\) are \(\call\)-structures, \(B\subseteq M\) and \(f:B\to N\) is a partial elementary map,
    then there is \(\caln'\) an elementary extension of \(\caln\) and \(g:\calm\to\caln'\) an elementary embedding
    #+END_corollary

    #+BEGIN_proof
    Let \(\kappa=\abs{M}\), and let \(\{a_\alpha:\alpha<\kappa\}\) be an enumeration of \(M\). Let \(\caln_0=\caln\), \(B_0=B\),
    and \(g_0=f\). Let \(B_\alpha=B\cup\{a_\beta:\beta<\alpha\}\). We inductively build an elementary chain \((N_\alpha:\alpha<\kappa)\)
    and \(g_\alpha:B_\alpha\to N_\alpha\) partial elementary s.t. \(g_\beta\subseteq g_\alpha\) for \(\beta<\alpha\)

    If \(\alpha=\beta+1\) and \(g_\beta:B_\beta\to N_\beta\) is partial elementary, then by Lemma ref:lemma4.1.6  we can
    find \(N_\beta\prec N_\alpha\) and \(g_\alpha:B_\alpha\to N_\alpha\)

    If \alpha is a limit ordinal, let \(N_\alpha=\bigcup_{\beta<\alpha}N_\beta\) and \(g_\alpha=\bigcup_{\beta<\alpha}g_\beta\). By Proposition
    ref:prop2.3.11 \(\caln_\alpha\) is an elementary extension of \(N_\beta\) for \(\beta<\alpha\) and \(f_\alpha\) is a partial
    elementary map.

    Let \(\caln'=\bigcup_{\alpha<\kappa}\caln_\alpha\) and \(g​=\bigcup_{\alpha<\kappa}g_\alpha\). Again by Proposition ref:prop2.3.11 \(\caln\prec\caln'\)
    and \(g\) is partial elementary. But \(\dom(g)=M\), so \(g\) is an elementary embedding of \(\calm\)
    into \(\caln'\)
    #+END_proof

    #+ATTR_LATEX: :options [Proof of \ref{prop4.1.5}]
    #+BEGIN_proof
    Let \(f:A\cup\{\alpha\}\to A\cup\{b\}\) s.t. \(f|A\) is the identity and \(f(a)=b\).
    Because \(\tp^{\calm}(a/A)=\tp^{\calm}(b/A)\), \(f\) is a partial elementary map. By Corollary
    ref:cor4.1.7 there is \(\caln_0\) an elementary extension of \(\calm\) and \(f_0:\calm\to\caln_0\) an elementary
    embedding extending \(f\).  We will build a sequence of elementary extensions
    \begin{equation*}
    \calm=\calm_0\prec\caln_0\prec\calm_1\prec\caln_1\prec\calm_2\prec\caln_2\prec\dots
    \end{equation*}
    and elementary embeddings \(f_i:\calm_i\to\caln_i\) s.t. \(f_0\subseteq f_1\subseteq f_2\dots\) and \(N_i\) is contained in the
    image of \(f_{i+1}\). Having done this, let
    \begin{equation*}
    \caln=\bigcup_{i<\omega}\caln_i=\bigcup_{i<\omega}\calm_i
    \end{equation*}
    and \(\sigma=\bigcup f_i\). By Proposition ref:prop2.3.11 \(\caln\) is an elementary extension of \(\calm\)
    and \(\sigma:\caln\to\caln\) is an elementary map s.t. \(\sigma|A\) is the identity and \(\sigma(a)=b\). By construction
    \sigma is surjective. Thus \sigma is the desired automorphism.

    Given \(f_i:\calm_i\to\caln_i\) we can view \(f_i^{-1}\) as a partial elementary map from the image of \(f_i\)
    into \(\calm_i\prec\caln_i\). By Corollary ref:cor4.1.7 we can find \(\calm_{i+1}\) an elementary extension
    of \(\caln_i\) and extend \(f_i^{-1}\) to an elementary embedding \(g_i:\caln_i\to\calm_{i+1}\)
    #+END_proof

*** Stone Spaces
    For \(\phi\) an \(\call_A\)-formula with free variables from \(v_1,\dots,v_n\), let
    \begin{equation*}
    [\phi]=\{p\in S^{\calm}(A):\phi\in p\}
    \end{equation*}
    If \(p\) is a complete type and \(\phi\vee\psi\in p\), then \(\phi\in p\) or \(\psi\in p\). Thus
    \([\phi\vee\psi]=[\phi]\cup[\psi]\)

    The *Stone topology* on \(S_n^{\calm}(A)\) is the topology by taking the sets \([\phi]\) as basic open
    sets.

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    1. \(S_n^{\calm}(A)\) is compact
    2. if \(S_n^{\calm}(A)\) is totally disconnected, that is if \(p,q\in S_n^{\calm}(A)\) and \(p\neq q\), then
       there is a clopen set \(X\) s.t. \(p\in X\) and \(q\not\in X\)
    #+END_lemma

    #+BEGIN_proof
    1. It suffices to show that every cover of \(S_n^{\calm}(A)\) by basic open sets has a finite
    subcover. Suppose not. Let \(C=\{[\phi_i(\barv)]:i\in I\}\) be a cover of \(S_n^{\calm}(A)\) by basic
    open sets with no finite subcover. Let
    \begin{equation*}
    \Gamma=\{\neg\phi_i(\barv):i\in I\}
    \end{equation*}
    We claim that \(\Gamma\cup\Th_A(\calm)\) is satisfiable. If \(I_0\) is a finite subset of \(I\), then
    because there is no finite subcover of \(C\), there is a type \(p\) s.t.
    \begin{equation*}
    p\not\in\bigcup_{i\in I_0}[\phi_i]
    \end{equation*}
    Let \(\caln\) be an elementary extension of \(\calm\) containing a realization \(\bara\) of \(p\). Then
    \begin{equation*}
    \caln\vDash\Th_A(\calm)\cup\bigwedge_{i\in I_0}\neg\phi_i(\bara)
    \end{equation*}
    Hence \Gamma is satisfiable

    Let \(\caln\) be an elementary extension of \(\calm\), and let \(\bara\in\caln\) realize \Gamma. Then
    \begin{equation*}
    \tp^{\caln}(\bara/A)\in S_n^{\calm}(A)\setminus\bigcup_{i\in I}[\phi_i(\barv)]
    \end{equation*}
    a contradiction

    2. [@2] if \(p\neq q\), there is a formula \phi s.t. \(\phi\in p\) and \(\neg\phi\in q\). Thus \([\phi]\) is a basic
       clopen set separating \(p\) and \(q\).
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma4.1.9
    1. If \(A\subseteq B\subset M\) and \(p\in S_n^{\calm}(B)\), let \(p|A\) be  the set of \(\call_A\)-formulas in \(p\).
       Then \(p|A\in S_n^{\calm}(A)\) and \(p\mapsto p|A\) is a continuous map from \(S_n^{\calm}(B)\) onto \(S_n^{\calm}(A)\)
    2. if \(f:\calm\to\caln\) is an elementary embedding and \(p\in S_n^{\calm}(A)\), let
       \begin{equation*}
       f(p)=\{\phi(\barv,f(\bara)):\phi(\barv,\bara)\in p\}
       \end{equation*}
       Then \(f(p)\in S_n^{\caln}(f(A))\) and \(p\mapsto f(p)\) is continuous
    3. if \(f:A\to\caln\) is partial elementary, then \(S_n^{\calm}(A)\) is homeomorphic to \(S_n^{\caln}(f(A))\)
    #+END_lemma

    #+BEGIN_proof
    1. Because \(p|A\cup\Th_A(\calm)\subseteq p\cup\Th_B(\calm)\), \(p|A\cup\Th_A(\calm)\) is satisfiable.  Because \(p|A\) is
       the set of all \(\call_A\)-formulas in \(p\), \(p|A\) is complete. If \phi is an \(\call_A\)-formula,
       then
       \begin{equation*}
       \{p\in S_n^{\calm}(B):\phi\in p\}=[\phi]
       \end{equation*}
       Thus the map is continuous. Here we consider the basic open sets.

       if \(q\in S_n^{\calm}(A)\), there is an elementary extension \(\caln\) of \(\calm\) and \(\bara\in N\)
       realizing \(q\). Then \(p=\tp^{\caln}(\bara/B)\in S_n^{\calm}(B)\) and \(p|A=q\). Thus the restriction
       map is surjective

    2. Suppose \Delta is a finite subset of \(f(p)\). Say
       \begin{equation*}
       \Delta=\{\phi_1(\barv,f(\bara),\dots,\phi_m(\barv,f(\bara)))\}
       \end{equation*}
       where \(\phi_1(\barv,\bara),\dots,\phi_m(\barv,\bara)\in p\). Because \(p\cup\Th_A(\calm)\) is satisfiable,
       \begin{equation*}
       \calm\vDash\exists\barv\bigwedge_{i=1}^m\phi_i(\barv,\bara)
       \end{equation*}
       Because \(f\) is elementary
       \begin{equation*}
       \caln\vDash\exists\barv\bigwedge_{i=1}^m\phi_i(\barv,\bara)
       \end{equation*}
       and \(f(p)\cup\Th_{f(A)}(\caln)\) is satisfiable. \(f(p)\) is complete since \(\fM\equiv\fN\).

       Because
       \begin{equation*}
       \{p\in S_n^{\calm}(A):\phi(\barv,f(\bara))\in f(p)\}=[\phi(\barv,\bara)]
       \end{equation*}
       \(p\mapsto f(p)\) is continuous

    3. since we map onto \(f(A)\).
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say that \(p\in S_n^{\calm}(A)\) is *isolated* if \(\{p\}\) is an open subset of \(S_n^{\calm}(A)\)
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    Let \(p\in S_n^{\calm}(A)\). The following are equivalent
    1. \(p\) is isolated
    2. \(\{p\}=[\phi(\barv)]\) for some \(\call_A\)-formula \(\phi(\barv)\). We say that \(\phi(\barv)\) isolates \(p\)
    3. There is an \(\call_A\)-formula \(\phi(\barv)\in p\) s.t. for
       all \(\call_A\)-formulas \(\psi(\barv)\), \(\psi(\barv)\in p\) iff
       \begin{equation*}
       \Th_A(\calm)\vDash\phi(\barv)\to\psi(\barv)
       \end{equation*}
    #+END_proposition

    #+BEGIN_proof
    \(1\to 2\). If \(X\) is open, then
    \begin{equation*}
       X=\bigcup_{i\in I}[\phi_i]
    \end{equation*}
    for some collection of formulas \(\{\phi_i:i\in I\}\). If \(\{p\}\) is open, then \(\{p\}=[\phi]\) for some
    formula \phi

    \(2\to 3\).
    #+END_proof

*** Examples
    *Dense Linear Order*.

    Let \(\call=\{<\}\). Let \(\calm=(M,<)\) be a dense linear order without endpoints and let \(A\subseteq M\).
    Let \(p\in S_1^{\calm}(A)\). If \(a\in A\), then because \(p\) is a complete type, exactly one of the
    formulas \(v=a\), \(v<a\), or \(v>a\) is in \(p\).

    _case 1_: \(p\) is realized in \(A\)

    \(v=a\in p\) for some \(a\in A\). In this case, \(p=\{\psi(v):\calm\vDash\psi(a)\}\) and \(p\) is isolated by the
    formula \(v=a\).

    _case 2_: Otherwise

    Let \(L_p=\{a\in A:a<v\in p\}\) and \(U_p=\{a\in A:v<a\in p\}\). If \(a<v,v<b\in p\), because \(p\cup\Th_A(\calm)\)
    is satisfiable, \(a<b\). Thus, \(a<b\) for \(a\in L_p\) and \(b\in U_p\) and \(L_p\) and \(U_p\)
    determine a cut in the ordering \((A,<)\)

    Also note that if \(A\) is the disjoint union of \(L\) and \(U\) where \(a<b\) for \(a\in L\)
    and \(b\in U\), then \(\Th_A(\calm)\cup\{a<v:a\in L\}\cup\{v<b:b\in U\}\) is satisfiable. Thus, there is a
    type \(p\) with \(L_p=L\) and \(U_p=U\).

    We claim that the cut completely determines \(p\); that is,
    \begin{equation*}
    \{p\}=\bigcap_{a\in L_p}[a<v]\cap\bigcap_{a\in U_p}[v<b]
    \end{equation*}
    Suppose that \(q\neq p\), \(L_p=L_q\) and \(U_p=U_q\). Because the only atomic formulas are \(u=v\)
    and \(u<v\), \(p\) and \(q\) determine the same cut in \(A\), and they contain the same atomic
    formulas. Because quantifier-free formulas are Boolean combinations of atomic formulas, \(p\)
    and \(q\) contain the same quantifier-free formulas. Because every formula is equivalent to a
    quantifier-free formula, \(p=q\)

    Using the identification between types and cuts, we can give a complete description of all types
    in \(S_1^{\Q}(\Q)\)

    For \(a\in\Q\), let \(p_a\) be the unique type containing \(v=a\).

    Let \(p_{+\infty}\) be the unique type \(p\) with \(L_p=\infty\) and \(U_p=\emptyset\), and let \(p_{-\infty}\) be the
    unique type \(p\) with \(L_p=\emptyset\) and \(U_p=\Q\). For \(r\in\R\setminus\Q\), let \(p_r\) be the unique
    type \(p\) with \(L_p=\{a\in\Q:a<r\}\) and \(U_p=\{b\in\Q:r<b\}\). For \(c\in\Q\), let \(p_{c^+}\) be the
    unique type \(p\) with \(L_p=\{a\in\Q:a\le c\}\) and \(U_p=\{b\in\Q:c<b\}\) and \(p_{c^-}\) be the unique
    type \(p\) with \(L_p=\{a\in\Q:a<c\}\) and \(U_p=\{b\in\Q:c\le b\}\). These are all possible types. Note in
    particular that \(\abs{S_1^{\Q}(\Q)}=2^{\aleph_0}\)

    We return to the general case where \(\calm\vDash\DLO\) and \(A\subseteq M\) is nonempty. Aside from the types
    realized by elements of \(A\), what types in \(S_1^{\calm}\) are isolated? Suppose that \(L_p\) has a
    largest element \(a\) and \(U_p\) has a smallest element \(b\). Then \(p\in[a<v<b]\).
    Moreover, \(\Th_A(\calm)\vDash a<v<b\to c<v<d\) for all \(c\in L_p\) and \(d\in U_p\). Thus \(a<v<b\)
    isolates \(p\). Similarly, if \(U_p=\emptyset\) and \(L_p\) has a greatest element \(a\), then \(a<v\)
    isolates \(p\), and if \(U_p\) has a smallest element \(b\) and \(L_p=\emptyset\), then \(v<b\)
    isolates \(p\).

    We claim that these are the only possibilities. For example, suppose that \(U_p\neq\emptyset\) and has no
    least element. Suppose that \(\phi(v)\) isolates \(p\). Because \(U_p\) and \(L_p\)
    determine \(p\),
    \begin{equation*}
    \Th_A(\calm)\cup\{a<v:a\in L_p\}\cup\{v<b:v\in U_p\}\vDash\phi(v)
    \end{equation*}
    Thus we can find \(a\in L_p\cup\{-\infty\}\) and \(b\in U_p\) s.t.
    \begin{equation*}
    \Th_A(\calm)\vDash\{a<v<b\}\to\phi(v)
    \end{equation*}
    There is \(c\in U_p\) s.t. \(c<b\). Because \(a<c<b\), \(\calm\vDash\phi(c)\). But then the type
    containing \(v=c\) is in \([\phi(v)]\) contradicting the fact that \([\phi(v)]\) isolates \(p\).

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    Let \(\calm\vDash\DLO\) and let \(A\subseteq M\) be nonempty. Types in \(S_1^{\calm}(A)\) not realized by elements
    of \(A\) correspond to cuts in the ordering of \(A\). A nonrealized type \(p\) is nonisolated if
    either \(U_p\neq\emptyset\) has no least element or \(L_p\neq\emptyset\) has no greatest element
    #+END_proposition

    *Algebraically Closed Fields*.

    Let \(K\vDash\ACF\), and let \(A\subseteq K\). We first argue that, W.L.O.G., we may assume that \(A\) is a
    field. Let \(k\) be a subfield of \(K\) generated by \(A\). If \(p\in S_n^K(k)\),
    then \(p|A\in S_n^K(A)\). We claim that the restriction map is a bijection.

    By Lemma ref:lemma4.1.9, we know it is surjective. Suppose that \(q\in S_n^K(A)\).
    For \(b_1,\dots,b_l\in k\), there are \(a_1,\dots,a_m\in A\) s.t. for each \(i\) there
    is \(q_i(\barX)\in\Z[X_1,\dots,X_l,\barY]\) s.t. \(b_i=q_i(\bara)\).

** Omitting Types and Prime Models
    For \(T\) an \(\call\)-theory, we let \(S_n(T)\) be the set of all complete \(n\)-types \(p\)
    s.t. \(p\cup T\) is satisfiable. If \(T\) is complete and \(\calm\vDash T\), then \(S_n(T)=S_n^{\calm}(\emptyset)\)
    since \(\calm\vDash\phi\) iff \(T\vDash\phi\). Also, \(S_n^{\calm}(A)=S_n(\Th_A(\calm))\)

    In particular, \(S_n(T)\) is a totally disconnected compact
    topological space with basic open sets
    \begin{equation*}
    [\phi]=\{p:\phi\in p\}
    \end{equation*}
    For \(p\) a complete type, \(p\) is isolated in \(S_n(T)\) iff \(\{p\}=[\phi]\) for some \phi

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \(\phi(v_1,\dots,v_n)\) be an \(\call\)-formula s.t. \(T\cup\{\phi(\barv)\}\) is satisfiable, and let \(p\) be
    an \(n\)-type. We say that \phi *isolates* \(p\) if
    \begin{equation*}
    T\vDash\forall\barv(\phi(\barv)\to\psi(\barv))
    \end{equation*}
    for all \(\psi\in p\).
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    If \(\phi(\barv)\) isolates \(p\), then \(p\) is realized in any model of \(T\cup\{\exists\barv\;\phi(\barv)\}\).
    In particular, if \(T\) is complete, then every isolated type is realized.
    #+END_proposition

    #+ATTR_LATEX: :options [Omitting Types Theorems]
    #+BEGIN_theorem
    Let \(\call\)  be countable language, \(T\) an \(\call\)-theory, and \(p\) a (possibly incomplete)
    nonisolated \(n\)-types over \(\emptyset\). Then there is a countable \(\calm\vDash T\) omitting \(p\).
    #+END_theorem

    #+BEGIN_proof
    Let \(C=\{c_0,c_1,\dots\}\) be countably many new constant symbols, and let \(\call^*=\call\cup C\). As in the
    proof of the Compactness Theorem, we will build \(T^*\supseteq T\), a complete \(\call^*\)-theory with the
    witness property and build \(\calm\vDash T^*\) as in Lemma ref:lemma2.1.7. We will arrange the
    construction s.t. for all \(d_1,\dots,d_n\in C\), there is a formula \(\phi(\barv)\in p\)
    s.t. \(T^*\vDash\neg\phi(d_1,\dots,d_n)\). This will ensure that \(d_1^{\calm},\dots,d_n^{\calm}\) does not realize \(p\).
    Because every element of \(M\) is the interpretation of a constant symbol in \(C\), \(\calm\)
    omits \(p\).

    We will construct a sequence \(\theta_0,\theta_1,\theta_2,\dots\) of \(\call^*\)-sentences s.t.
    \begin{equation*}
    \vDash\theta_t\to\theta_s
    \end{equation*}
    for \(t>s\) and \(T^*=T\cup\{\theta_i:i=0,1,\dots\}\) is a satisfiable extension of \(T\)

    Let \(\phi_0,\phi_1,\phi_2,\dots\) list all \(\call^*\)-sentences. To ensure that \(T^*\) is complete, we will
    either have
    \begin{equation*}
    \vDash\theta_{3i+1}\to\phi_i
    \end{equation*}
    or
    \begin{equation*}
    \vDash\theta_{3i+1}\to\neg\phi_i
    \end{equation*}
    If \(\phi_i\) is \(\exists v\;\psi(v)\) and \(\vDash\theta_{3i+1}\to\phi_i\), then
    \begin{equation*}
    \vDash\theta_{3i+2}\to\psi(c)
    \end{equation*}
    for some \(c\in C\). This will ensure that \(T^*\) has the witness property.
    Let \(\bard_0,\bard_1,\dots\) list all \(n\)-tuples from \(C\). We will choose \(\theta_{3i+3}\) to ensure
    that \(\bard_i^{\calm}\) does not realize \(p\) in the canonical model of \(T^*\)

    _stage 0_: Let \(\theta_0\) be \(\forall x\;x=x\)

    Suppose that we have constructed \(\theta_s\) s.t. \(T\cup\theta_s\) is satisfiable. There are three cases to
    consider

    _stage \(s+1=3i+1\)_: (Completeness) If \(T\cup\{\theta_s,\phi_i\}\) is satisfiable then \(\theta_{s+1}\)
    is \(\theta_s\wedge\phi_i\); otherwise \(\theta_{s+1}\) is \(\theta_s\wedge\neg\phi_i\). In either case \(T\cup\theta_{s+1}\) is
    satisfiable. Note that if \(\theta_s\wedge\phi_i\) is the case, then \(\neg(\theta_s\wedge\neg\phi_i)\equiv\theta_s\to\phi_i\)

    _stage \(s+1=3i+2\)_: (witness property) Suppose that \(\phi_i\) is \(\exists v\;\psi(v)\) for some formula \psi
    and \(T\vDash\theta_s\to\phi_i\). In this case we want to find a witness for \psi. Let \(c\in C\) be a constant that
    does not occur in \(T\cup\{\theta_s\}\). Because only finitely many constants from \(C\) have been used so
    far, we can always find such a \(c\). Let \(\theta_{s+1}=\theta_s\wedge\psi(c)\). If \(\caln\vDash T\cup\{\theta_s\}\), then there
    is \(a\in N\) s.t. \(\caln\vDash\psi(a)\). By letting \(c^{\caln}=a\), we have \(\caln\vDash\theta_{s+1}\). Thus in this
    case \(T\cup\{\theta_{s+1}\}\) is satisfiable.

    If \(\phi_i\) is not of the correct form or \(T\not\vDash\theta_s\to\phi_i\), then let \(\theta_{s+1}\) be \(\theta_s\)

    _stage \(s+1=3i+3\)_: (omitting \(p\)) Let \(\bard_i=(e_1,\dots,e_n)\). let \(\psi(v_1,\dots,v_n)\) be the
    \(\call\)-formula obtained from \(\theta_s\) by replacing each occurrence of \(e_i\) by \(v_i\) and then
    replacing every other constant symbol \(c\in C\setminus\{e_0,\dots,e_n\}\) occuring in \(\theta_s\) by the
    variable \(v_c\) and putting a \(\exists v_c\) quantifier in front. In particular, we get rid of all
    of the constants in \(\theta_s\) from \(C\) either by replacing them by variables or by quantifying
    over them. For example, if \(\theta_s\) is
    \begin{equation*}
    \forall x\exists ycx+e_1e_2=y^2+de_2
    \end{equation*}
    where \(c,d,e_1,e_2\) are distinct constants in \(C\), then \(\psi(v_1,v_2)\) would be
    \begin{equation*}
    \exists v_c\exists v_d\forall x\exists y\;v_cx+v_1v_2=y^2+de_2
    \end{equation*}
    Because \(p\) is nonisolated, there is a formula \(\phi(\barv)\in p\) s.t.
    \begin{equation*}
    T\not\vDash\forall\barv(\psi(\barv)\to\phi(\barv))\tag{\star}
    \end{equation*}
    Let \(\theta_{s+1}\) be \(\theta_s\wedge\neg\phi(\bard_i)\). We must argue that \(T\cup\theta_{s+1}\) is satisfiable. By
    (\(\star\)) there is \(\caln\vDash T\) with \(\bara\in N\) s.t.
    \begin{equation*}
    \caln\vDash\psi(\bara)\wedge\neg\phi(\bara)
    \end{equation*}
    We can make \(\caln\) into a model of \(\theta_{s+1}\) by interpreting the constants \(c\in C\setminus\{e_1,\dots,e_n\}\)
    as the witnesses to \(v_c\) and \(e_i\) as \(a_i\)

    This completes the construction. Let \(T^*=T\cup\{\theta_0,\theta_1,\dots\}\). Because \(T\cup\{\theta_s\}\) is satisfiable
    for each \(s\), \(T^*\) is satisfiable. If \phi is any \(\call\)-sentence, then \(\phi=\phi_i\) for
    some \(i\), and at stage \(3i+1\) we ensure that \(T^*\vDash\phi\) or \(T^*\vDash\neg\phi\). Thus, \(T^*\) is
    complete

    Also, \(T^*\) has the witness property.

    If \(\calm\) is the canonical model of \(T^*\) constructed as in Lemma ref:lemma2.1.7 we claim
    that \(\calm\) omits \(p\).
    #+END_proof

    The proof can be generalized to omit countably many types at once

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.2.4
    Let \(\call\) be a countable language, and let \(T\) be an \(\call\)-theory. Let \(X\) be a countable
    collection of nonisolated types over \(\emptyset\). There is a countable \(\calm\vDash T\) that omits all of the
    types \(p\in X\)
    #+END_theorem

    The assumption of countability of \(\call\) is necessary in the Omitting Types Theorem. Suppose
    that \(\call\) is the language with two disjoint sets of constant symbols \(C\) and \(D\),
    where \(C\) is uncountable and \(\abs{D}=\aleph_0\). Let \(T\) be the theory \(\{a\neq b:a,b\in C\}\)
    and \(p\) be the type \(\{v\neq d:d\in D\}\). Because every model of \(T\) is uncountable, there is
    always an element that is not the interpretation of a constant in \(D\). Thus, every model
    of \(T\) realizes \(p\).
    On the other hand, if \(\phi(v)\) is any \(\call\)-formula, then, because only
    countably many constants from \(D\) occur in \(T\cup\{\phi(v)\}\), there is \(d\in D\) s.t. \(T\cup\{\phi(d)\}\)
    is satisfiable. Thus, \(p\) is nonisolated <<Problem5>>

    Let \(\call=\{+,\cdot,<,0,1\}\) and let PA be the axioms for Peano arithmetic \(\PA\). Suppose
    that \(\calm,\caln\vDash\PA\). We say that \(\caln\) is an *end extension* of \(\calm\) if \(N\supset M\) and \(a<b\) for
    all \(a\in M\) and \(b\in N\setminus M\)

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    If \(\calm\) is a countable model of \(\PA\), then there is \(\calm\prec\caln\) s.t. \(\caln\) is a proper end
    extension of \(\calm\)
    #+END_theorem

    #+BEGIN_proof
    Consider the language \(\call^*\) where we have constant symbols for all elements of \(M\) and a new
    constant symbol \(c\). Let \(T=\Diag_{\el}(\calm)\cup\{c>m:m\in M\}\) and for \(a\in M\setminus\N\) let \(p_a\) be the
    type \(\{v<a,v\neq m:m\in M\}\). if \(\caln\) omits each \(p_a\), then \(\caln\) is an end extension of \(\calm\).
    By Theorem ref:thm4.2.4, it suffices to show that each \(p_a\) is nonisolated

    Suppose that \(\phi(v)\) is an \(\call^*\) formula isolating \(p_a\). Let \(\phi(v)=\theta(v,c)\), where \theta is
    an \(\call_M\)-formula. Then
    \begin{equation*}
    T\cup\theta(v,c)\vDash v<a
    \end{equation*}
    Because \(T\cup\{\theta(v,c)\}\) is satisfiable (definition),
    \begin{equation*}
    \calm\vDash\forall x\exists y>x\exists v<a\;\theta(v,y)
    \end{equation*}
    The Pigeonhole Principle is provable in Peano arithmetic. Thus
    \begin{equation*}
    \calm\vDash[\forall x\exists y>x\exists v<a\theta(v,y)]\to\exists v<a\forall x\exists y>x\theta(v,y)\tag{\star}
    \end{equation*}
    Thus there is \(m<a\) s.t.
    \begin{equation*}
    \calm\vDash\forall x\exists y>x\theta(m,y)
    \end{equation*}
    We claim that \(T\cup\{\theta(m,c)\}\) is satisfiable. If not, there is \(n\in M\) s.t.
    \begin{equation*}
    \Diag_{\el}(\calm)+c>n\vDash\neg\theta(m,c)
    \end{equation*}
    contradicting (\(\star\)). Thus \(\phi(v)\) does not isolate \(p_a\), a contradiction
    #+END_proof


*** Prime and Atomic Models
    We use the Omitting Types Theorem to study small models of a complete theory. For the remainder
    of this section, we will assume that \(\call\) is a countable language and \(T\) is a
    complete \(\call\)-theory with infinite models

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say that \(\calm\vDash T\) is a *prime model* of \(T\) if whenever \(\caln\vDash T\) there is an elementary
    embedding of \(\calm\) into \(\caln\)
    #+END_definition

    Let \(T=\ACF_0\). If \(K\vDash\ACF_0\) and \(F\) is the algebraic closure of \(\Q\), then there is an
    embedding of \(F\) into \(K\). Because \(\ACF_0\) is model complete this embedding is
    elementary. Thus \(F\) is a prime model of \(\ACF_0\)

    Consider \(\call=\{+,\cdot,<,0,1\}\) and let \(T\) be \(\Th(\N)\). If \(\calm\vDash T\), then we can view \(\N\) as
    an initial segment of \(\calm\). We claim that this embedding is elementary. We use the
    Tarski-Vaught test (Proposition ref:prop2.3.5). Let \(\phi(v,w_1,\dots,w_m)\) be an \(\call\)-formula and
    let \(n_1,\dots,n_m\in\N\) s.t. \(\calm\vDash\exists v\;\phi(v,\barn)\). Let \psi be the \(\call\)-sentence
    \begin{equation*}
    \exists v\;\phi(v,\underbrace{1+\dots+1}_{n_1\text{-times}},\dots,\underbrace{1+\dots+1}_{n_m\text{-times}})
    \end{equation*}
    Then \(\calm\vDash\psi\) and \(\N\vDash\psi\) because \(\calm\equiv\N\). But then, for some \(s\in\N\)
\begin{equation*}
    \N\vDash\phi(s,\underbrace{1+\dots+1}_{n_1\text{-times}},\dots,\underbrace{1+\dots+1}_{n_m\text{-times}})
    \end{equation*}
    and
\begin{equation*}
    \N\vDash\phi(\underbrace{1+\dots+1}_{s\text{-times}},\underbrace{1+\dots+1}_{n_1\text{-times}},\dots,\underbrace{1+\dots+1}_{n_m\text{-times}})
    \end{equation*}
    Because the latter statement is an \(\call\)-sentence,
\begin{equation*}
    \calm\vDash\phi(\underbrace{1+\dots+1}_{s\text{-times}},\underbrace{1+\dots+1}_{n_1\text{-times}},\dots,\underbrace{1+\dots+1}_{n_m\text{-times}})
    \end{equation*}
    and \(\calm\vDash\phi(s,n_1,\dots,n_m)\). By the Tarski-Vaught test, \(\caln\prec\calm\). Thus \(\N\) is a prime model
    of \(T\)

    Suppose \(\calm\) is a prime model of \(T\). Suppose that \(j:\calm\to\caln\) is an elementary embedding.
    If \(\bara\in M^n\) realizes \(p\in S_n(T)\), then so does \(j(\bara)\) (definition).
    If \(p\in S_n(T)\) is nonisolated, there is \(\caln\) s.t. \(\caln\) omits \(p\). If \(\calm\) realizes \(p\),
    then we can elementarily embed \(\calm\) into \(\caln\); thus \(\calm\) must also omit \(p\). In particular,
    if \(\bara\in M^n\), then \(\tp^{\calm}(\bara)\) must be isolated. This leads us to the following
    definition

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    \(\calm\vDash T\) is *atomic* if \(\tp^{\calm}(\bara)\) is isolated for all \(\bara\in M^n\)
    #+END_definition

    Prime models are atomic

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.2.8
    Let \(\call\) be a countable language and let \(T\) be a complete \(\call\)-theory with infinite models.
    Then \(\calm\vDash T\) is prime iff it is countable and atomic
    #+END_theorem

    #+BEGIN_proof
    \(\Rightarrow\). Because \(\call\) is countable, \(T\) has a countable model. Thus, the prime model must be
    countable

    \(\Leftarrow\). Let \(\calm\) be countable and atomic. Let \(\caln\vDash T\). We must construct an elementary
    embedding of \(\calm\) into \(\caln\). Let \(m_0,m_1,\dots,m_n,\dots\) be an enumeration of \(M\). For
    each \(i\), let \(\theta_i(v_0,\dots,v_i)\) isolate the type of \((m_0,\dots,m_i)\). We will
    build \(f_0\subseteq f_1\subseteq\dots\) a sequence of partial elementary maps from \(\calm\) into \(\caln\) where the domain
    of \(f_i\) is \(\{m_0,\dots,m_{i-1}\}\). Then \(f=\bigcup_{i=0}^\infty f_i\)  is an elementary embedding of \(\calm\)
    into \(\caln\)

    Let \(f_0=\emptyset\). Because \(\calm\equiv\caln\), \(f_0\) is partial elementary

    Given \(f_s\), let \(n_i=f(m_i)\) for \(i<s\). Because \(\theta_s(m_0,\dots,m_s)\) and \(f_s\) is partial
    elementary
    \begin{equation*}
    \caln\vDash\exists v\theta_s(n_0,\dots,n_{s-1},v)
    \end{equation*}
    Let \(n_s\in N\) s.t. \(\caln\vDash\theta_s(n_0,\dots,n_s)\). Because \(\theta_s\) isolates \(\tp^{\calm}(m_0,\dots,m_s)\)
    \begin{equation*}
    \tp^{\calm}(m_0,\dots,m_s)=\tp^{\caln}(n_0,\dots,n_s)
    \end{equation*}
    Thus \(f_{s+1}=f_s\cup\{(m_s,n_s)\}\) is a partial elementary map
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma4.2.9
    Suppose that \((\bara,\barb)\in M^{m+n}\) realizes an isolated type in \(S_{m+n}(T)\).
    Then \(\bara\) realizes an isolated type in \(S_m(T)\). Indeed if \(A\subseteq M\)
    and \((\bara,\barb)\in M^{m+n}\) realizes an isolated type in \(S_{m+n}^{\calm}(A)\),
    then \(\tp^{\calm}(\bara/A)\) is isolated
    #+END_lemma

    #+BEGIN_proof
    Let \(\phi(\barv,\barw)\) isolate \(\tp^{\calm}(\bara,\barb/A)\). We claim
    that \(\exists\barw\;\phi(\barv,\barw)\) isolates \(\tp^{\calm}(\bara/A)\). Let \(\psi(\barv)\) be
    any \(\call_A\)-formula s.t. \(\calm\vDash\psi(\bara)\). We must show that
    \begin{equation*}
    \Th_A(\calm)\vDash\forall\barv(\exists\barw\phi(\barv,\barw)\to\psi(\barv))
    \end{equation*}
    Suppose no, then there is \(\barc\in M^m\) s.t.
    \begin{equation*}
    \calm\vDash\exists\barw\phi(\barc,\barw)\wedge\neg\psi(\barc)
    \end{equation*}
    Let \(\bard\in M^n\) s.t. \(\calm\vDash\phi(\barc,\bard)\wedge\neg\psi(\barc)\). Because \(\phi(\barv,\barw)\)
    isolates \(\tp^{\calm}(\bara,\bard/A)\)
    \begin{equation*}
    \Th_A(\calm)\vDash\forall\barv\forall\barw(\phi(\barv,\barw)\to\psi(\barv))
    \end{equation*}
    This is a contradiction because
    \begin{equation*}
    \psi(\barv)\in\tp^{\calm}(\bara/A)\subset\tp^{\calm}(\bara,\barb/A)
    \end{equation*}
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    The isolated types are *dense* in \(T\) if every consistent \(L\)-formula \(\psi(x_1,\dots,x_n)\) belongs
    to an isolated type \(p(x_1,\dots,x_n)\in S_n(T)\)
    #+END_definition


    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.2.10
    Let \(\call\) be a countable language and let \(T\) be a complete \(\call\)-theory with infinite models.
    Then, the following are equivalent
    1. \(T\) has a prime model
    2. \(T\) has an atomic model \(\calm\)
    3. the isolated types in \(S_n(T)\) are dense for all \(n\) (in the sense of topology)
    #+END_theorem

    #+BEGIN_proof
    \(2\to 3\). Let \(\phi(\barv)\) be an \(\call\)-formula s.t. \([\phi(\barv)]\) is a nonempty open set
    in \(S_n(T)\). We must show that \([\phi(\barv)]\) contains an isolated type

    Let \(\calm\vDash T\) be atomic. Because \(T\) is complete and \(T\cup\{\phi(\barv)\}\) is
    satisfiable, \(T\vDash\exists\barv\phi(\barv)\). Thus there is \(\bara\in M^n\) s.t. \(\calm\vDash\phi(\bara)\).
    Then \(\tp^{\calm}(\bara)\in[\phi]\) and because \(\calm\) is atomic, \(\tp^{\calm}(\bara)\) is isolated.

    \(3\to 2\). (From tent) A structure \(\fM_0\) is atomic iff for all \(n\) the set
    \begin{equation*}
    \Sigma_n(x_1,\dots,x_n)=\{\neg\varphi(x_1,\dots,x_n)\mid\varphi(x_1,\dots,x_n)\text{ complete}\}
    \end{equation*}
    is not realised in \(\fM_0\). By Theorem ref:thm4.2.4 it is enough to show that
    the \(\Sigma_n(x_1,\dots,x_n)\)  are not isolated in \(T\). This is the case iff for every
    consistent \(\psi(x_1,\dots,x_n)\) there is a complete formula \(\varphi(x_1,\dots,x_n)\)
    with \(T\not\vDash\forall\barx(\psi(\barx)\to\neg\varphi(\barx))\). We conclude that \(\Sigma_n\) is not isolated iff the
    isolated \(n\)-types are dense
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.2.11
    Suppose that \(T\) is a complete theory in a countable language and \(A\subseteq M\vDash T\) is countable.
    If \(\abs{S_n^{\calm}(A)}<2^{\aleph_0}\), then
    1. the isolated types in \(S_n^{\calm}(A)\) are dense
    2. \(\abs{S_n^{\calm}(A)}\le\aleph_0\)


    In particular, if \(\abs{S_n(T)}<2^{\aleph_0}\), then \(T\) has a prime model
    #+END_theorem

    #+BEGIN_proof
    1. We first prove that the isolated types are dense. Suppose that there is a formula \phi
        s.t. \([\phi]\) contains no isolated types. Because \phi does not isolate a type, we can find \psi
        s.t. \([\phi\wedge\psi]\neq\emptyset\) and \([\phi\wedge\neg\psi]\neq\emptyset\).
        #+LATEX: \wu{
        If we can't, then for all \(\psi\), \([\phi\wedge\psi]=\emptyset\) or \([\phi\wedge\neg\psi]=\emptyset\). Thus \(\vDash\neg(\phi\wedge\psi)\)
       or \(\vDash\neg(\phi\wedge\neg\psi)\). Therefore either \(\vDash\phi\to\psi\) or \(\vDash\phi\to\neg\psi\) and \(\phi\) is complete.
        #+LATEX: }
        Because \([\phi]\) does not contain an isolated type, neither
       does \([\phi\wedge\pm\psi]\)

       We build a binary tree of formulas \((\phi_\sigma:\sigma\in 2^{<\omega})\) s.t.
       1. each \([\phi_\sigma]\) is nonempty but contains no isolated types
       2. if \(\sigma\subset\tau\), then \(\phi_\tau\vDash\phi_\sigma\)
       3. \(\phi_{\sigma,i}\vDash\neg\phi_{\sigma,1-i}\)
       Let \(\phi_\emptyset=\phi\) for some formula \phi where \([\phi]\) contains no isolated types. Suppose
       that \([\phi_\sigma]\) is nonempty but contains no isolated types. As above, we can find \psi
       s.t. \([\phi_\sigma\wedge\psi]\) and \([\phi_\sigma\wedge\neg\psi]\) are both nonempty and neither contains an isolated type.
       Let \(\phi_{\sigma,0}=\phi\wedge\psi\) and \(\phi_{\sigma,1}=\phi\wedge\neg\psi\)

       Let \(f:\omega\to 2\). Because
       \begin{equation*}
        [\phi_{f|0}]\supseteq[\phi_{f|1}]\supseteq[\phi_{f|2}]\supseteq\cdots
        \end{equation*}
       and \(S_n^{\calm}(A)\) is compact, there is
       \begin{equation*}
        p_f\in\bigcap_{n=0}^\infty[\phi_{f|n}]
        \end{equation*}
       If \(g\neq f\), we can find \(m\) s.t. \(f|m=g|m\) but \(f(m)\neq g(m)\). By
       construction, \(\phi_{f|m+1}\vDash\neg\phi_{g|m+1}\); thus \(p_f\neq p_g\). Because \(f\mapsto p_f\) is a one-to-one
       function from \(2^\omega\) into \(S_n^{\calm}(A)\), \(\abs{S_n^{\calm}(A)}=2^{\aleph_0}\)
    2. Suppose that \(\abs{S_n^{\calm}(A)}>\aleph_0\). We claim that \(\abs{S_n^{\calm}(A)}=2^{\aleph_0}\).
       Because \(\abs{S_n^{\calm}(A)}>\aleph_0\), and there are only countably many \(\call_A\)-formulas, there
       is a formula \phi s.t. \(\abs{[\phi]}>\aleph_0\) as \(S_n^{\calm}(A)=\bigcup[\phi]\).

       *Claim* if \(\abs{[\phi]}>\aleph_0\), there is an \(\call_A\)-formula \psi s.t. \(\abs{[\phi\wedge\psi]}>\aleph_0\)
       and \(\abs{[\phi\wedge\neg\psi]}>\aleph_0\)

       Suppose not. Let \(p=\{\psi(\barv):\abs{[\phi\wedge\psi]}>\aleph_0\}\). \(p\) is complete
       since \([\phi]=[\phi\wedge\psi]\cup[\phi\wedge\neg\psi]\). We claim that \(p\) is satisfiable.
       Suppose \(\psi_1,\dots,\psi_m\in p\). Either \(\psi_1\wedge\dots\wedge\psi_m\in p\), in which case \(\{\psi_1,\dots,\psi_m\}\cup\Th_A(\calm)\) is
       satisfiable, or \(\neg\psi_1\vee\dots\vee\neg\psi_m\in p\). Because
       \begin{equation*}
       [\neg\psi_1\vee\dots\vee\neg\psi_m]=[\neg\psi_1]\cup\dots\cup[\neg\psi_m]
       \end{equation*}
       We must have \(\abs{[\phi\wedge\neg\psi_i]}>\aleph_0\) for some \(i\), a contradiction. Thus \(p\in S_n^{\calm}(A)\).
       Moreover, if \(\psi\not\in p\), then \([\phi\wedge\psi]\le\aleph_0\). But
       \begin{equation*}
       [\phi]=\bigcup_{\psi\not\in p}[\phi\wedge\psi]\cup\{p\}
       \end{equation*}
       (Consider \([\phi]\setminus\bigcup_{\psi\notin p}[\phi\wedge\psi]\), which is exactly \(p\))
       Because \([\phi]\) is the union of at most \(\aleph_0\) sets each of size at most \(\aleph_0\), we
       have \(\abs{[\phi]}\le\aleph_0\), a contradiction.

       We build a binary tree of formulas \((\phi_\sigma:\sigma\in 2^{<\omega})\) s.t.
       1. if \(\sigma\subset\tau\), then \(\phi_\tau\vDash\phi_\sigma\)
       2. \(\phi_{\sigma,i}\vDash\neg\phi_{\sigma,1-i}\)
       3. \(\abs{[\phi_\sigma]}>\aleph_0\)
       Let \(\phi_\emptyset=\phi\) for some \phi with \(\abs{[\phi]}>\aleph_0\). Given \(\phi_\sigma\) where \(\abs{[\phi_\sigma]}>\aleph_0\), by
       the chain we can find \psi s.t. \(\abs{[\phi_\sigma\wedge\psi]}>\aleph_0\) and \(\abs{[\phi_\sigma\wedge\neg\psi]}>\aleph_0\).
       Let \(\phi_{\sigma,0}=\phi_\sigma\wedge\psi\) and \(\phi_{\sigma,1}=\phi_\sigma\wedge\neg\psi\)

       As in 1, for each \(f\in 2^\omega\) there is a
       \begin{equation*}
       p_f\in\bigcap_{m=0}^\infty[\phi_{f|m}]
       \end{equation*}
       and if \(f\neq g\), then \(p_f\neq p_g\). Thus \(\abs{S_n^{\calm}(A)}=2^{\aleph_0}\)
    #+END_proof


*** Countable Homogeneous Models
    Our next goal is to show that prime models are unique up to isomorphism

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \kappa be an infinite cardinal. We say that \(\calm\vDash T\) is *\kappa-homogeneous* if
    whenever \(A\subset M\) with \(\abs{A}<\kappa\), \(f:A\to M\) is a partial elementary map, and \(a\in M\),
    there is \(f^*\supseteq f\) s.t. \(f^*:A\cup\{a\}\to M\) is partial elementary

    We say that \(\calm\) is *homogeneous* if it is \(\abs{M}\)-homogeneous
    #+END_definition

    In homogeneous models, partial elementary maps are just restrictions of automorphisms

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    Suppose that \(\calm\) is homogeneous, \(A\subset M\), \(\abs{A}<\abs{M}\), and \(f:A\to M\) is a partial
    elementary map. Then there is an automorphism \sigma of \(\calm\) with \(\sigma\supseteq f\).

    In particular, if \(\calm\) is homogeneous and \(\bara,\barb\in M^n\) realize the same \(n\)-type, then
    there is an automorphism \sigma of \(\calm\) with \(\sigma(\bara)=\barb\)
    #+END_proposition

    #+BEGIN_proof
    Let \(\abs{M}=\kappa\) and let \((a_\alpha:\alpha<\kappa)\) be an enumeration of \(M\). We build a sequence of
    partial elementary maps \((f_\alpha:\alpha<\kappa)\) extending \(f\) with \(f_\alpha\subseteq f_\beta\) for \(\alpha<\beta\) s.t. \(a_\alpha\)
    is in the domain and image of \(f_{\alpha+1}\) and \(\abs{f_{\alpha+1}}\le\abs{f_\alpha}+2<\kappa\).
    Then \(\sigma=\bigcup_{\alpha<\kappa}f_\alpha\) is the desired automorphism. Let \(f_0=f\).

    If \alpha is a limit ordinal and \(f_\beta\) is partial elementary with
    \begin{equation*}
    \abs{f_\beta}\le\abs{A}+\abs{\beta}+\aleph_0<\kappa
    \end{equation*}
    for all \(\beta<\alpha\), let \(f_\alpha=\bigcup_{\beta<\alpha}f_\beta\). Then \(f_\alpha\) is partial elementary and
    \begin{equation*}
    \abs{f_\alpha}\le\abs{\alpha}(\abs{A}+\abs{\alpha}+\aleph_0)\le\abs{A}+\abs{\alpha}+\aleph_0<\kappa
    \end{equation*}
    Given \(f_\alpha\) with \(\abs{f_\alpha}<\kappa\), because \(\calm\) is homogeneous, there is \(b\in M\) s.t.
    if \(g_\alpha=f_\alpha\cup\{(a_\alpha,b)\}\), then \(g_\alpha\) is partial elementary. Note that \(g_\alpha^{-1}\) is also
    partial elementary. Thus there is \(c\in M\) s.t. \(g^{-1}_\alpha\cup\{(a_\alpha,c)\}\) is partial elementary.
    Thus \(f_{\alpha+1}=g_\alpha\cup\{(c,a_\alpha)\}\) is partial
    elementary, \(\abs{f_{\alpha+1}}\le\abs{f_\alpha}+2\le\abs{A}+\abs{\alpha}+\aleph_0\) and \(a_\alpha\) is in the domain and
    range of \(f_{\alpha+1}\)
    #+END_proof

    If \(\calm\) is homogeneous and \(\tp^{\calm}(\bara)=\tp^{\calm}(\barb)\), then \(\bara\mapsto\barb\) is a partial
    elementary map that must extend to an automorphism

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma4.2.14
    If \(\calm\) is atomic, then \(\calm\) is \(\aleph_0\)-homogeneous. In particular, countable atomic models
    are homogeneous
    #+END_lemma

    #+BEGIN_proof
    Suppose that \(\bara\mapsto\barb\) is elementary and \(c\in M\). Let \(\phi(\barv,w)\)
    isolate \(\tp^{\calm}(\bara,c)\). Because \(\calm\vDash\exists w\;\phi(\bara,w)\) and \(\bara\mapsto\barb\) is
    elementary, \(\calm\vDash\exists w\;\phi(\barb,w)\). Suppose that \(\calm\vDash\phi(\barb,d)\). Because \(\phi(\barv,w)\)
    isolates a type, \(\tp^{\calm}(\bara,c)=\tp^{\calm}(\barb,d)\). Thus \(\bara,c\mapsto\barb,d\) is elementary
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.2.15
    Let \(T\) be a complete theory in a countable language. Suppose that \(\calm\) and \(\caln\) are
    countable homogeneous models of \(T\) and \(\calm\) and \(\caln\) realize the same types in \(S_n(T)\)
    for \(n\ge 1\). Then \(\calm\cong\caln\).
    #+END_theorem

    #+BEGIN_proof
    We build an isomorphism \(f:\calm\to\caln\) by a back-and-forth argument. We will build \(f_0\subset f_1\subset\cdots\) a
    sequence of partial elementary maps with finite domain, and let \(f=\bigcup_{i=0}^\infty f_i\).
    Let \(a_0,a_1,\dots\) enumerate \(M\) and \(b_0,b_1,\dots\) enumerate \(N\). We will ensure
    that \(a_i\in\dom(f_{2i+1})\) and \(b_i\in\im(f_{2i+2})\).

    _stage 0_: Let \(f_0=\emptyset\). Because \(T\) is complete \(f_0\) is partial elementary

    We inductively assume that \(f_s\) is partial elementary. Let \(\bara\) be the domain of \(f_s\)
    and \(\barb=f_s(\bara)\)

    _stage \(s+1=2i+1\)_: Let \(p=\tp^{\calm}(\bara,a_i)\). Because \(\calm\) and \(\caln\) realize the same types,
    we can find \(\barc,d\in N\) s.t. \(\tp^{\caln}(\barc,d)=p\). Note
    that \(\tp^{\caln}(\barc)=\tp^{\calm}(\bara)\) by choice of \(\barc\)
    and \(\tp^{\calm}(\bara)=\tp^{\caln}(\barb)\) because \(f_s\) is partial elementary.
    Thus \(\tp^{\caln}(\barc)=\tp^{\caln}(\barb)\). Because \(\caln\) is homogeneous, there is \(e\in N\) s.t.
    \(\tp^{\caln}(\barb,e)=\tp^{\caln}(\barc,d)=p\). Thus \(f_{s+1}=f_s\cup\{(a_i,e)\}\) is partial elementary
    with \(a_i\) in the domain

    _stage \(s+1=2i+2\)_: the same
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    Let \(T\) be a complete theory in a countable language. If \(\calm\) and \(\caln\) are prime models
    of \(T\), then \(\calm\cong\caln\)
    #+END_corollary

    #+BEGIN_proof
    By Theorem ref:thm4.2.8, \(\calm\) and \(\caln\) are atomic. Because the types in \(S_n(T)\) realized in
    an atomic model are exactly the isolated types, \(\calm\)and \(\caln\) realize the same types. By Lemma
    ref:lemma4.2.14, countable atomic models are homogeneous. Thus by Theorem ref:thm4.2.15 \(\calm\cong\caln\)
    #+END_proof

*** Prime Model Extensions of \texorpdfstring{\(\omega\)}{ω}-Stable Theories
    Suppose that \(\calm\vDash T\) and \(A\subseteq M\). We say that \(\calm\) is *prime over* \(A\) if whenever \(\caln\vDash T\)
    and \(f:A\to\caln\) is partial elementary, there is an elementary \(f^*:\calm\to\caln\) extending \(f\)

    Let \(L\) be any linear order. We build \(L^*\vDash\DLO\) prime over \(L\) as follows. If \(L\) has a
    least element \(a\), add a copy of \(\Q\) below \(a\). If \(L\) has a greatest element \(b\), add
    a copy of \(\Q\) above \(b\). If \(c,d\in L\) with \(c<d\) but there are no element of \(L\)
    between \(c\) and \(d\), add a copy of \(\Q\) between \(c\) and \(d\). We add no new elements.
    Then \(L^*\vDash\DLO\) and that if \(f:L\to\calm\vDash\DLO\), then \(f\) extends to \(f^*:L^*\to\calm\).
    Because \(\DLO\) has quantifier elimination, it is model-complete and \(f^*\)is elementary

    For \(\ACF\), if \(R\) is any integral domain and \(F\) is the algebraic closure of the fraction
    field of \(R\), then \(F\) is prime over \(R\) and any embedding of \(R\) into an algebraically
    closed field \(K\) extends to \(F\). Because \(\ACF\) is model-complete, this map is elementary

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \(T\) be a complete theory in a countable language, and let \kappa be an infinite cardinal. We
    say that \(T\) is *\kappa-stable* if whenever \(\calm\vDash T\), \(A\subseteq M\)
    and \(\abs{A}=\kappa\), then \(\abs{S_n^{\calm}(A)}=\kappa\)

    We say that \(\calm\) is *\kappa-stable* if \(\Th(\calm)\) is \kappa-stable
    #+END_definition

    By Corollary ref:cor4.1.18 \(\ACF\) is \omega-stable. On the other hand, \(\abs{S_1^{\Q}(\Q)}=2^{\aleph_0}\)
    so \(\DLO\) is not \omega-stable

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.2.18
    Let \(T\) be a complete theory in a countable language. If \(T\) is \omega-stable, then \(T\) is
    \kappa-stable for all infinite cardinals \kappa
    #+END_theorem

    #+BEGIN_proof
    Suppose that \(\calm\vDash T\), \(A\subseteq M\), \(\abs{A}=\kappa\) and \(\abs{S_n^{\calm}(A)}>\kappa\). Because there are
    only \kappa formulas with parameters from \(A\), there is some \(\call_A\)-formula \(\phi_\emptyset(\barv)\)
    s.t. \(\abs{[\phi_\emptyset]}>\kappa\) as \(S_n^{\calm}(A)=\bigcup[\phi]\) where \(\phi\) is consistent with \(\Th_A(\calm)\). The
    argument from Theorem ref:thm4.2.11 (2) can be extended to show that if \(\abs{[\phi]}>\kappa\) there is
    an \(\call_A\)-formula \psi s.t. \(\abs{[\phi\wedge\psi]}>\kappa\) and \(\abs{[\phi\wedge\neg\psi]}>\kappa\)

    Then we build a binary tree of formulas \((\phi_\sigma:\sigma\in 2^{<\omega})\) s.t.
    1. if \(\sigma\subset\tau\) then \(\phi_\tau\vDash\phi_\sigma\)
    2. \(\phi_{\sigma,i}\vDash\neg\phi_{\sigma,1-i}\)
    3. \(\abs{[\phi_\sigma]}>\kappa\)


    Let \(A_0\) be set of all parameters from \(A\) occurring in any formula \(\phi_\sigma\).  \(A_0\) is
    countable. Arguing as in Theorem ref:thm4.2.11 (2) \(\abs{S_n^{\calm}(A_0)}=2^{\aleph_0}\), contradicting
    the \omega-stability of \(T\)
    #+END_proof

    #+BEGIN_remark
    As long as we make some property \(P\) coherent for \(\phi\), \(\phi\wedge\neg\psi\) and \(\phi\wedge\psi\), we can use the
    technique to make a \omega-length tree and get something \(\abs{S_n^{\calm}(A)}=2^{\aleph_0}\)
    #+END_remark

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    label:prop4.2.19
    Let \(T\) be a complete theory in a countable language. If \(T\) is \omega-stable, then for
    all \(\calm\vDash T\) and \(A\subseteq M\), the isolated types in \(S_n^{\calm}(T)\) are dense
    #+END_proposition

    #+BEGIN_proof
    Suppose not. We can build a binary tree of formulas as in Theorem ref:thm4.2.11 (1). As in
    Theorem ref:thm4.2.18, we can find a countable \(A_0\subseteq A\) s.t. all parameters come from \(A_0\).
    But then \(\abs{S_n^{\calm}(A_0)}=2^{\aleph_0}\), contradicting the \omega-stability
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.2.20
    Suppose that \(T\) is \omega-stable. Let \(\calm\vDash T\) and \(A\subseteq M\). There is \(\calm_0\prec\calm\), a prime model
    extension of \(A\). Moreover, we can choose \(\calm_0\) s.t. every element of \(\calm_0\) realizes an
    isolated type over \(A\)
    #+END_theorem

    #+BEGIN_proof
    We will find an ordinal \delta and build a sequence of sets \((A_\alpha:\alpha\le\delta)\) where \(A_\alpha\subseteq M\) and
    1. \(A_0=A\)
    2. if \alpha is a limit ordinal, then \(A_\alpha=\bigcup_{\beta<\alpha}A_\beta\)
    3. if no element of \(M\setminus A_\alpha\) realizes an isolated type over \(A_\alpha\), we stop and let \(\delta=\alpha\);
       otherwise, pick \(a_\alpha\) realizing an isolated type over \(A_\alpha\), and
       let \(A_{\alpha+1}=A_\alpha\cup\{a_\alpha\}\).

    Let \(\calm_0\) be the substructure of \(\calm\) with universe \(A_\delta\)


    *Claim 1* \(\calm_0\prec\calm\).

    We apply the Tarski-Vaught test. Suppose that \(\calm\vDash\exists v\phi(v,\bara)\), where \(\bara\in A_\delta\). By
    Proposition ref:prop4.2.19, the isolated types in \(S^{\calm}(A_\delta)\) are dense. Thus, there
    is \(b\in M\) s.t. \(\calm\vDash\phi(b,\bara)\) and \(\tp^{\calm}(b/A_\delta)\) <<Problem4>> is isolated.
    #+LATEX: \wu{
    (\(\phi(x,\bara)\) is contained in an isolated type, and isolated type is realised in \(\calm\))
    #+LATEX: }
    By Choice of
    \delta, \(b\in A_\delta\). Thus by Proposition ref:prop2.3.5, \(\calm_0\prec\calm\)

    *Claim 2* \(\calm_0\) is a prime model extension of \(A\)

    Suppose that \(\caln\vDash T\) and \(f:A\to\caln\) is partial elementary. We show by induction that there
    are \(f=f_0\subset\cdots\subset f_\alpha\subset\cdots\subset f_\delta\) where \(f_\alpha:A_\alpha\to\caln\) is elementary

    if \alpha is a limit ordinal, we let \(f_\alpha=\bigcup_{\beta<\alpha}f_\beta\)

    Given \(f_\alpha:A_\alpha\to\caln\) partial elementary, \(\phi(v,\bara)\) isolate \(\tp^{\calm_0}(a_\alpha/A_\alpha)\).
    Because \(f_\alpha\) is partial elementary, by Lemma ref:lemma4.1.9 (3), \(\phi(v,f_\alpha(\bara))\)
    isolates \(f_\alpha(\tp^{\calm}(a_\alpha/A_\alpha))\) in \(S_1^{\caln}(f_\alpha(A))\). Also, because \(f_\alpha\) is partial
    elementary, there is \(b\in N\) with \(\caln\vDash\phi(b,f_\alpha(\bara))\). Thus \(f_{\alpha+1}=f_\alpha\cup\{(a_\alpha,b)\}\) is
    elementary

    In particular, \(f_\delta:\calm_0\to\caln\) is elementary. Thus \(\calm_0\) is a prime model extension of \(A\)
    #+END_proof

    #+LATEX: \wu{
    So the isolated types are dense in the sense of build elementary maps?
    #+LATEX: }

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    Suppose that \(A\subseteq B\subseteq \calm\vDash T\) and every \(\barb\in B^m\) realizes an isolated type in \(S_m^{\calm}(A)\).
    Suppose that \(\bara\in M^n\) realizes an isolated type in \(S_n^{\calm}(B)\). Then \(\bara\) realizes
    an isolated type in \(S_n^{\calm}(A)\)
    #+END_lemma

    #+BEGIN_proof
    Let \(\phi(\barv,\barw)\) be an \(\call\)-formula and \(\barb\in B^m\) s.t. \(\phi(\barv,\barb)\)
    isolates \(\tp^{\calm}(\bara/B)\). Let \(\theta(\barw)\) be an \(\call_A\)-formula
    isolating \(\tp^{\calm}(\barb/A)\). We first claim that \(\phi(\barv,\barw)\wedge\theta(\barw)\)
    isolates \(\tp^{\calm}(\bara,\barb/A)\)

    Suppose that \(\calm\vDash\psi(\bara,\barb)\). Because \(\phi(\barv,\barb)\) isolates \(\tp^{\calm}(\bara/B)\)
    \begin{equation*}
    \Th_A(\calm)\vDash\forall\barv(\phi(\barv,\barb)\to\psi(\barv,\barb))
    \end{equation*}
    Thus, because \(\theta(\barw)\) isolates \(\tp^{\calm}(\barb/A)\)
    \begin{equation*}
    \Th_A(\calm)\vDash\forall\barw(\theta(\barw)\to\forall\barv(\phi(\barv,\barw)\to\psi(\barv,\barw)))
    \end{equation*}
    and
    \begin{equation*}
    \Th_A(\calm)\vDash\forall\barw\forall\barv(\theta(\barw)\wedge\phi(\barv,\barw)\to\psi(\barv,\barw))
    \end{equation*}
    as desired

    Because \(\tp^{\calm}(\bara,\barb/A)\) is isolated, so is \(\tp^{\calm}(\bara/A)\) by Lemma
    ref:lemma4.2.9
    #+END_proof

    For \omega-stable theories (indeed, for theories that are \kappa-stable for some \kappa), prime model
    extensions are unique

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    Let \(T\) be \omega-stable. Suppose that \(\calm\vDash T\) and \(\caln\vDash T\) are prime model extensions of \(A\)
    and \(\Th_A(\calm)=\Th_A(\caln)\). Then there is \(f:\calm\to\caln\), an isomorphism fixing \(A\).
    #+END_theorem
** Saturated and Homogeneous Models
    Assume that \(T\) is a complete theory with infinite models in a countable language \(\call\)

    [[index:saturated model]]
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \kappa be an infinite cardinal. \(\calm\vDash T\) is *\kappa-saturated* if for all \(A\subseteq M\),
    if \(\abs{A}<\kappa\) and \(p\in S_n^{\calm}(A)\), then \(p\) is realized in \(\calm\)

    \(\calm\) is *saturated* if it is \(\abs{\calm}\)-saturated
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    Let \(\kappa\ge\aleph_0\). TFAE:
    1. \(\calm\) is \kappa-saturated
    2. if \(A\subseteq M\) with \(\abs{A}<\kappa\) and \(p\) is a (possibly incomplete) \(n\)-type over \(A\),
       then \(p\) is realized in \(\calm\)
    3. if \(A\subseteq M\) with \(\abs{A}<\kappa\) and \(p\in S_1^{\calm}(A)\), then \(p\) is realized in \(\calm\)
    #+END_proposition

    #+BEGIN_proof
    \(3\to 1\). Induction on \(n\). Let \(p\in S_n^{\calm}(A)\). Let \(q\in S_{n-1}^{\calm}(A)\) be the
    type \(\{\phi(v_1,\dots,v_{n-1}):\phi\in p\}\). By induction, \(\calm\vDash q(\bara)\) for some \(\bara\).
    Let \(r\in S_1^{\calm}(A\cup\{a_1,\dots,a_{n-1}\})\) be the type \(\{\psi(\bara,w):\psi(v_1,\dots,v_n)\in p\}\). Hence we can
    realize \(r\) by some \(b\). Then \((\bara,b)\) realizes \(p\)
    #+END_proof

    Homogeneity is a weak form of saturation

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    label:prop4.3.3
    If \(\calm\) is \kappa-saturated, then \(\calm\)  is \kappa-homogeneous
    #+END_proposition

    #+BEGIN_proof
    Suppose that \(A\subseteq M\), \(\abs{A}<\kappa\) and \(f:A\to M\) is partial elementary. Let \(b\in M\setminus A\). Let
    \begin{equation*}
    \Gamma=\{\phi(v,f(\bara)):\bara\in A^m\wedge\calm\vDash\phi(b,\bara)\}
    \end{equation*}
    If \(\phi(v,f(\bara))\in\Gamma\), then \(\calm\vDash\exists v\;\phi(v,\bara)\) and hence, because \(f\) is partial
    elementary, \(\calm\vDash\exists v\;\phi(v,f(\bara))\). Thus because \Gamma is closed under conjunctions, \Gamma is
    satisfiable (guess by compactness). Because \(\calm\) is saturated, there is \(c\in M\) realizing \Gamma. Thus \(f\cup\{(b,c)\}\) is
    elementary and \(\calm\) is \kappa-homogeneous
    #+END_proof

***  Countably Saturated Models
    If \(\calm\) is \(\aleph_0\)-saturated, then \(\calm\) realizes every type in \(S_n(T)\)

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    label:prop4.3.4
    If \(\calm\vDash T\), then \(\calm\) is \(\aleph_0\)-saturated iff \(\calm\) is \(\aleph_0\)-homogeneous and \(\calm\) realizes
    all types in \(S_n(T)\)
    #+END_proposition

    #+BEGIN_proof
    Since \(T\) is complete, \(S_n(T)=S_n^{\calm}(\emptyset)\)

    \(\Leftarrow\). Let \(\bara\in M^m\) and let \(p\in S_n^{\calm}(\bara)\). Let \(q\in S_{n+m}(T)\) be the
    type \(\{\phi(\barv,\barw):\phi(\barv,\bara)\in p\}\). By assumption, there is \((\barb,\barc)\in M^{n+m}\)
    realizing \(q\). Because \(\tp^{\calm}(\barc)=\tp^{\calm}(\bara)\) as they realize the same type and \(\calm\) is \(\aleph_0\)-homogeneous,
    there is \(\bard\in\calm\) s.t. \(\tp^{\calm}(\bara,\bard)=\tp^{\calm}(\barc,\barb)\). Hence \(\bard\)
    realizes \(p\) and \(\calm\) is \(\aleph_0\)-saturated
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor4.3.5
    If \(\calm,\caln\vDash T\) are countable saturated models, then \(\calm\cong\caln\)
    #+END_corollary

    #+BEGIN_proof
    Because \(\calm\) and \(\caln\) are \(\aleph_0\)-homogeneous and both realize all types in \(S_n(T)\) for
    all \(n<\omega\), by Theorem ref:thm4.2.15 \(\calm\cong\caln\)
    #+END_proof

    We can extend models to \(\aleph_0\)-homogeneous models without increasing the cardinality

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    label:prop4.3.6
    Let \(\calm\vDash T\). There is \(\calm\prec\caln\) s.t. \(\caln\) is \(\aleph_0\)-homogeneous and \(\abs{N}=\abs{M}\)
    #+END_proposition

    #+BEGIN_proof
    We first argue that we can find \(\calm\prec\caln_1\) s.t. \(\abs{M}=\abs{N_1}\), and if \(\bara,\barb,c\in M\)
    and \(\tp^{\calm}(\bara)=\tp^{\calm}(\barb)\), then there is \(d\in N_1\)
    s.t. \(\tp^{\caln_1}(\bara,c)=\tp^{\caln_1}(\barb,d)\)

    Let \((\bara_\alpha,\barb_\alpha,c_\alpha):\alpha<\abs{M}\) list all tuples \((\bara,\barb,c)\)
    where \(\bara,\barb,c\in M\) and \(\tp^{\calm}(\bara)=\tp^{\calm}(\barb)\). We build an elementary
    chain \(\calm_0\prec\calm_1\prec\dots\prec\calm_\alpha\prec\cdots\) for \(\alpha<\abs{M}\)

    Let \(\calm_0=\calm\)

    If \alpha is a limit ordinal, let \(\calm_\alpha=\bigcup_{\beta<\alpha}\calm_\beta\)

    Given \(\calm_\alpha\), let \(\calm_\alpha\prec\calm_{\alpha+1}\) with \(\abs{M_\alpha}=\abs{M_{\alpha+1}}\) s.t. there is \(d\in\calm_\alpha\)
    with \(\tp^{\calm_{\alpha+1}}(\barb,d)=\tp^{\calm_{\alpha+1}}(\bara,c)\). First we should note
    that \(\tp^{\calm_{\alpha+1}}(\bara,c)=\tp^{\calm_\beta}(\bara,c)\) for any \(\beta<\alpha+1\).
    Let \(p(x)=\{\phi(\barb,x):\phi(\barv,w)\in\tp^{\calm}(\bara,c)\}\). \(p\cup\Th(\calm)\) is finitely satisfiable
    since for each \(\phi(\barb,x)\in p(x)\), \(\calm\vDash\exists x\phi(\barb,x)\) and \(p\) is closed under conjunction.
    Thus \(p(x)\) is a type, thus is realized in an elementary extension of \(\calm_{\alpha+1}\).


    Let \(\caln_1=\bigcup_{\alpha<\abs{M}}\calm_\alpha\).
    Because \(\caln_1\) is a union of \(\abs{M}\) models of size \(\abs{M}\), \(\abs{N_1}=\abs{M}\)

    We now build \(\caln_0\prec\caln_1\prec\cdots\) s.t. \(\abs{N_i}=\abs{M}\) and if \(\bara,\barb,c\in N\)
    and \(\tp^{\caln_i}(\bara)=\tp^{\caln_i}(\barb)\), then there is \(d\in N_{i+1}\)
    s.t. \(\tp^{\caln_{i+1}}(\bara,c)=\tp^{\caln_{i+1}}(\barb,d)\)

    Let \(\caln=\bigcup_{i<\omega}\caln_i\). Clearly \(\abs{N}=\abs{M}\) and \(\caln\) is \(\aleph_0\)-homogeneous
    #+END_proof

    Propositions ref:cor4.3.5 and ref:prop4.3.6 allows us to characterize theories with countable
    saturated models

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    \(T\) has a countable saturated model iff \(\abs{S_n(T)}\le\aleph_0\) for all \(n\)
    #+END_theorem

    #+BEGIN_proof
    \(\Rightarrow\). If \(T\) has a countable saturated model \(\calm\), by Proposition ref:prop4.3.4 \(\calm\)
    realizes all types in \(S_n(T)\), but there are only countably many possibilities.

    \(\Leftarrow\). Let \(p_0,p_1,\dots\) list all elements of \(\bigcup_{n\in\omega}S_n(T)\). Let \(\calm_0\vDash T\). Iterating Proposition
    ref:prop4.1.3, we build \(\calm_0\prec\calm_1\prec\cdots\) s.t. \(\calm_i\) is countable and \(\calm_{i+1}\) realizes \(p_i\).
    Thus \(\calm=\bigcup_{i\in\omega}\calm_i\) is countable and contains realizations of all types in \(S_n(T)\)
    for \(n<\omega\). By proposition ref:prop4.3.6, there is \(\calm\prec\caln\) s.t. \(\caln\) is countable
    and \(\aleph_0\)-homogeneous. By Corollary ref:cor4.3.5 \(\caln\) is \(\aleph_0\)-saturated
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor4.3.8
    1. If \(T\) has a countable saturated model, then \(T\) has a prime model
    2. If \(T\) has fewer than \(2^{\aleph_0}\) countable models, then \(T\) has a countable saturated
       model and a prime model
    #+END_corollary

    #+BEGIN_proof
    1. if \(T\) has a countable saturated model, then \(\abs{S_n(T)}\) is countable for all \(n\).
       By Theorem ref:thm4.2.11, the isolated types are dense in \(S_n(T)\) for all \(n\). Thus, by
       Theorem ref:thm4.2.10 \(T\) has a prime model
    2. It suffices to show that \(S_n(T)\) is countable for all \(n<\omega\). Suppose not. By Theorem
       ref:thm4.2.11, if \(\abs{S_n(T)}>\aleph_0\), then \(\abs{S_n(T)}=2^{\aleph_0}\). Each \(n\)-type must
       be realized in some countable model. Because each countable model realizes only countably
       many \(n\)-types, if there are \(2^{\aleph_0}\) \(n\)-types, then there must be \(2^{\aleph_0}\)
       nonisomorphic countable models
    #+END_proof

    #+ATTR_LATEX: :options [Dense Linear Orders]
    #+BEGIN_examplle
    We will show that \((\Q,<)\) is saturated. Suppose \(A\subset\Q\) is finite. Suppose
    that \(A=\{a_1,\dots,a_n\}\)  where \(a_1<\cdots<a_n\). By the analysis of types in DLO, there are
    exactly \(2m+1\) types in \(S_1(A)\). Each type is isolated by one of the
    formulas \(v=a_i\), \(v<a_0\), \(a_i<v<a_{i+1}\), or \(a_m<v\). Clearly all of these types are
    realized in \(\Q\). Note that in this case \(\Q\) is both saturated, atomic and prime.
    #+END_examplle

*** Existence of Saturated Models
    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.3.12
    For all \(\calm\), there is a \(\kappa^+\)-saturated \(\calm\prec\caln\) with \(\abs{N}\le\abs{M}^\kappa\)
    #+END_theorem

    We need \(\abs{M}^\kappa\) since \(\kappa^+\le 2^\kappa\le\abs{M^\kappa}\). I guess

    #+BEGIN_proof
    *Claim* For any \(\calm\) there is \(\calm\prec\calm'\) s.t. \(\abs{M'}\le\abs{M}^\kappa\), and if \(A\subseteq M\), \(\abs{A}\le\kappa\)
    and \(p\in S_1^{\calm}(A)\), then \(p\) is realized in \(\calm'\)

    We first note that
    \begin{equation*}
    \abs{\{A\subseteq M:\abs{A}\le\kappa\}}\le\abs{M}^\kappa
    \end{equation*}
    because for each such \(A\) there is \(f\) mapping \kappa onto \(A\). Also for each
    such \(A\), \(\abs{S_1^{\calm}(A)}\le 2^\kappa\). Let \((p_\alpha:\alpha<\abs{M}^\kappa)\) list all types in \(S_1^{\calm}(A)\)
    for \(n<\omega\), \(A\subseteq M\) with \(\abs{A}\le\kappa\). We build an elementary chain \((\calm_\alpha:\alpha<\abs{M}^\kappa)\) as
    follows
    1. \(\calm_0=\calm\)
    2. \(\calm_\alpha=\bigcup_{\beta<\alpha}\calm_\beta\) for \alpha a limit ordinal
    3. \(\calm_\alpha\prec\calm_{\alpha+1}\) with \(\abs{M_{\alpha+1}}=\abs{M_\alpha}\), \(\calm_{\alpha+1}\) realizes \(p_\alpha\).
       #+LATEX: \wu{
       \(p_\alpha\) is realized in an elementary extension of \(\calm_\alpha\) by \(\barc\). Then we get
       the \(\calm_{\alpha+1}\) by Löwenheim–Skolem Theorem..
       #+LATEX: }


    By induction we see that \(\abs{M_\alpha}\le\abs{M}^\kappa\). Let \(\calm'=\bigcup_{\alpha<\abs{M}^\kappa}\calm_\alpha\).
    Then \(\abs{M'}\le\abs{M}^\kappa\) and \(\calm'\) is the desired model.

    We build an elementary chain \((\caln_\alpha:\alpha<\kappa^+)\) s.t. each \(\abs{N_\alpha}\le\abs{M}^\kappa\) and
    1. \(\caln_0=\calm\)
    2. \(\caln_\alpha=\bigcup_{\beta<\alpha}\caln_\beta\) for \alpha a limit ordinal
    3. \(\caln_\alpha\prec\caln_{\alpha+1}\), \(\abs{\caln_\alpha}\le\abs{M}^\kappa\), and if \(A\subseteq N_\alpha\) with \(\abs{A}\le\kappa\)
       and \(p\in S_n^{\caln_\alpha}(A)\), then \(p\) is realized in \(\caln_{\alpha+1}\). This is possible because, by
       induction
       \begin{equation*}
       \abs{N_\alpha}^\kappa\le\left(\abs{M}^\kappa\right)^\kappa=\abs{M}^\kappa
       \end{equation*}


    Let \(\caln=\bigcup_{\alpha<\kappa^+}\caln_\alpha\). Because \(\kappa^+\le\abs{M}^\kappa\), \(N\) is the union of at most \(\abs{M}^\kappa\)
    sets of size \(\abs{M}^\kappa\) so \(\abs{N}\le\abs{M}^\kappa\). Suppose that \(\abs{A}\subseteq N\), \(\abs{A}\le\kappa\),
    and \(p\in S_n^{\caln}(A)\). _Because \(\kappa^+\) is a regular cardinal, there is \(\alpha<\kappa^+\) s.t. \(A\subset N_\alpha\)_
    and \(p\) is realized in \(\caln_{\alpha+1}\prec\caln\). Thus \(\caln\) is \(\kappa^+\)-saturated
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor4.3.13
    Suppose that \(2^\kappa=\kappa^+\). Then there is a saturated model of \(T\) of size \(\kappa^+\). In particular,
    if the Generalized Continuum Hypothesis is true, there are saturated models of size \(\kappa^+\) for
    all \(\kappa\)
    #+END_corollary

    If \(\abs{S_n(T)}=2^{\aleph_0}\), then any \(\aleph_0\)-saturated model has size \(2^{\aleph_0}\).
    If \(\aleph_1<2^{\aleph_0}\), then there is no saturated mode of size \(\aleph_1\)

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    Suppose that \(\kappa\ge\aleph_1\) is regular and \(2^\lambda\le\kappa\) for \(\lambda<\kappa\). Then there is a saturated model of
    size \kappa. In particular, if \(\kappa\ge\aleph_1\) is strongly inaccessible, then there is a saturated model of
    size \kappa
    #+END_corollary

    #+BEGIN_proof
    Let \(\calm\vDash T\) with \(\abs{M}=\kappa\). If \(\kappa=\lambda^+\) for \(\lambda<\kappa\), then the corollary follows from
    Corollary ref:cor4.3.13. Thus we may assume that \kappa is a limit cardinal. We build an elementary
    chain \((\calm_\lambda:\lambda<\kappa,\lambda\text{ a cardinal})\). Each \(\calm_\lambda\) will have cardinality \kappa. Let \(\calm_0=\calm\)

    Let \(\calm_\lambda=\bigcup_{\mu<\lambda}\calm_\mu\) for \lambda a limit cardinal. Because \(\calm_\alpha\) is the union of fewer than \kappa
    models of size \kappa, \(\abs{M_\lambda}=\kappa\).

    Given \(\calm_\lambda\), by Theorem ref:thm4.3.12 there is \(\calm_\lambda\prec\calm_{\lambda^+}\) s.t. \(\calm\) is \(\lambda^+\)-saturated
    and \(\abs{M_{\lambda^+}}\le\kappa^\lambda=\kappa\)

    Let \(\caln=\bigcup\calm_\lambda\). Because \kappa is a regular limit cardinal, \(\kappa=\aleph_\kappa\). Thus because \kappa is regular,
    if \(A\subset N\) and \(\abs{A}<\kappa\), then there is \(\lambda<\kappa\) s.t. \(A\subset M_\lambda\). Thus,
    if \(p\in S_n^{\caln}(A)\), then \(p\) is realized in \(\calm_{\lambda^+}\prec\caln\)
    #+END_proof

    The assumption of regularity is necessary for some \(T\). For example, suppose that \(\calm\vDash\DLO\)
    with \(\abs{M}=\aleph_\omega\). We claim that \(\calm\) is not saturated. Let \(M=\bigcup_{n<\omega}M_n\)
    where \(\abs{M_n}=\aleph_n\). If \(\calm\) is saturated, then for each \(n<\omega\), we can find \(a_n\in M\)
    s.t. \(a_n>b\) for all \(b\in M_n\).

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.3.15
    Let \kappa be a regular cardinal. If \(T\) is \kappa-stable, then there is a saturated \(\calm\vDash T\)
    with \(\abs{M}=\kappa\). Indeed, if \(\calm_0\vDash T\) with \(\abs{M_0}=\kappa\), then there is a saturated
    elementary extension \(\calm\) of \(\calm_0\) with \(\abs{M}=\kappa\)

    In particular, if \(T\) is \omega-stable, then there are saturated models of size \kappa for all regular
    cardinals \kappa (Theorem ref:thm4.2.18)
    #+END_theorem

    #+BEGIN_proof
    We build an elementary chain \((\calm_\alpha:\alpha<\kappa)\) where \(\abs{\calm_\alpha}=\kappa\) s.t.
    1. \(\calm_0\vDash T\) with \(\abs{\calm_0}=\kappa\)
    2. \(\calm_\alpha=\bigcup_{\beta<\alpha}\calm_\beta\) for \alpha a limit ordinal
    3. \(\calm_\alpha\prec\calm_{\alpha+1}\) and if \(p\in S_1^{\calm_\alpha}(M_\alpha)\), then \(p\) is realized in \(\calm_{\alpha+1}\).


    Because \(T\) is \kappa-stable, if \(\abs{\calm_\alpha}=\kappa\), then \(\abs{S_1^{\calm_\alpha}(M_\alpha)}=\kappa\). Thus as in
    Theorem ref:thm4.3.12 we can find \(\calm_\alpha\prec\calm_{\alpha+1}\) s.t. \(\abs{M_{\alpha+1}}=\kappa\) and \(\calm_{\alpha+1}\)
    realizes all types in \(S_1^{\calm_\alpha}(M_\alpha)\).

    Let \(\calm=\bigcup\calm_\alpha\). Because \(\calm\) is the union of \kappa models of size \kappa, \(\abs{M}=\kappa\). We claim
    that \(\calm\) is saturated. Let \(A\subset M\) with \(\abs{A}<\kappa\). Because \kappa is regular, there is
    an \(\alpha<\kappa\) s.t. \(A\subseteq M_\alpha\). If \(p\in S_1^{\calm}(A)\), then there is \(q\in S_1^{\calm}(M_\alpha)=S_1^{\calm_\alpha}(M_\alpha)\)
    with \(p\subseteq q\). Because \(q\) is realized in \(\calm_{\alpha+1}\), \(p\) is realized in \(\calm\). Thus \(\calm\)
    is saturated.
    #+END_proof


*** Homogeneous and Universal Models
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    \(\calm\vDash T\) is *\kappa-universal* if for all \(\caln\vDash T\) with \(\abs{N}<\kappa\) there is an
    elementary embedding of \(\caln\) into \(\calm\)

    We say that \(\calm\) is *universal* if it is \(\abs{M}^+\)-universal
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma4.3.17
    Let \(\kappa\ge\aleph_0\). If \(\calm\) is \kappa-saturated, then \(\calm\) is \(\kappa^+\)-universal
    #+END_lemma

    #+BEGIN_proof
    Here, \(T\) at least should contain \(\Th(\calm)\)

    Let \(\caln\vDash T\) with \(\abs{N}\le\kappa\). Let \((n_\alpha:\alpha<\kappa)\) enumerate \(N\). Let \(A_\alpha=\{n_\beta:\beta<\alpha\}\). We
    build a sequence of partial elementary maps \(f_0\subset f_1\subset\cdots\subset f_\alpha\subset\cdots\) for \(\alpha<\kappa\) with \(f_\alpha:A_\alpha\to\calm\)

    Let \(f_0=\emptyset\). (Justification <<Problem6>>)

    And if \alpha is a limit ordinal, let \(f_\alpha=\bigcup_{\beta<\alpha}f_\beta\)

    Given \(f_\alpha:A_\alpha\to\calm\) partial elementary, let
    \begin{equation*}
    \Gamma(v)=\{\phi(v,f_\alpha(\bara)):\calm\vDash\phi(n_\alpha,\bara)\}
    \end{equation*}
    Because \(f_\alpha\) is partial elementary and \(\abs{A_\alpha}<\kappa\), \Gamma is satisfiable and, by
    \kappa-saturation, realized in some \(b\) in \(\calm\). The \(f_{\alpha+1}=f_\alpha\cup\{(n_\alpha,b)\}\) is the desired
    partial elementary map
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    Let \(\kappa\ge\aleph_0\). The following are equivalent
    1. \(\calm\) is \kappa-saturated
    2. \(\calm\) is \kappa-homogeneous and \(\kappa^+\)-universal


    If \(\kappa\ge\aleph_1\), 1 and 2 also equivalent to
    3. [@3] \(\calm\) is \kappa-homogeneous and \kappa-universal
    #+END_theorem

    #+BEGIN_proof
    By Proposition ref:prop4.3.3 and Lemma ref:lemma4.3.17, \(1\to 2\). Clearly \(2\to 3\)

    \(2\to 1\). Let \(A\subseteq M\) with \(\abs{A}<\kappa\), and let \(p\in S_1^{\calm}(A)\). We can find \(\caln\vDash\Th_A(\calm)\)
    s.t. \(A\subseteq N\) and there is \(a\in N\) realizing \(p\). If \(\kappa=\aleph_0\), then we can choose \(\caln\)
    with \(\abs{N}=\aleph_0\). If \(\kappa\ge\aleph_1\), then we choose \(\caln\) with \(\abs{N}<\kappa\). By assumption, there
    is an elementary embedding \(f:\caln\to\calm\). Because \(f|A\) is partial elementary, by \kappa-homogeneity,
    there is \(b\in M\) s.t.
    \begin{equation*}
    \tp^{\calm}(b/A)=\tp^{\calm}(f(a)/f(A))=\tp^{\caln}(a/A)=p
    \end{equation*}
    Thus \(\calm\) is \kappa-saturated

    Note that \(\caln\) is built on \(\call_A\).
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    \(\calm\) is saturated iff it is homogeneous and universal
    #+END_corollary

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    If \(\calm\) and \(\caln\) are saturated models of \(T\) of cardinality \kappa, then \(\calm\cong\caln\)
    #+END_theorem

    #+BEGIN_proof
    By Corollary ref:cor4.3.5 we may assume that \(\kappa\ge\aleph_1\). Let \((m_\alpha:\alpha<\kappa)\) enumerate \(\calm\)
    and \((n_\alpha:\alpha<\kappa)\) enumerate \(\caln\). We build a sequence of partial embeddings \(f_0\subset\cdots\subset f_\alpha\cdots\)
    for \(\alpha<\kappa\) s.t. \(m_\alpha\in\dom(f_{\alpha+1})\) and \(n_\alpha\in\im(f_{\alpha+1})\). Let \(A_\alpha\) denote the domain
    of \(f_\alpha\). We will have \(\abs{A_\alpha}\le\abs{\alpha}+\aleph_0<\kappa\) for all \alpha

    Let \(f_0=\emptyset\) <<Problem7>> WTF?


    #+END_proof

*** Vaught's Two-Cardinal Theorem
    \wu{Tent's is better on this topic😅}

    If \(\calm\) is an \(\call\)-structure and \(\phi(v_1,\dots,v_n)\) is an \(\call\)-formula, we
    let \(\phi(\calm)=\{\barx\in M^n:\calm\vDash\phi(\barx)\}\)

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \(\kappa>\lambda\ge\aleph_0\). We say that an \(\call\)-theory \(T\) has a *(\kappa,\lambda)-model* if there
    is \(\calm\vDash T\) and \(\phi(\barv)\) an \(\call\)-formula s.t. \(\abs{M}=\kappa\) and \(\abs{\phi(\calm)}=\lambda\)
    #+END_definition

    \((\kappa,\lambda)\)-models are an obstruction to \kappa-categoricity. If \(T\) is a theory in a countable
    language with infinite models, then an easy compactness argument shows that there is \(\calm\vDash T\) of
    cardinality \kappa where every \(\emptyset\)-definable subsets of \(\calm\) has cardinality \kappa.
    #+LATEX: \wu{
    Guess add \kappa constants, and partition constants into \omega groups of \kappa constants. This is finitely satisfiable.
    #+LATEX: }
    If \(T\) also has a \((\kappa,\lambda)\)-model,
    then \(T\) is not \kappa-categorical. Out main goal is the following theorem of Vaught

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.3.34
    If \(T\) has a \((\kappa,\lambda)\)-model where \(\kappa>\lambda\ge\aleph_0\), then \(T\) has an \((\aleph_1,\aleph_0)\)-model
    #+END_theorem

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say that \((\caln,\calm)\) is a *Vaughtian pair* of models of \(T\) if \(\calm\prec\caln\), \(M\neq N\) and there is
    an \(\call_M\)-formula \phi s.t. \(\phi(\calm)\) is infinite and  \(\phi(\calm)=\phi(\caln)\)
    #+END_definition

    For example, if \(\calm\) and \(\caln\) are nonstandard models of Peano arithmetic and \(\caln\) is a proper
    elementary end extension of \(\calm\), then \((\caln,\calm)\) is a Vaughtian pair. If \(a\) is any infinite
    element of \(\calm\), then the formula \(v<a\) defines an infinite set containing no elements
    of \(N\setminus M\)

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    If \(T\) has a \((\kappa,\lambda)\)-model where \(\kappa>\lambda\ge\aleph_0\), then there is \((\caln,\calm)\) a Vaughtian pair of
    models of \(T\)
    #+END_lemma

    #+BEGIN_proof
    Let \(\caln\) be a \((\kappa,\lambda)\)-model. Suppose that \(X=\phi(\caln)\) has cardinality \lambda. By the
    Löwenheim–Skolem Theorem, there is \(\calm\prec\caln\) s.t. \(X\subseteq M\) and \(\abs{M}=\lambda\).
    #+END_proof

    We would like to show that if there is a Vaughtian pair, then there is a Vaughtian pair of
    countable models.

    Let \(\call^*=\call\cup\{U\}\), where \(U\) is a unary predicate symbol. If \(\calm\subseteq\caln\) are \(\call\)-structures, we
    consider the pair \((\caln,\calm)\) as an \(\call^*\)-structure by interpreting \(U\) as \(M\)

    If \(\phi(v_1,\dots,v_n)\) is an \(\call\)-formula, we define \(\phi^U(\barv)\), the restriction of \phi to \(U\),
    inductively as follows:
    1. if \phi is atomic, then \(\phi^U\) is \(U(v_1)\wedge\dots\wedge U(v_n)\wedge\phi\)
    2. if \phi is \(\neg\psi\), then \(\phi^U\) is \(\neg\psi^U\)
    3. if \phi is \(\psi\wedge\theta\), then \(\phi^U\) is \(\psi^U\wedge\theta^U\)
    4. if \phi is \(\exists v\;\psi\), then \(\phi^U\) is \(\exists v\;U(v)\wedge\psi^U\)


    If \(\calm\subset\caln\), \(\bara\in M^k\) and we view \((\caln,\calm)\) as an \(\call^*\)-structure, then \(\calm\vDash\phi(\bara)\)
    iff \((\caln,\calm)\vDash\phi^U(\bara)\)

    guess \(U(v)\) iff \(v\in M\).

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma4.3.37
    If \((\caln,\calm)\) is a Vaughtian pair for \(T\), then there is a Vaughtian pair \((\caln_0,\calm_0)\)
    where \(\caln_0\) is countable
    #+END_lemma

    #+BEGIN_proof
    Let \phi be an \(\call_M\)-formula s.t. \(\phi(\calm)\) is infinite and \(\phi(\calm)=\phi(\caln)\). Let \(\barm_0\) be the
    parameters from \(M\) occuring in \phi. By the Löwenheim–Skolem Theorem, there is \((\caln_0,\calm_0)\) a
    countable \(\call^*\)-structure s.t. \(\barm\in M_0\) and \((\caln_0,\calm_0)\prec(\caln,\calm)\). Because \(\calm\prec\caln\), for
    any formula \(\psi(v_1,\dots,v_k)\)
    \begin{equation*}
    (\caln,\calm)\vDash\forall\barv\left( \left( \bigwedge_{i=1}^kU(v_i)\wedge\psi(\barv) \right)\to\psi^U(\barv) \right)
    \end{equation*}
    Because \((\caln_0,\calm_0)\prec(\caln,\calm)\), these sentences are also true in \((\caln_0,\calm_0)\), so \(\calm_0\prec\caln_0\)
    (Tarski's test)

    Let \(\phi(\barv)\) be an \(\call_M\)-formula with infinitely (maybe some restrictions) many realizations in \(\calm\) and none
    in \(\caln\setminus\calm\)., witnessing that \((\caln,\calm)\) is a Vaughtian pair. For each \(k\), the sentences
    \begin{equation*}
    \exists\barv_1\dots\exists\barv_k\;\left( \bigwedge_{i<j}\barv_i\neq\barv_j\wedge\bigwedge_{i=1}^k\phi(\barv_i) \right)
    \end{equation*}
    hold in \((\caln,\calm)\), as do the sentences \(\exists x\;\neg U(x)\) and
    \begin{equation*}
    \forall\barv\;(\phi(\barv)\to\bigwedge U(v_i))
    \end{equation*}
    Because these sentences also hold in \((\caln_0,\calm_0)\), this structure is also a Vaughtian pair.
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    Suppose that \(\calm_0\prec\caln_0\) are countable models of \(T\). We can find \((\caln_0,\calm_0)\prec(\caln,\calm)\)
    s.t. \(\caln\) and \(\calm\) are countable, homogeneous, and realize the same types in \(S_n(T)\). By
    Theorem ref:thm4.2.15 \(\calm\cong\caln\)
    #+END_lemma

    #+BEGIN_proof
    *Claim 1* If \(\bara\in M_0\) and \(p\in S_n(\bara)\), then there is \((\caln_0,\calm_0)\prec(\caln',\calm')\) s.t. \(p\) is
    realized in \(\calm'\) (as \(\calm_0\prec\caln_0\), so \(S_n^{\calm_0}(\bara)=S_n^{\caln_0}(\bara)\))

    Let \(\Gamma(\barv)=\{\phi^U(\barv,\bara):\phi(\barv,\bara)\in p\}\cup\Diag_{\el}(\caln_0,\calm_0)\) (ensures \(\calm_0\prec\caln_0\)). If \(\phi_1,\dots,\phi_m\in p\),
    then \(\caln_0\vDash\exists\barv\bigwedge\phi_i(\barv,\bara)\) as \(\exists\barv\bigwedge\phi_i\in p\), thus \(\calm_0\vDash\exists\barv\bigwedge\phi_i(\barv,\bara)\)
    and \((\caln_0,\calm_0)\vDash\exists\barv\bigwedge\phi_i^U(\barv,\bara)\). Thus \(\Gamma(\barv)\) is satisfiable. Let \((\caln',\calm')\) be
    a countable elementary extension realizing \Gamma.

    By iterating Claim 1, we can find \((\caln_0,\calm_0)\prec(\caln^*,\calm^*)\) countable s.t. if \(\bara\in M_0\)
    and \(p\in S_n(\bara)\), then \(p\) is realized in \(\calm^*\)

    *Claim 2* If \(\barb\in N_0\) and \(p\in S_n(\barb)\), then there is \((\calm_0,\caln_0)\prec(\caln',\calm')\) s.t. \(p\)
    is realized in \(\caln'\)

    Let \(\Gamma(\barv)=p\cup\Diag_{\el}(\caln_0,\calm_0)\). If \(\phi_1,\dots,\phi_m\in p\), then \(\caln_0\vDash\exists\barv\bigwedge_i(\barv,\barb)\);
    thus we can find a countable elementary extension of \((\caln_0,\calm_0)\) realizing \(p\).

    We build an elementary chain of countable models
    \begin{equation*}
    (\caln_0,\calm_0)\prec(\caln_1,\calm_1)\prec\cdots
    \end{equation*}
    s.t.
    1. if \(p\in S_n(T)\) is realized in \(\caln_{3i}\), then \(p\) is realized in \(\calm_{3i+1}\)
    2. if \(\bara,\barb,c\in\calm_{3i+1}\) and \(\tp^{\calm_{3i+1}}(\bara)=\tp^{\calm_{3i+1}}(\barb)\), then there
       is \(d\in M_{3i+2}\) s.t. \(\tp^{\calm_{3i+2}}(\bara,c)=\tp^{\calm_{3i+2}}(\barb,d)\)
    3. if \(\bara,\barb,c\in\caln_{3i+2}\) and \(\tp^{\caln_{3i+2}}(\bara)=\tp^{\caln_{3i+2}}(\barb)\), then there
       is \(d\in N_{3i+3}\) s.t. \(\tp^{\caln_{3i+3}}(\bara,c)=\tp^{\caln_{3i+3}}(\barb,d)\)


    1 and 2 are done by using the first claim, 3 is done by the second claim.

    Let \((\caln,\calm)=\bigcup_{i<\omega}(\caln_i,\calm_i)\). Then \((\caln,\calm)\) is a countable Vaughtian pair. By 1, \(\calm\)
    and \(\caln\) realize the sames types. By 2 and 3, \(\calm\) and \(\caln\) are homogeneous
    #+END_proof

    #+ATTR_LATEX: :options [Proof of \ref{thm4.3.34}]
    #+BEGIN_proof
    Suppose that \(T\) has a \((\kappa,\lambda)\)-model. By the lemmas above, we can find \((\caln,\calm)\) a countable
    Vaughtian pair s.t. \(\calm\) and \(\caln\) are homogeneous models realizing the same types.
    Let \(\phi(\barv)\) be an \(\call_M\)-formula with infinitely many realizations in \(M\) and none
    in \(N\setminus M\).

    We build an elementary chain \((\caln_\alpha:\alpha<\omega_1)\), each \(\caln_\alpha\) is isomorphic to \(\caln\)
    and \((\caln_{\alpha+1},\caln_\alpha)\cong(\caln,\calm)\). In particular, \(N_{\alpha+1}\setminus N_\alpha\) contains no elements satisfying
    \phi

    Let \(\caln_0=\caln\). For \alpha a limit ordinal, let \(\caln_\alpha=\bigcup_{\beta<\alpha}\caln_\beta\). Because \(\caln_\alpha\) is a union of models
    isomorphic to \(\caln\), \(\caln_\alpha\) is homogeneous and realizes the same types as \(\caln\) so \(\caln_\alpha\cong\caln\) by
    Theorem ref:thm4.2.15 (interesting)

    Given \(\caln_\alpha\cong\caln\), because \(\caln\cong\calm\) there is \(\caln_{\alpha+1}\) an elementary extension of \(\caln_\alpha\)
    s.t. \((\caln,\calm)\cong(\caln_{\alpha+1},\caln_\alpha)\). Clearly \(\caln_{\alpha+1}\cong\caln_\alpha\). <<Problem8>>
    #+LATEX: \wu{
    Extend \(f:\calm\cong\caln_\alpha\) to \(f':\caln\cong\caln_{\alpha+1}\)
    #+LATEX: }

    Let \(\caln^*=\bigcup_{\alpha<\omega_1}\caln_\alpha\). Then \(\abs{N^*}=\aleph_1\) and if \(\caln^*\vDash\phi(\bara)\), then \(\bara\in M\);
    thus \(\calm^*\) is an \((\aleph_1,\aleph_0)\)-model
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    If \(T\) is \(\aleph_1\)-categorical, then \(T\) has no Vaughtian pairs and hence no \((\kappa,\lambda)\) models
    for \(\kappa>\lambda\ge\aleph_0\).
    #+END_corollary

    If \(T\) is \omega-stable, we can prove a partial converse to Vaught's Theorem

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    Suppose that \(T\) is \omega-stable, \(\calm\vDash T\), and \(\abs{M}\ge\aleph_1\). There is a proper elementary
    extension \(\caln\) of \(\calm\) s.t. if \(\Gamma(\barw)\) is a countable type over \(M\) realized in \(\caln\),
    then \(\Gamma(\barw)\) is realized in \(\calm\)
    #+END_lemma

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.3.41
    Suppose that \(T\) is \omega-stable and there is an \((\aleph_1,\aleph_0)\)-model of \(T\). If \(\kappa>\aleph_1\), then
    there is a \((\kappa,\aleph_0)\)-model of \(T\).
    #+END_theorem

** The Number of Countable Models
    \(T\) a complete theory in a countable language with infinite models

    For any infinite cardinal \kappa, we let \(I(T,\kappa)\) be the number of nonisomorphic model of \(T\) of
    cardinality \kappa

    \(I(\DLO,\aleph_0)=1\)
*** \texorpdfstring{\(\aleph_0\)}{ℵ0}-categorical Theories
    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm4.4.1
    The following are equivalent
    1. \(T\) is \(\aleph_0\)-categorical
    2. Every type in \(S_n(T)\) is isolated for \(n<\omega\)
    3. \(\abs{S_n(T)}<\aleph_0\) for all \(n<\omega\)
    4. For each \(n<\omega\), there is a finite list of formulas
       \begin{equation*}
       \phi_1(v_1,\dots,v_n),\dots,\phi_m(v_1,\dots,v_n)
       \end{equation*}
       s.t. for every formula \(\psi(v_1,\dots,v_n)\)
       \begin{equation*}
       T\vDash\phi_i(\barv)\leftrightarrow\psi(\barv)
       \end{equation*}
       for some \(i\le m\)
    #+END_theorem

    #+BEGIN_proof
    \(1\to 2\). If \(p\in S_n(T)\) is nonisolated, then there is a countable \(\calm\vDash T\) omitting \(p\).
    There is also a countable \(\caln\vDash T\) realizing \(p\): as \(p\cup T\) is satisfiable,
    let \(\caln\vDash p(n)\cup T\) and consider language \(\call(c)\). Then by LST, we can get a countable
    elementary substructure \(\caln'\) of \(\caln\). Clearly \(\calm\not\cong\caln\)

    \(2\to 3\). Suppose that \(S_n(T)\) is infinite. For each \(p\in S_n(T)\), let \(\phi_p\)
    isolates \(p\). Because \(\bigcup_{p\in S_n(T)}[\phi_p]=S_n(T)\) and \(S_n(T)\) is compact, there
    are \(p_1,\dots,p_m\) s.t \([\phi_{p_1}]\cup\cdots\cup[\phi_{p_m}]=S_n(T)\). Because \([\phi_p]=\{p\}\), \(S_n(T)\) is
    finite

    \(3\to 4\). for each \(i\), we can find a formula \(\theta_i\) s.t. \(\theta_i\in p_i\) and \(\neg\theta_i\in p_j\)
    for \(i\neq j\) (e.g. \(\neg\psi_1\wedge\cdots\wedge\neg\psi_{i-1}\wedge\psi_i\wedge\neg\psi_{i+1}\wedge\cdots\wedge\psi_n\)). Then \(\theta_i\) isolates \(p_i\). For any
    formula \(\psi(v_1,\dots,v_n)\)
    \begin{equation*}
    T\vDash\psi(\barv)\leftrightarrow\bigvee_{\psi\in p_i}\theta_i
    \end{equation*}
    Thus each \psi with free variables \(v_1,\dots,v_n\) is equivalent to \(\bigvee_{i\in S}\theta_i\) for
    some \(S\subseteq\{1,\dots,m\}\). There are at most \(2^m\) such formulas.

    \(4\to 1\). Let \(\calm\) be a countable model of \(T\). If \(\bara\in M^n\),
    let \(S_{\bara}=\{i\le m:\calm\vDash\phi_i(\bara)\}\). Then \(\tp^{\calm}(\bara)\) is isolated by
    \begin{equation*}
    \bigwedge_{i\in S_{\bara}}\phi_i(\barv)\wedge\bigwedge_{i\notin S_{\bara}}\neg\phi(\barv)
    \end{equation*}
    Thus \(\calm\) is atomic and hence by Theorem ref:thm4.2.8 prime. Because there is a unique prime
    model, \(T\) is \(\aleph_0\)-categorical
    #+END_proof

    [[index:algebraic]]
    \(b\) is *algebraic over* \(A\) if there is a formula \(\phi(v,\barw)\) and \(\bara\in A\)
    s.t. \(\calm\vDash\phi(b,\bara)\) and \(\{x\in M:\calm\vDash\phi(x,\bara)\}\) is finite.
    Also, \(\acl(A)=\{b\in A:b\text{ is algebraic over }A\}\)

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor4.4.2
    Suppose that \(T\) is \(\aleph_0\)-categorical. There is a function \(f:\N\to\N\) s.t.
    if \(\calm\vDash T\), \(A\subset M\) and \(\abs{A}\le n\), then \(\abs{\acl(A)}\le f(n)\)
    #+END_corollary

    #+BEGIN_proof
    By Theorem ref:thm4.4.1, \(\abs{S_{n+1}(T)}\) is finite. Let \(q_1,\dots,q_k\) list
    all \(n+1\)-types. Let
    \begin{align*}
    X=\Big\{&i:q_i\text{ contains a formula }\phi(v,\barw)\text{ s.t. for some }N\\
    &\calm\vDash\forall v_0,\dots,v_N\left(\bigwedge_{i=0}^N\phi(v_i,\barw)\to\bigvee_{i<j\le N}v_i=v_j\right)\Big\}
    \end{align*}
    For \(i\in X\), let \(N_i\) be the least \(N\) s.t. for some formula \phi
    \begin{equation*}
    \forall v_0,\dots,v_N\left(\bigwedge_{i=0}^N\phi(v_i,\barw)\to\bigvee_{i<j}v_i=v_j \right)
    \end{equation*}
    is in \(q_i\).

    If \(a,b_1,\dots,b_n\in M\) and \(a\) is algebraic over \(\barb\), then \((a,\barb)\) realizes
    some \(q_i\in X\) and \(\abs{\{x:(x,\barb)\text{ realizes }q_i\}}\le N_i\). Thus
    \begin{equation*}
    \abs{\acl(b_1,\dots,b_n)}\le\sum_{i\in X}N_i
    \end{equation*}
    Let
    \begin{equation*}
    f(n)=\sum_{i\in X}N_i
    \end{equation*}
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    If \(F\) is an infinite field, then the theory of \(F\) is not \(\aleph_0\)-categorical
    #+END_corollary

    #+BEGIN_proof
    By compactness, we can find an elementary extension \(K\) of \(F\) s.t. \(K\) contains a
    transcendental element \(t\). Because \(t,t^2,t^3,\dots\)  are distinct, \(\acl(t)\) is infinite.
    Thus, by Corollary ref:cor4.4.2 \(\Th(F)\) is not \(\aleph_0\)-categorical
    #+END_proof

    A group \(G\) is *locally finite* if for any finite \(X\subseteq G\), the subgroup generated by \(X\) is
    finite

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    Let \(G\) be an infinite group
    1. if \(\Th(G)\) is \(\aleph_0\)-categorical, then \(G\) is locally finite. Moreover, there is a
       number \(b\) s.t. if \(g\in G\), then \(g^n=1\) for some \(n\le b\) (we say that \(G\) has
       *bounded exponent*)
    2. if \(G\) is an infinite Abelian group of bounded exponent, then \(\Th(G)\)
       is \(\aleph_0\)-categorical
    #+END_corollary

    #+BEGIN_proof
    1. By Corollary ref:cor4.4.2 there is a function \(f:\N\to\N\) s.t. if \(\abs{X}\le n\), the group
        generated by \(X\) has size at most \(f(n)\). We need to justify that the group generated
       by \(X\) is the \(\acl(X)\). But in \(X\), we can only TALK about the elements generated
       by \(X\). So \(\abs{(X)}\le\abs{\acl{X}}\)

        In particular, if \(g\in G\), then \(g^n=1\) for
       some \(n\le f(1)\).
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma4.4.5
    Let \(\kappa\ge\aleph_0\). Let \(A\subset M\) with \(\abs{A}<\kappa\). Let \(\calm_A\) be the \(\call_A\)-structure obtained
    from \(\calm\) by interpreting the new constant symbols in the natural way. If \(\calm\) is \kappa-saturated,
    then so is \(\calm_A\)
    #+END_lemma

    #+BEGIN_proof
    For all \(B\subseteq M\), if \(\abs{B}<\kappa\) and \(p\in S_n^{\calm_A}(B)\), note
    that \(S_n^{\calm}(A,B)=S_n^{\calm_A}(B)\). For \(p\) is actually \(p(\barx,\barb,\bara)\)
    and \(p(\barx,\barb,\bara)\cup\Th(\calm_A)\) means \(p(\barx,\barb,\bara)\cup\Diag_{\el}(\calm)\) is
    satisfiable. Hence \(p\in S_n^{\calm}(A,B)\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    \(I(T,\aleph_0)\neq 2\)
    #+END_theorem

    #+BEGIN_proof
    Suppose that \(I(T,\aleph_0)=2\). By Corollary ref:cor4.3.8 (2), there is \(\caln\) a prime model
    of \(T\) and \(\calm\) a countable saturated model of \(T\). Because \(T\) is
    not \(\aleph_0\)-categorical, by Theorem ref:thm4.4.1, there is a nonisolated type \(p\in S_n(T)\) for
    some \(n\). The type is realized in \(\calm\) and omitted in \(\caln\). Let \(\bara\in M\) realize \(p\).
    Let \(T^*\) be the \(\call_{\bara}\)-theory of \(\calm_{\bara}\)

    By Theorem ref:thm4.4.1, there are infinitely many \(T\)-inequivalent formulas in the free
    variables \(v_1,\dots,v_n\). As they are still \(T^*\)-inequivalent, \(T^*\) is
    not \(\aleph_0\)-categorical. By Lemma ref:lemma4.4.5, \(\calm_{\bara}\) is a
    saturated \(\call_{\bara}\)-structure. Thus by Corollary ref:cor4.3.8 (1), \(T^*\) has a countable
    atomic model \(\cala\). Let \(\calb\) denote the \(\call\)-reduct of \(\calb\). Because \(\cala\vDash T^*\), \(\calb\)
    contains a realization of \(p\), thus \(\calb\not\cong\caln\). Because \(T^*\) is not \(\aleph_0\)-categorical,
    there is a nonisolated \(\call_{\bara}\)-type. This type is not realized in \(\cala\). Thus \(\cala\) is not
    saturated. If \(\calb\) were saturated, then by Lemma ref:lemma4.4.5 \(\cala\) would be saturated.
    Thus \(\calb\not\cong\calm\) and \(I(T,\aleph_0)\ge 3\).
    #+END_proof
*** Morley's Analysis of Countable Models
    Next we prove Morley's theorem that if \(I(T,\aleph_0)>\aleph_1\), then \(I(T,\aleph_0)=2^{\aleph_0}\)
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    A *fragment* of \(\call_{\omega_1,\omega}\) is a set of \(\call_{\omega_1,\omega}\)-formulas containing all first-order formulas
    and closed under subformulas, finite Boolean combinations, quantification, and change of free
    variables

    If \(F\) is a fragment of \(\call_{\omega_1,\omega}\), we say that \(\calm\equiv_F\caln\) if
    \begin{equation*}
    \calm\vDash\phi \quad\text{ iff }\quad\caln\vDash\phi
    \end{equation*}
    for all sentences \(\phi\in F\)

    If \(F\) is a fragment of \(\call_{\omega_1,\omega}\), we say that \(p\subset F\) is an *\(F\)-type* if there is
    countable \(\call\)-structure \(\calm\) and \(a_1,\dots,a_n\in M\) s.t. \(p=\{\phi(v_1,\dots,v_n)\in F:\calm\vDash\phi(\bara)\}\).
    Let \(S_n(F,T)\) be the set of all \(F\)-types realized by some \(n\)-tuples in some countable
    model of \(T\)
    #+END_definition

** Exercise
    \(\call\) is countable and \(T\) is an \(\call\)-theory with only infinite models
    #+BEGIN_exercise
    label:ex4.5.1
    1. Let \(\calm=(X,<)\) be a dense linear order, let \(A\subset M\) and \(\barb,\barc\in M^n\)
       with \(b_1<\cdots<b_n\) and \(c_1<\cdots<c_n\). Show that \(\tp^{\calm}(\barb/A)=\tp^{\calm}(\barc/A)\)
       iff \(b_i<a\Leftrightarrow c_i<a\)  and \(b_i>a\Leftrightarrow c_i>a\) for all \(i=1,\dots,n\) and \(a\in A\). In particular, show
       that any two elements of \(X\) realize the same 1-type over \(\emptyset\)
    2. If \(a,b\in\Q\), then \(\tp^{\Q}(a/\N)=\tp^{\Q}(b/\N)\) iff there is an automorphism \sigma of \(\Q\)
       fixing \(N\) pointwise with \(\sigma(a)=b\)
    3. Let \(A=\{1-\frac{1}{n}:n=1,2,\dots\}\cup\{2+\frac{1}{n}:n=1,2,\dots\}\). Show that \(1\) and \(2\) realize
       the same type over \(A\), but there is no automorphism of \(\Q\) fixing \(A\) pointwise
       sending 1 to 2
    #+END_exercise

    #+BEGIN_proof
    1. Let \(f:A\cup\{\barb\}\mapsto A\cup\{\barc\}\) s.t. \(f(\barb)=\barc\). We can build an automorphism
       extending \(f\) by back-and-forth.
    2. \(\Rightarrow\). Note that \(\DLO\) is \omega-categorical, thus we can get one by Proposition ref:prop4.1.5
       and Löwenheim–Skolem Theorem.
    3. From 1
    #+END_proof

    #+BEGIN_exercise
    label:ex4.5.2
    Let \(T\) be the theory of \((\Z,s)\) where \(s(x)=x+1\). Determine the types in \(S_n(T)\) for
    each \(n\). Which types are isolated? Do the same for \((\Z,<,s)\)
    #+END_exercise

    #+BEGIN_proof
    By Exercise ref:ex3.4.3, \(T\) has quantifier elimination. Thus every formula is like
    \begin{equation*}
    \bigvee\left(\bigwedge s^{m_i}(x_i)=s^{n_i}(y_i)\wedge\bigwedge s^{m_i'}(x_i')\neq s^{n_i'}(y_i')\right)
    \end{equation*}

    At least three \(+\infty\), \(-\infty\)
    #+END_proof

    #+BEGIN_exercise
    label:ex4.5.4
    Suppose that \(\calm\) is an \(\call\)-structure, \(A\subseteq M\), \(b\in M\) and \(b\) is algebraic over \(A\).
    Show that \(\tp^{\calm}(b/A)\) is isolated
    #+END_exercise

    #+BEGIN_proof
    Let \varphi be the  \(L(A)\)-formula realised by \(b\) having least possible solutions in \(\calm\). We
    claim that \(\varphi(x)\) isolates \(\tp^{\calm}(b/A)\)

    For any \(\psi(x)\in\tp^{\calm}(b/A)\),
    as \(\abs{\varphi(\fM)}\) is least, \(\varphi(\fM)=\varphi(\fM)\wedge\psi(\fM)\).

    #+END_proof

    #+BEGIN_exercise
    label:ex4.5.10
    Suppose that \(A\subseteq B\), \(\theta(\barv)\) is a formula with parameters from \(A\), and \theta
    isolates \(\tp^{\calm}(\bara/B)\). Then \theta isolates \(\tp^{\calm}(\bara/A)\)
    #+END_exercise

    #+BEGIN_proof
    TRIVIAL as \(A\subseteq B\)
    #+END_proof

    #+BEGIN_exercise
    label:ex4.5.11
    Suppose that \(A\subset M\), \(\bara,\barb\in M\) s.t. \(\tp^{\calm}(\bara,\barb/A)\) is isolated. Show
    that \(\tp^{\calm}(\bara/A,\barb)\) is isolated
    #+END_exercise

    #+BEGIN_proof
    Suppose \(\theta(\barv,\barw)\) isolates \(\tp^{\calm}(\bara,\barb/A)\). Then for each \(\phi(\barv,\barw)\in\tp^{\calm}(\bara,\barb/A)\)
    \begin{equation*}
    \Th(\calm_A)\vDash\forall\barv\forall\barw(\theta(\barv,\barw)\to\phi(\barv,\barw))
    \end{equation*}

    For each \(\psi(\barv)\in\tp^{\calm}(\bara/A,\barb)\)
    #+END_proof

    #+BEGIN_exercise
    label:ex4.5.34
    Suppose that \(\calm\) is \kappa-saturated, and \((\phi_i(\barv):i\in I)\) and \((\theta_j(\barv):j\in J)\) are
    sequences of \(\call_M\)-formulas s.t. \(\abs{I},\abs{J}<\kappa\) and
    \begin{equation*}
    \calm\vDash\bigvee_{i\in I}\phi_i(\barv)\leftrightarrow\neg\left( \bigvee_{j\in J}\theta_j(\barv) \right)
    \end{equation*}
    Show that there are finite sets \(I_0\subseteq I\) and \(J_0\subseteq J\) s.t.
    \begin{equation*}
    \calm\vDash\bigvee_{i\in I}\phi_i(\barv)\leftrightarrow\bigvee_{i\in I_0}\phi_i(\barv)
    \end{equation*}
    #+END_exercise

    #+BEGIN_proof

    #+END_proof

* Indiscernibles
** Partition Theorems
    For \(X\) a set and \kappa,\lambda (possibly finite) cardinals, we let \([X]^\kappa\) be the collection of all
    subsets of \(X\) of size \kappa. We call \(f:[X]^\kappa\to\lambda\) a *partition* of \([X]^\kappa\). We say
    that \(Y\subseteq X\) is *homogeneous* for the partition \(f\) if there is \(\alpha<\lambda\) s.t. \(f(A)=\alpha\) for
    all \(A\in[Y]^\kappa\) (i.e. \(f\) is a constant on \([Y]^\kappa\)). Finally, for cardinals \kappa,\eta,\mu, and \lambda, we
    write \(\kappa\to(\eta)_\lambda^\mu\) if whenever \(\abs{X}>\kappa\) and \(f:[X]^\mu\to\lambda\), then there is \(Y\subseteq X\)
    s.t. \(\abs{Y}\ge\eta\) and \(Y\) is homogeneous for \(f\)

    #+ATTR_LATEX: :options [Ramsey's Theorem]
    #+BEGIN_theorem
    If \(k,n<\omega\), then \(\aleph_0\to(\aleph_0)^n_k\)
    #+END_theorem

    Some applications:

    Any sequence of real numbers \((r_0,r_1,\dots)\) has a monotonic subsequence. Let \(f:[\N]^2\to 3\) by
    \begin{equation*}
    f(\{i,j\})=
    \begin{cases}
    0&i<j\text{ and }r_i<r_j\\
    1&i<j\text{ and }r_i=r_j\\
    2&i<j\text{ and }r_i>r_j
    \end{cases}
    \end{equation*}
    By Ramsey's Theorem, there is \(Y\subseteq N\) an infinite homogeneous set for \(f\). Let \(j_0<j_1<\dots\)
    list \(Y\). There is \(c<3\) s.t. \(f(\{j_m,j_n\})=c\) for \(m<n\).

    Suppose \(G\) is an infinite graph. Let \(f:[G]^2\to 2\) by
    \begin{equation*}
    f(\{a,b\})=
    \begin{cases}
    1&(a,b)\text{ is an edge of }G\\
    0&(a,b)\text{ is not an edge of }G
    \end{cases}
    \end{equation*}
    By Ramsey's Theorem, there is an infinite \(H\subseteq G\) homogeneous for \(f\). If \(f\) is constantly
    1 on \([H]^2\), then \(H\) is a complete subgraph, and if \(f\) is constantly 0, there are no
    edges.

    #+BEGIN_proof
    Induction on \(n\). For \(n=1\) Ramsey's Theorem asserts that if \(X\) is infinite, \(k<\omega\),
    and \(f:X\to k\), then \(f^{-1}(i)\) is infinite for some \(i<k\). This is just the Pigeonhole
    Principle.

    Suppose that we have proved that if \(i<n\), \(k<\omega\), \(X\) is infinite, and \(f:[X]^i\to k\), then
    there is an infinite \(Y\subseteq X\) homogeneous for \(f\).

    We could always replace \(X\) by a countable subset of \(X\); thus, W.L.O.G., we may assume
    that \(X=\N\).

    Let \(f:[\N]^n\to k\). For \(a\in\N\), let \(f_a:[\N\setminus\{a\}]^{n-1}\to k\) by \(f_a(A)=f(A\cup\{a\})\). We build a
    sequence \(0=a_0<a_1<\dots\) in \(\N\) and \(\N=X_0\supset X_1\supset\dots\) a sequence of infinite sets as follows.
    Given \(a_i\) and \(X_i\), let \(X_{i+1}\subset X_i\setminus\{0,1,\dots,a_i\}\) be homogeneous for \(f_{a_i}\).
    Let \(a_{i+1}\) be the least element of \(X_{i+1}\)

    Let \(c_i<k\) be s.t. \(f_{a_i}(A)=c_i\) for all \(A\in[X_{i+1}]^{n-1}\). By the Pigeonhole
    Principle, there is \(c<k\) s.t. \(\{i:c_i=c\}\) is infinite. Let \(X=\{a_i:c_i=c\}\). We claim
    that \(X\) is homogeneous for \(f\). Let \(x_1<\dots<x_n\) where each \(x_i\in X\), there is an \(i\)
    s.t. \(x_1=a_i\) and \(x_2,\dots,x_n\in X_i\). Thus
    \begin{equation*}
    f(\{x_1,\dots,x_n\})=f_{x_1}(\{x_2,\dots,x_n\})=c_i=c
    \end{equation*}
    and \(X\) is homogeneous for \(f\).
    #+END_proof

    #+ATTR_LATEX: :options [Finite Ramsey Theorem]
    #+BEGIN_theorem
    For all \(k,n,m<\omega\), there is \(l<\omega\) s.t. \(l\to(m)^n_k\)
    #+END_theorem

    #+BEGIN_proof
    Suppose that there is no \(l\) s.t. \(l\to (m)_k^n\). For each \(l<\omega\),
    let
    \begin{align*}
    T_l=\{&f:[\{0,\dots,l-1\}]^n\to k:\text{ there is no }X\subseteq\{0,\dots,l-1\}\\
    &\text{ of size at least }m, \text{ homogeneous for }f
    \end{align*}
    Clearly each \(T_l\) is finite since \(n\) and \(k\) are finite. if \(f\in T_{l+1}\) there is a
    unique \(g\in T_l\) s.t. \(g\subset f\). Thus if we order \(T=\bigcup T_l\) by inclusion, we get a finite
    branching tree. Each \(T_l\) is not empty, so \(T\) is an infinite finite branching tree. By
    Kőnig's Lemma (Lemma ref:lemmaA.21) we can find \(f_0\subset f_1\subset f_2\dots\) with \(f_i\in T_i\)

    Let \(f=\bigcup f_i\). Then \(f:[\N]^n\to k\). By Ramsey's Theorem, there is an infinite \(X\subseteq\N\)
    homogeneous for \(f\). Let \(x_1,\dots,x_m\) be the first \(m\) elements of \(X\) and let \(s>x_m\).
    Then \(\{x_1,\dots,x_m\}\) is homogeneous for \(f_s\), a contradiction
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    \(2^{\aleph_0}\slashed{\to}(3)^2_{\aleph_0}\)
    #+END_proposition

    #+BEGIN_proof
    We define \(F:[2^\omega]^2\to\omega\) by \(F(\{f,g\})\) is the least \(n\) s.t. \(f(n)=g(n)\). Clearly, we
    cannot find \(\{f,g,h\}\) s.t. \(f(n)\neq g(n)\), \(g(n)\neq h(n)\) and \(f(n)\neq h(n)\)
    #+END_proof

    On the other hand, if \(\kappa>2^{\aleph_0}\), then \(\kappa\to(\aleph_1)_{\aleph_0}^2\). This is the special case of an
    important generalization of Ramsey's Theorem. For \kappa an infinite cardinal and \alpha an ordinal, we
    inductively define \(\beth_\alpha(\kappa)\) by \(\beth_0(\kappa)=\kappa\) and
    \begin{equation*}
    \beth_\alpha(\kappa)=\sup_{\beta<\alpha}2^{\beth_\beta(\kappa)}
    \end{equation*}
    In particular, \(\beth_1(\kappa)=2^\kappa\). We let \(\beth_\alpha=\beth_\alpha(\aleph_0)\). Under the Generalized Continuum
    Hypothesis, \(\beth_\alpha=\aleph_\alpha\)

    #+ATTR_LATEX: :options [Erdős–Rado theorem]
    #+BEGIN_theorem
    \(\beth_n(\kappa)^+\to(\kappa^+)_\kappa^{n+1}\)
    #+END_theorem

    #+BEGIN_proof
    Induction on \(n\). For \(n=0\), \(\kappa^+\to(\kappa^+)^{n+1}_\kappa\) is just the Pigeonhole Principle

    Suppose that we have proved the theorem for \(n-1\). Let \(\lambda=\beth_n(\kappa)^+\), and
    let \(f:[\lambda]^{n+1}\to\kappa\). For \(\alpha<\lambda\), let \(f_\alpha:[\lambda\setminus\{\alpha\}]^n\to\kappa\) by \(f_\alpha(A)=f(A\cup\{\alpha\})\).

    We build \(X_0\subseteq X_1\subseteq\dots\subseteq X_\alpha\subseteq\dots\) for \(\alpha<\beth_{n-1}(\kappa)^+\) s.t. \(X_\alpha\subseteq\beth_n(\kappa)^+\) and each \(X_\alpha\) has
    cardinality at most \(\beth_n(\kappa)\). Let \(X_0=\beth_n(\kappa)\). If \alpha is a limit ordinal,
    then \(X_\alpha=\bigcup_{\beta<\alpha}X_\beta\)

    Suppose we have \(X_\alpha\) with \(\abs{X_\alpha}=\beth_n(\kappa)\). Because
    \begin{equation*}
    \beth_n(\kappa)^{\beth_{n-1}(\kappa)}=(2^{\beth_{n-1}(\kappa)})^{\beth_{n-1}(\kappa)}=2^{\beth_{n-1}(\kappa)}=\beth_n(\kappa)
    \end{equation*}
    there are \(\beth_n(\kappa)\) subsets of \(X_\alpha\) of cardinality \(\beth_{n-1}(\kappa)\). Also note that
    if \(Y\subset X_\alpha\) and \(\abs{Y}=\beth_{n-1}(\kappa)\), then there are \(\beth_n(\kappa)\) functions \(g:[Y]^n\to\kappa\)
    because
    \begin{equation*}
    \kappa^{\beth_{n-1}(\kappa)}=2^{\beth_{n-1}(\kappa)}=\beth_n(\kappa)
    \end{equation*}
    Thus we can find \(X_{\alpha+1}\subseteq X_\alpha\) s.t. \(\abs{X_{\alpha+1}}=\beth_n(\kappa)\) and if \(Y\subset X_\alpha\)
    with \(\abs{Y}=\beth_{n-1}(\kappa)\) and \(\beta\in\lambda\setminus Y\), then there is \(\gamma\in X_{\alpha+1}\setminus Y\) s.t.
    \(f_\beta|[Y]^n=f_\gamma|[Y]^n\) <<CANT UNDERSTAND>>
    #+END_proof
** Order Indiscernibles
    Let \(\calm\) be an \(\call\)-structure

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \(I\) be an infinite set and suppose that \(X=\{x_i:i\in I\}\) is a set of distinct elements
    of \(\calm\). We say that \(X\) is an *indiscernible set* if whenever \(i_1,\dots,i_m\) and \(j_1,\dots,j_m\)
    are two sequences of \(m\) distinct elements of \(I\),
    then \(\calm\vDash\phi(x_{i_1},\dots,x_{i_m})\leftrightarrow \phi(x_{j_1},\dots,x_{j_m})\)
    #+END_definition

    For example, suppose that \(F\) is an algebraically closed field of infinite transcendence
    degree and \(x_1,x_2,\dots\) is an infinite algebraically independent set. For any two
    sequence \(i_1,\dots,i_m\) and \(j_1,\dots,j_m\), there is an automorphism \sigma of \(F\)
    with \(\sigma(x_{i_k})=x_{j_k}\) for \(k=1,\dots,m\). it follows that \(x_1,x_2,\dots\) is an infinite set of
    indiscernibles.

    If \((A,<)\) is an infinite linear order, then because we cannot have \(a<b\) and \(b<a\) there
    is no set of indiscernibles of size 2.

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \((I,<)\) be an ordered set, and let \((x_i:i\in I)\) be a sequence of distinct elements
    of \(M\), we say that \((x_i:i\in I)\) is a sequence of *order indiscernibles* if
    whenever \(i_1<i_2<\dots<i_m\) and \(j_1<\dots<j_m\) are two increasing sequences from \(I\),
    then \(\calm\vDash\phi(x_{i_1},\dots,x_{i_m})\leftrightarrow \phi(x_{j_1},\dots,x_{j_m})\)
    #+END_definition

    For example, in \((\Q,<)\), by quantifier elimination, if \(x_1<\dots<x_m\) and \(y_1<\dots<y_m\), then
    \(\Q\vDash\phi(\barx)\leftrightarrow\phi(\bary)\) for all \phi. Thus \(\Q\), itself, is a sequence of order indiscernibles

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm5.2.3
    Let \(T\) be a theory with infinite models. For any infinite linear order \((I,<)\), there
    is \(\calm\vDash T\) containing \((x_i:i\in I)\), a sequence of order indiscernibles
    #+END_theorem

    #+BEGIN_proof
    Let \(\call^*=\call\cup\{c_i:i\in I\}\). Let \Gamma be the union of
    * \(T\)
    * \(c_i\neq c_j\) for \(i,j\in I\) with \(i\neq j\)
    * \(\phi(c_{i_1},\dots,c_{i_m})\to\phi(c_{j_1},\dots,c_{j_m})\) for all \(\call\)-formulas \(\phi(\barv)\),
      where \(i_1<\dots<i_m\) and \(j_1<\dots<j_m\) are increasing sequences from \(I\)


    If \(\calm\vDash\Gamma\), then \((c_i^{\calm}:i\in I)\) is an infinite sequence of order indiscernibles. It suffices
    to show that \Gamma is satisfiable. Suppose that \(\Delta\subset\Gamma\) is finite. Let \(I_0\) be the finite subset
    of \(I\) s.t. if \(c_i\) occurs in \Delta, then \(i\in I_0\). Let \(\phi_1,\dots,\phi_m\) be the formulas s.t.
    \Delta asserts indiscenibility w.r.t. the formula \(\phi_i\), \(i\le m\). Let \(v_1,\dots,v_n\) be the free
    variables from \(\phi_1,\dots,\phi_m\), \(i\le m\).

     Let \(\calm\) be an infinite model of \(T\). Fix < any linear order of \(\calm\). We will define a
    partition \(F:[M]^n\to\calp(\{1,\dots,m\})\). If \(A=\{a_1,\dots,a_n\}\) where \(a_1<\dots<a_n\), then
    \begin{equation*}
    F(A)=\{i:\calm\vDash\phi_i(a_1,\dots,a_n)\}
    \end{equation*}
    Because \(F\) partitions \([M]^n\) into at most \(2^m\) sets, we can find an
    infinite \(X\subseteq M\) homogeneous for \(F\). Let \(\eta\subseteq\{1,\dots,m\}\) s.t. \(F(A)=\eta\) for \(A\in[X]^n\).

    Suppose that \(I_0\) is a finite subset of \(I\). Choose \((x_i:i\in I_0)\) s.t. each \(x_i\in X\) and
    s.t. \(x_i<x_j\) if \(i<j\). If \(i_1<\dots<i_n\) and \(j_1<\dots<j_n\) then
    \begin{equation*}
    \calm\vDash\phi_k(x_{i_1},\dots,x_{i_n})\Longleftrightarrow k\in\eta\Longleftrightarrow\calm\vDash\phi_k(x_{j_1},\dots,x_{j_n})
    \end{equation*}
    If we interpret \(c_i\) as \(x_i\) for \(i\in I_0\), then we make \(\calm\) a model of \Delta. Note that
    here \(x_i\in M\) -.-
    #+END_proof

    if \((x_i:i\in I)\) is any sequence of order indiscernibles in \(M\), we can order \(X=\{x_i:i\in I\}\)
    by \(x_i<x_j\) if \(i<j\). In this way, we frequently identify \(X\) and \(I\)

    Suppose that \(\psi(x,y)\) is a formula in the language s.t. in some \(\calm\vDash T\), \psi linearly orders an
    infinite set \(Y\). When we did the construction above, we could add the condition
    that \(\psi(c_i,c_j)\) for \(i<j\). We would then restrict the partition to \([Y]^m\) and let the
    ordering < be the ordering determined by \psi. In this way, we would get an infinite sequence of
    indiscernibles \((x_i:i\in I)\) s.t. \(\psi(x_i,x_j)\) iff \(i<j\)
*** Ehrenfeucht-Mostowski Models
    Suppose that our theory has built-in Skolem functions. Then when we have a model containing an
    infinite sequence of order indiscernibles, we can form the elementary submodel generated by the
    indiscernibles.

    Let \(T\) be an \(\call\)-theory. By Lemma ref:lemma2.3.6 we can find \(\call^*\supseteq\call\) and \(T^*\supseteq T\)
    and \(\call^*\)-theory with built-in Skolem functions, s.t. if \(\calm\) is any model of \(T\), we can
    interpret the symbols of \(\call^*\) s.t. \(\calm\vDash T^*\). Note that if \(I\) is a sequence of order
    indiscernibles for \(\call^*\), then \(I\) is also a sequence of order indiscernibles for \(\call\).

    If \(\calm\vDash T^*\) and \(X\subseteq M\), let \(\calh(X)\) be the \(\call^*\)-substructure of \(\calm\) generated
    by \(X\). We call \(\calh(X)\) the *Skolem hull* of \(X\). Because \(X\) has built in Skolem
    functions, \(\calh(X)\prec\calm\). Models built as Skolem hulls of sequences of order indiscernibles are
    called *Ehrenfeucht-Mostowski models*

    If \(I\) is an infinite set of order indiscernibles, then order-preserving premutations of \(I\)
    induce automorphisms of \(\calh(I)\).

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma5.2.4
    Suppose that \(T^*\) is an \(\call^*\)-theory with built-in Skolem functions. Let \(\calm\vDash T^*\).
    Let \(I\subseteq M\) be an infinite sequence of order indiscernibles. Suppose that \(\tau:I\to I\) is an
    order-preserving permutation. Then there is an automorphism \(\sigma:\calh(I)\to\calh(I)\) extending \tau
    #+END_lemma

    #+BEGIN_proof
    For each element \(a\in\calh(I)\), there is a Skolem term \(t\) and \(x_1<x_2<\dots<x_n\in I\) s.t.
    \(a=t(x_1,\dots,x_n)\). Let \(\sigma(a)=t(\tau(x_1),\dots,\tau(x_n))\).

    We first show that \sigma is well-defined. Suppose that there is a second Skolem term \(s\)
    s.t. \(a=s(x_1,\dots,x_n)\). Because
    \begin{equation*}
    \calm\vDash t(x_1,\dots,x_n)=s(x_1,\dots,x_n)
    \end{equation*}
    and \tau is order-preserving,
    \begin{equation*}
    \calm\vDash t(\tau(x_1),\dots,\tau(x_n))=s(\tau(x_1),\dots,\tau(x_n))
    \end{equation*}
    Thus \sigma is well defined.

    We must show that \sigma is an automorphism. If \(a=t(\barx)\) and \(t(\tau^{-1}(\barx))\),
    then \(\sigma(b)=a\) so \sigma is surjective

    Let \(\phi(v_1,\dots,v_m)\) be any \(\call^*\)-formula, and let \(a_1,\dots,a_m\in\calh(I)\). There are
    terms \(t_1,\dots,t_m\) and \(\barx\in I\) s.t. \(a_i=t_i(\barx)\). By indiscenibility
    \begin{align*}
    \calm\vDash\phi(a_1,\dots,a_m)\quad&\Leftrightarrow\quad\calm\vDash\phi(t_1(\barx),\dots,t_m(\barx))\\
    &\Leftrightarrow\quad\calm\vDash\phi(t_1(\tau(\barx)),\dots,t_m(\tau(\barx)))\\
    &\Leftrightarrow\quad\calm\vDash\phi(\sigma(a_1),\dots,\sigma(a_m))
    \end{align*}
    Thus \sigma is an automorphism
    #+END_proof

    Lemma ref:lemma5.2.4 shows that it would be useful to find order indiscernibles where there are
    many order-preserving permutations. Indeed, once we have an infinite sequence of order
    indiscernibles, we can find them of any given order type.

    Let \(X=(x_i:i\in I)\) be a sequence of order indiscernibles in \(\calm\). Let
    \begin{equation*}
    \tp(I)=\{\phi(v_1,\dots,v_n):\calm\vDash\phi(x_{i_1},\dots,x_{i_n}),i_1<\dots<i_n\in I,n\in\omega\}
    \end{equation*}
    We call \(\tp(X)\) the *type of the indiscernibles*. Note that \(\tp(X)\) is maximal as it's a
    sequence of order indiscernibles.

    #+LATEX: \wu{
    I think we can loose the condition here. See tent's Lemma 5.1.3. Standard is more general than this.
    #+LATEX: }
    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma5.2.5
    Let \(T^*\) be an \(\call^*\)-theory with built-in Skolem functions. Suppose that \(X=(x_i:i\in I)\) is
    an infinite sequence of order indiscernibles in \(\calm\vDash T^*\). If \((J,<)\) is any infinite ordered
    set, we can find \(\caln\vDash T^*\) containing a sequence of order indiscernibles \(Y=(y_j:j\in J)\)
    and \(\tp(X)=\tp(Y)\).
    #+END_lemma

    #+BEGIN_proof
    Add to \(\call^*\) constant symbols \(c_j\) for \(j\in J\) and let
    \begin{equation*}
    \Gamma=T^*\cup\{c_i\neq c_j:i,j\in J,i\neq j\}\cup\{\phi(c_{i_1},\dots,c_{i_m}):i_1<\dots<i_m\in J\text{ and }\phi\in\tp(X)\}
    \end{equation*}
    If \Delta is a finite subset of \Gamma, then by choosing elements of \(X\) we can make \(\calm\) a model of
    \Delta

    If \(\caln\vDash\Gamma\), then the interpretation of the \((c_j:j\in J)\) is the desired indiscernible sequence.
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma5.2.6
    Suppose that \(T^*\) is an \(\call^*\)-theory with built-in Skolem functions. If \(I\) is a sequence
    of order indiscernibles in \(\calm\vDash T^*\) and \(J\) is a sequence of order indiscernibles
    in \(\caln\vDash T^*\) with \(\tp(I)=\tp(J)\), then any order-preserving map \(\tau:I\to J\) extends to an
    elementary embedding \(\sigma:\calh(I)\to\calh(J)\)
    #+END_lemma

    #+BEGIN_proof
    If \(a=t(x_1,\dots,x_n)\) for \(t\) a term and \(x_1,\dots,x_n\in I\) we let \(\sigma(a)=t(\tau(x_1),\dots,\tau(x_n))\). We
    then argue as in Lemma ref:lemma5.2.4 that this map is well-defined and elementary
    #+END_proof

    We give several applications of this method

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    Let \(T\) be an \(T\)-theory with infinite models. For any \(\kappa\ge\abs{\call}+\aleph_0\), there
    is \(\caln\vDash T\) of cardinality \kappa with \(2^\kappa\) automorphisms
    #+END_corollary

    #+BEGIN_proof
    Let \(\call^*\) and \(T^*\) be as above. We can find \(\calm\vDash T^*\) containing an infinite sequence of
    order indiscernibles \(I\).

    *Claim*. There is a linear order \((X,<)\) of size \kappa with \(2^\kappa\) order-preserving permutations

    Let \(X=\kappa\times\Q\) with the lexicographic ordering \((\alpha,q)<(\beta,r)\) if \(\alpha<\beta\) or \(\alpha=\beta\) and \(q<r\).
    For each \(A\subseteq\kappa\) let \(\sigma_A\) be the order-preserving permutation
    \begin{equation*}
    \sigma_A((\alpha,q))=
    \begin{cases}
    (\alpha,q)&\alpha\in A\\
    (\alpha,q+1)&\alpha\notin A
    \end{cases}
    \end{equation*}
    Clearly \(\sigma_A=\sigma_B\) iff \(A=B\). Thus there are \(2^\kappa\) order-preserving permutations of \(X\).

    By Lemma ref:lemma5.2.5 we can find \(\caln\vDash T^*\) containing \(J\) a sequence of order
    indiscernibles of order type \((X,<)\). By lemma ref:lemma5.2.4 each order preserving
    permutation of the indiscernibles induces an automorphisms of \(\calh(J)\). Thus \(\calh(J)\)
    has \(2^\kappa\) automorphisms and \(\abs{\calh(J)}=\kappa\). When viewed as an \(\call\)-structure, \(\caln\) still
    has \(2^\kappa\) automorphisms
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    Suppose that \(T^*\) is an \(\call^*\)-theory with built-in Skolem functions, \(\calm\vDash T^*\), \(\calm\)
    omits \(p\) (a type over \(\emptyset\)), and \(\calm\) contains an infinite sequence of order
    indiscernibles \(I\). There are arbitrarily large models of \(T^*\) omitting \(p\).
    #+END_corollary

    #+BEGIN_proof
    Let \(\kappa\ge\aleph_0\). By Lemma ref:lemma5.2.5, we can find \(\caln\vDash T^*\) containing a sequence or order
    indiscernibles \(J\) with \(\abs{J}\ge\kappa\), and \(\tp(I)=\tp(J)\). Then \(\abs{\calh(J)}\ge\kappa\). Suppose
    that \((a_1,\dots,a_n)\in\calh(J)\) realizes \(p\). Let \(a_i=t_i(x_1,\dots,x_m)\), where \(t_i\) is a Skolem
    term, \(x_1<\dots<x_m\), and each \(x_i\in J\). If \(y_1<\dots<y_m\) is an increasing sequence in \(I\),
    then, because \(\tp(I)=\tp(J)\)
    \begin{equation*}
    \calm\vDash\phi(t_1(\bary),\dots,t_n(\bary))\Leftrightarrow\caln\vDash\phi(a_1,\dots,a_n)
    \end{equation*}
    Thus \((t_1(\bary),\dots,t_n(\bary))\) realizes \(p\in\calm\), a contradiction.
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm5.2.9
    Let \(\call\) be countable and \(T\) be an \(\call\)-theory with infinite models. For all \(\kappa\ge\aleph_0\),
    there is \(\calm\vDash T^*\) with \(\abs{M}=\kappa\) s.t. if \(A\subseteq M\), then \(\calm\) realizes at
    most \(\abs{A}+\aleph_0\) types in \(S_n^{\calm}(A)\).
    #+END_theorem

    #+BEGIN_proof
    We assume that \(n=1\). Let \(\call^*\) and \(T^*\) be as above. Let \(\calm\vDash T\) be the Skolem hull of
    a sequence of order indiscernibles \(I\) or order type \((\kappa,<)\). Then \(\abs{M}=\kappa\).

    Let \(A\subseteq M\). For each \(a\in A\), there is a term \(t_a\) and \(\barx_a\) a sequence from \(I\)
    s.t. \(a=t_a(\barx_a)\). Let \(X=\{x\in I:x\text{ occurs in some }\barx_a\}\).
    Then \(\abs{X}\le\abs{A}+\aleph_0\)

    If \(y_1<\dots<y_n\) and \(z_1<\dots<z_n\), we say that \(\bary\sim_X\barz\) if for all \(x\in X\), \(y_i<x\)
    iff \(z_i<x\) and \(y_i=x\) iff \(z_i=x\) for \(i=1,\dots,n\)

    *Claim* If \(\bary\sim_X\barz\)  and \(t\) is a Skolem term, then \(t(\bary)\) and \(t(\barz)\)
     realize the same type in \(S_1^{\calm}(A)\).

     Let \(a_1,\dots,a_m\in A\). Because \(\bary\) and \(\barz\) are in the same position in the ordering
     w.r.t. \(X\), by indiscenibility
     \begin{align*}
     \calm\vDash\phi(t(\bary),a_1,\dots,a_m)\quad&\leftrightarrow\quad\calm\vDash\phi(t(\bary),t_{a_1}(\barx_{a_1}),\dots,t_{a_m}(\barx_{a_m}))\\
     &\Leftrightarrow\quad\calm\vDash\phi(t(\barz),t_{a_1}(\barx_{a_1}),\dots,t_{a_m}(\barx_{a_m}))\\
     &\Leftrightarrow\quad\calm\vDash\phi(t(\barz),a_1,\dots,a_m)
     \end{align*}

     It suffices to show that \(\abs{I^n/\sim_X}\le\abs{A}+\aleph_0\).For \(y\in I\setminus X\), let \(C_y=\{x\in X:x<y\}\).
     Then \(\bary\sim_X\barz\) iff for each \(i\):
     1. if \(y_i\in X\), then \(y_i=z_i\) and
     2. if \(y_i\notin X\), then \(z_i\notin X\) and \(C_{y_i}=C_{z_i}\)


     Because \(I\) is well-ordered, \(C_y=C_z\) iff \(C_y=C_z=\emptyset\) or
     \begin{equation*}
     \inf\{i\in I:i>C_y\}=\inf\{i\in I:i>C_z\}
     \end{equation*}
     In particular, there are at most \(\abs{X}+1\) possible cuts \(C_y\). It follows
     that \(\abs{I^n/\sim_X}\le\abs{A}+\aleph_0\) and \(\calm\) realizes at most \(\abs{A}+\aleph_0\) types over \(A\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor5.2.10
    Let \(T\) be a complete theory in a countable language with infinite models, and let \(\kappa\ge\aleph_1\).
    If \(T\) is \kappa-categorical, then \(T\) is \omega-stable
    #+END_corollary

    #+BEGIN_proof
    If \(T\) is not \omega-stable, then we can find a countable \(\calm\vDash T\) with \(A\subseteq M\)
    s.t. \(\abs{S_n^{\calm}(A)}>\aleph_0\). By Compactness, we can find \(\calm\prec\caln_0\) of cardinality \kappa (as long
    as \(\kappa>\aleph_0\)) realizing
    uncountably many types in \(S_n^{\calm}(A)\). By Theorem ref:thm5.2.9 we can find \(\caln_1\vDash T\) of
    cardinality \kappa s.t. for all \(B\subset M\) if \(\abs{B}=\aleph_0\), then \(\caln_1\) realizes at most \(\aleph_0\)
    types over \(B\). Then \(\caln_0\not\cong\caln_1\), contradicting \kappa-categoricity
    #+END_proof

   Combining Corollary ref:cor5.2.10 with Theorem ref:thm4.3.41

   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
   label:cor5.2.11
   Let \(T\) be a complete theory in a countable language with infinite models. If \(\kappa\ge\aleph_1\)
   and \(T\) is \kappa-categorical, then \(T\) has no Vaughtian pairs and hence no \((\kappa,\lambda)\)-models for \(\kappa>\lambda\ge\aleph_0\)
   #+END_corollary

   #+BEGIN_proof
   Because \(T\) is \kappa-categorical, \(T\) is \omega-stable. If there is a Vaughtian pair, then by Theorem
   ref:thm4.3.34 there is an \((\aleph_1,\aleph_0)\)-model, and by Theorem ref:thm4.3.41, a \((\kappa,\aleph_0)\)-model.
   Because we can find a model of \(T\) of cardinality \kappa where every infinite definable set has
   cardinality \kappa, this is a contradiction.
   #+END_proof
*** Indiscernibles in Stable Theories
    We have seen that, although it is always possible to find infinite sequences of order
    indiscernibles, for some theories we cannot find infinite indiscernibles sets.
    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma5.2.12
    For any infinite cardinal \kappa, there is a dense linear order \((A,<)\) with \(B\subset A\) s.t. \(B\) is
    dense in \(A\) and \(\abs{B}\le\kappa<A\)
    #+END_lemma

    #+BEGIN_proof
    Let \(\lambda\le\kappa\) be least s.t. \(2^\lambda>\kappa\). Let \(A\) be the set of all functions from \lambda to \(\Q\). If
    we order \(A\) by \(f<g\) iff \(f(\alpha)<g(\alpha)\), where \alpha is least s.t. \(f(\alpha)\neq g(\alpha)\)(lexicographic order😁),
    then \((A,<)\vDash\DLO\).

    Let \(B\) be the set of sequences in \(A\) that are eventually 0
    (Maybe, that is, there is a \(\gamma<\lambda\) s.t. \(f(\beta)=0\) for all \(\gamma<\beta<\lambda\))
    Then
    \begin{equation*}
    \abs{B}=\sup\{\mu<\lambda:2^\mu\}\le\kappa
    \end{equation*}
    and, for all \(f,g\in X\), if \(f<g\), there is \(h\in Y\) s.t. \(f<h<g\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    Suppose that \(\call\) is a countable language, \kappa is an infinite cardinal and \(T\) is a
    \kappa-stable \(\call\)-theory. If \(\calm\vDash T\) and \(X\subseteq M\) is an infinite sequence of order indiscernibles,
    then \(X\) is a set of indiscernibles
    #+END_theorem

    #+BEGIN_proof
    Let \(\phi(v_1,\dots,v_n)\) be an \(\call\)-formula and \(x_1,\dots,x_n\) be an increasing sequence from \(I\)
    s.t. \(\calm\vDash\phi(x_1,\dots,x_n)\). Let \(S_n\) be the group of all permutations of \(\{1,\dots,n\}\).
    Let \(\Gamma_\phi=\{\sigma\in  S_n:\calm\vDash\phi(x_{\sigma(1)},\dots,x_{\sigma(n)})\}\). To show that \(X\) is a set of indiscernibles, we
    must show that \(\Gamma_\phi=S_n\)

    *Claim* \(\Gamma_\phi=S_n\).

    Suppose not. Because every permutation is a product of transpositions we can find \(\sigma\in\Gamma_\phi\)
    and \(\tau\in S_n\setminus\Gamma_\phi\) s.t. \(\tau=\sigma\circ\mu\) for some transpositions \mu (If we can't find such \sigma, then \(S_n\setminus\Gamma_\phi=S_n\)). Say
    \(\mu(y_1,\dots,y_n)=(y_1,\dots,y_{m-1},y_{m+1},y_m,y_{m+2},\dots,y_n)\).

    Let \(\psi(v_1,\dots,v_n)\) be the formula \(\phi(v_{\sigma(1)},\dots,v_{\sigma(n)})\). Then
    \begin{equation*}
    \calm\vDash\psi(x_1,\dots,x_n)
    \end{equation*}
    but
    \begin{equation*}
    \calm\vDash\neg\psi(x_1,\dots,x_{m-1},x_{m+1},x_m,x_{m+2},\dots,x_n)
    \end{equation*}
    Let \((A,<)\) and \(B\) be as in Lemma ref:lemma5.2.12, we can find \(\caln\vDash T\)  containing a
    sequence of order indiscernibles \(Y\) of order type \((A,<)\)
    with \(\tp(Y)=\tp(X)\)by Lemma ref:lemma5.2.5.
    Let \(Y_0\) be the subset of \(Y\) corresponding to \(B\). If \(y_1<\dots<y_n\) are in \(Y\), then
    \begin{equation*}
    \caln\vDash\psi(y_1,\dots,y_n)
    \end{equation*}
    and
    \begin{equation*}
    \caln\vDash\neg\psi(y_1,\dots,y_{m-1},y_{m+1},y_m,y_{m+2},\dots,y_n)
    \end{equation*}
    If \(x,y\in Y\) and \(x<y\) we can find \(z_1,\dots,z_{n-1}\) in \(Y_0\)
    s.t. \(z_1<\dots<z_{k-1}<x<z_k<y<z_{k+1}<\dots<z_{n-1}\). Then
    \begin{equation*}
    \caln\vDash\psi(z_1,\dots,z_{k-1},x,z_k,\dots,z_{n-1})
    \end{equation*}
    but
    \begin{equation*}
    \caln\vDash\neg\psi(z_1,\dots,z_{k-1},y,z_k,\dots,z_{n-1})
    \end{equation*}
    Thus any two elements of \(Y\) realize distinct 1-types over \(Y_0\).
    Because \(\abs{Y_0}\le\kappa<\abs{Y}\), \(T\) is not \kappa-stable, a contradiction
    #+END_proof
*** Applications of Erdős–Rado
    \emoji{😅}
** A Many-Models Theorem
    Let \(T\) be a complete theory in a countable language with infinite models.
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say that \(T\) is *stable* if it. is \lambda-stable for some \(\lambda\ge\aleph_0\); otherwise we say \(T\) is *unstable*
    #+END_definition

    Shelah proved that if \(T\) is unstable, then \(T\) has \(2^\kappa\) nonisomorphic models of
    cardinality \kappa for all \(\kappa\ge\aleph_0\). Indeed, he showed that unless \(T\) is \kappa-stable for
    all \(\kappa\ge 2^{\aleph_0}\), then \(T\) has the maximal number of nonisomorphic models for each
    uncountable cardinal \kappa.

    *Assumptions*.
    * \(T\) is a complete theory in a countable language \(\call\) with infinite models
    * there is a binary relation symbol < in the language
    * there is \(\calm\vDash T\) containing an infinite set linearly ordered by <


    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    If \(\kappa\ge\aleph_1\), then there are \(2^\kappa\) nonisomorphic models of \(T\)
    #+END_theorem

    We will prove this only for regular \(\kappa>\aleph_1\).
** Exercises
    #+BEGIN_exercise
    label:ex5.5.6
    We say that a theory \(T\) has the *order property* iff there is a
    formula \(\phi(v_1,\dots,v_n,w_1,\dots,w_n)\) and \(\calm\vDash T\) with \(\barx_1,\barx_2,\dots\) in \(M^n\)
    s.t. \(\calm\vDash\phi(\barx_i,\barx_j)\) iff \(i<j\).
    1. Show that if \phi has the order property in \(T\), then \(T\) is not \kappa-stable for any infinite \kappa
    2. Show that \(T\) has the order property iff there is a formula \(\psi(\barv,\barw)\)
       and \(\calm\vDash T\) with \(\bara_1,\barb_2,\bara_2,\barb_2,\dots\) s.t. \(T\vDash\psi(\bara_i,\barb_j)\) iff \(i<j\)
    #+END_exercise

    #+LATEX: \wu{
    I think, we just talk about the order in the orders rather than the \(T\)
    #+LATEX: }

    #+BEGIN_proof
    1. Let \((A,<)\) and \(B\) be as in Lemma ref:lemma5.2.12. By Lemma ref:lemma5.2.5, we can
       find \(\caln\vDash T\) containing a sequence of order indiscernibles \(Y\) of type \((A,<)\)
       with \(\tp(Y)=\tp(X)\).

       I think, we can just transform vectors into constants.

       Thus \(\caln\vDash\phi(\barx_a,\barx_b)\) iff \(a<b\). So we need to prove that for any \(x,y\in A\)
       and \(x<y\), they realize different type. Take \(x<z<y\) and consider \(\phi(\barx_m,\barx_z)\).

       Thus \(\abs{S_n(\{\barx_b:b\in B\})}>\abs{B}\)

    2. \(\Rightarrow\). Let \(\phi(\barv_1,\barv_2,\barw_1,\barw_2)\) be \(\psi(\barv_1,\barw_2)\).
       Let \(\barc_i=(\bara_i,\barb_i)\). Show that \(\phi(\barc_i,\barc_j)\) iff \(i<j\).
    #+END_proof
* \texorpdfstring{\(\omega\)}{ω}-Stable Theories
** Uncountably Categorical Theories
    Throughout this chapter, \(T\) will be a complete theory in a countable language with infinite
    models

    We say that \(T\) is *uncountably categorical* if it is \kappa-categorical for some uncountable \kappa

    #+ATTR_LATEX: :options [Categoricity Theorem]
    #+BEGIN_theorem
    If \(T\) is \kappa-categorical for some uncountable \kappa, then \(T\) is \kappa-categorical for every
    uncountable \kappa
    #+END_theorem

    In Theorem ref:cor5.2.10 and ref:cor5.2.11, we proved two important facts about uncountably
    categorical theories
    * if \(\kappa\ge\aleph_1\) and \(T\) is \kappa-categorical, then \(T\) is \omega-stable
    * if \(\kappa\ge\aleph_1\) and \(T\) is \kappa-categorical, then \(T\) has no Vaughtian pairs
*** Strongly Minimal Sets
    If \(\calm\) is an \(\call\)-structure and \(\phi(\barv)\) is an \(\call_M\)-formula, we will let \(\phi(\calm)\)
    denote the elements of \(M\) that satisfy \phi
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Let \(\calm\) be an \(\call\)-structure and let \(D\subseteq M^n\) be an infinite definable set. We say
    that \(D\) is *minimal* in \(\calm\) if for any definable \(Y\subseteq D\) either \(Y\) is finite
    or \(D\setminus Y\) is finite. If \(\phi(\barv,\bara)\) is the formula that defines \(D\), then we also say
    that \(\phi(\barv,\bara)\) is minimal

    We say that \(D\) and \phi are *strongly minimal* if \phi is minimal in any elementary extension \(\caln\)
    of \(\calm\)

    We say that a theory \(T\) is *strongly minimal* if the formula \(v=v\) is strongly minimal
    #+END_definition

    This definition makes sense only if \phi is non-algebraic.

    Let \(\call=\{E\}\) and consider the \(\call\)-structure \(\calm\), where \(E\) is an equivalence relation
    with one class of size \(n\) for \(n=1,2,\dots\) and no infinite classes. In this structure, \(v=v\)
    is a minimal formula, but suppose that \(\calm\prec\caln\) and \(a\in N\) s.t. the equivalence class of \(a\)
    is infinite. Then the formula \(vEa\) defines an infinite-coinfinite subset of the universe.
    Thus the formula \(v=v\) is not strongly minimal

    Let \(\calm\) be an \(\call\)-structure and \(D\subseteq M\) be strongly minimal. We will consider \(\acl_D\),
    the algebraic closure relation restricted to \(D\). Recall that \(b\) is algebraic over \(A\) if
    there is a formula \(\phi(x,\bara)\) with \(\bara\in A\) s.t. \(\phi(\calm,\bara)\) is finite
    and \(\phi(b,\bara)\). For \(A\subseteq D\), we let \(\acl_D(A)=\{b\in D:b\text{ is algebraic over }A\}\)

    If \(K\) is an algebraically closed field and \(A\subseteq K\), then \(\acl(A)\) is the algebraic
    closure of the subfield generated by \(A\) (Proposition ref:prop3.2.15). If \(G\) is a
    torsion-free divisible Abelian group, then \(\acl(A)\) is the \(\Q\)-vector space span of \(A\)
    (Exercise ref:ex3.4.5)

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    1. \(\acl(\acl(A))=\acl(A)\supseteq A\)
    2. If \(A\subseteq B\), then \(\acl(A)\subseteq\acl(B)\)
    3. If \(a\in\acl(A)\), then \(a\in\acl(A_0)\) for some finite \(A_0\subseteq A\)
    #+END_lemma

    #+BEGIN_proof
    1. For any \(a\in A\), just consider \(x=a\). Hence \(A\subseteq\acl(A)\). Let \(B=\acl(A)\). For
       any \(c\in\acl(\acl(A))\), there is a formula \phi s.t. \(\phi(\calm,\barb)\) is finite
       and \(\phi(c,\barb)\). For each \(b\), the is a formula \(\psi_b\) s.t. \(\psi_b(\calm,\bara)\) is finite
       and \(\psi_b(b,\bara)\). Then we could use \(x\in\psi_b(\calm,\bara)\) to represent \(b\).
    3. [@3] \(\phi(\calm,\bara)\) is finite and \(\phi(a,\bara)\).
    #+END_proof

    #+ATTR_LATEX: :options [Exchange Principle]
    #+BEGIN_lemma
    label:lemma6.1.4
    Suppose that \(D\subset M\) is strongly minimal, \(A\subseteq D\), and \(a,b\in D\).
    If \(a\in\acl(A\cup\{b\})\setminus\acl(A)\), then \(b\in\acl(A\cup\{a\})\).
    #+END_lemma

    #+LATEX: \wu{
    Abuse of symbols, \(\acl\) here is actually \(\acl_D\)
    #+LATEX: }

    #+BEGIN_proof
    We write \(\acl(A,b)\) for \(\acl(A\cup\{b\})\).

    Suppose that \(a\in\acl(A,b)\setminus\acl(A)\). Suppose that \(\calm\vDash\phi(a,b)\), where \phi is a formula with
    parameters from \(A\) and \(\abs{\{x\in D:\phi(x,b)\}}=n\). Let \(\psi(w)\) be the formula asserting
    that \(\abs{\{x\in D:\phi(x,w)\}}=n\). If \(\psi(w)\) defines a finite subset of \(D\),
    #+LATEX: \wu{
    \psi is an \(\call_A\)-formula as \phi and \(\psi(D)\) is finite, so \(b\in\acl_D(A)\)
    #+LATEX: }
    then \(b\in\acl(A)\) and \(a\in\acl(A)\), a contradiction. Thus, \(\psi(w)\) defines a cofinite subset
    of \(D\).

    If \(\{y\in D:\phi(a,y)\wedge\psi(y)\}\) is finite, we are done as \(b\in\acl_D(A,a)\). Thus we assume, for
    purpose of contradiction, that \(\abs{D-\{y:\phi(a,y)\wedge\psi(y)\}}=l\) for some \(l\). Let \(\chi(x)\) be the
    formula expressing
    \begin{equation*}
    \abs{D-\{y:\phi(x,y)\wedge\psi(y)\}}=l
    \end{equation*}
    If \(\chi(x)\) defines a finite subset of \(D\), then \(a\in\acl(A)\). Thus \(\chi(x)\) defines a
    cofinite set.

    Choose \(a_1,\dots,a_{n+1}\) s.t. \(\chi(a_i)\). The set \(B_i=\{w\in D:\phi(a_i,w)\wedge\psi(w)\}\) is cofinite
    for \(i=1,\dots,n+1\). Choose \(\hatb\in\bigcap B_i\). Then \(\phi(a_i,\hatb)\) for each \(i\),
    so \(\abs{\{x\in D:\phi(x,\hatb)\}}\ge n+1\), contradicting the fact that \(\psi(\barb)\)
    #+END_proof

    We fix \(\calm\vDash T\) and \(D\) a strongly minimal set in \(\calm\).

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say that \(A\subseteq D\) is *independent* if \(a\notin\acl(A\setminus\{a\})\) for all \(a\in A\). If \(C\subset D\), we say
    that \(A\) is *independent over* \(C\) if \(a\notin\acl(C\cup(A\setminus\{a\}))\) for all \(a\in A\).
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.1.6
    Suppose that \(\calm,\caln\vDash T\) and \(\phi(v)\) is a strongly minimal formula with parameters from \(A\),
    where \(A=\emptyset\) or \(A\subseteq M_0\) where \(\calm_0\vDash T\), \(\calm_0\prec\calm\) and \(\calm_0\prec\caln\). If \(a_1,\dots,a_n\in\phi(\calm)\) are
    independent over \(A\) and \(b_1,\dots,b_n\in\phi(\caln)\) are independent over \(A\),
    then \(\tp^{\calm}(\bara/A)=\tp^{\caln}(\barb/A)\).
    #+END_lemma

    #+BEGIN_proof
    We will assume that \(\phi(v)\) has parameters from \(A\subseteq M_0\) where \(\calm_0\prec\calm\) and \(\calm_0\prec\caln\) and
    leave the case \(A=\emptyset\) until Exercise ref:ex6.6.4

    We prove this by induction on \(n\). Assume that \(n=1\), \(a\in\phi(\calm)\setminus\acl(A)\)
    #+LATEX: \wu{
    (\(a\notin\acl(A\cup(\{a\}\setminus\{a\}))\))
    #+LATEX: }
    and \(b\in\phi(\caln)\setminus\acl(A)\). Let \(\psi(v)\) be a formula with parameters from \(A\). Suppose
    that \(\calm\vDash\psi(a)\). Because \(a\notin\acl(A)\), \(\phi(\calm)\cap\psi(\calm)\) is infinite. Because \phi is strongly
    minimal, \(\phi(\calm)\setminus\psi(\calm)\) is finite. Thus there is an \(n\) s.t.
    \begin{equation*}
    \calm\vDash\abs{\{x:\phi(x)\wedge\neg\psi(x)\}}=n
    \end{equation*}
    Because \(\calm_0\prec\calm\), \(\calm_0\prec\caln\) and \(b\notin\acl(A)\), \(\caln\vDash\psi(b)\).
    #+LATEX: \wu{
    First \(\caln\vDash\abs{\{x:\phi(x)\wedge\neg\psi(x)\}}=n\). As \(b\notin\acl(A)\), \(\caln\vDash\neg(\phi(b)\wedge\neg\psi(b))\).
    #+LATEX: }
    Thus \(\tp^{\calm}(a/A)=\tp^{\caln}(b/A)\)

    Suppose that the claim i true for \(n\) and \(a_1,\dots,a_{n+1}\in\phi(\calm)\) and \(b_1,\dots,b_{n+1}\in\phi(\caln)\) are
    independent sequences over \(A\). Let \(\bara=(a_1,\dots,a_n)\) and \(\barb=(b_1,\dots,b_n)\). By
    induction, \(\tp^{\calm}(\bara/A)=\tp^{\caln}(\barb/A)\). Let \(\psi(\barw,v)\) be a formula with
    parameters from \(A\) s.t. \(\calm\vDash\psi(\bara,a_{n+1})\).
    Because \(a_{n+1}\notin\acl(A,\bara)\), \(\phi(\calm)\cap\psi(\bara,\calm)\) is infinite and \(\phi(\calm)\setminus\psi(\bara,\calm)\) is
    finite. There is an \(n\) s.t.
    \begin{equation*}
    \calm\vDash\abs{\{v:\phi(v)\wedge\neg\psi(\bara,v)\}}=n
    \end{equation*}
    Because \(\calm_0\prec\calm\) and \(\calm_0\prec\caln\) and \(\tp^{\calm}(\bara/A)=\tp^{\caln}(\barb/A)\)
    \begin{equation*}
    \caln\vDash\abs{\{v:\phi(v)\wedge\neg\psi(\barb,v)\}}=n
    \end{equation*}
    #+LATEX: \wu{
    As \(\tp^{\calm}(\bara/A)=\tp^{\caln}(\barb/A)\), we can build a partial elementary
    map \(f:\bara\mapsto\barb\)
    \begin{equation*}
    \calm\vDash\exists v\psi(\bara,v)\Leftrightarrow\caln\vDash\exists v\psi(\barb,v)
    \end{equation*}
    #+LATEX: }
    Because \(b_{n+1}\notin\acl(A,\barb)\), \(\caln\vDash\psi(\barb,b_{n+1})\).
    Thus \(\tp^{\calm}(\bara,a_{n+1}/A)=\tp^{\caln}(\barb,b_{n+1}/A)\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor6.1.7
    If \(\calm,\caln\vDash T\), \(A\) and \(\phi(v)\) are as above, \(B\) is an infinite subset of \(\phi(\calm)\)
    independent over \(A\) and \(C\) is an infinite subset of \(\phi(\caln)\) independent over \(A\),
    then \(B\) and \(C\) are infinite sets of indiscernibles of the same type over \(A\).
    #+END_corollary

    Therefore cardinality is the only way to distinguish independent subsets of \(D\).

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    We say that \(A\) is a *basis* for \(Y\subseteq D\) if \(A\subseteq Y\) is independent and \(\acl(A)=\acl(Y)\)
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.1.9
    Let \(A,B\subseteq D\) be independent with \(A\subseteq\acl(B)\)
    1. Suppose that \(A_0\subseteq A\), \(B_0\subseteq B\), \(A_0\cup B_0\) is a basis for \(\acl(B)\)
       and \(a\in A\setminus A_0\). Then there is \(b\in B_0\) s.t. \(A_0\cup\{a\}\cup(B_0\setminus\{b\})\) is a basis for \(\acl(B)\)
    2. \(\abs{A}\le\abs{B}\)
    3. If \(A\) and \(B\) are bases for \(Y\subseteq D\), then \(\abs{A}=\abs{B}\)
    #+END_lemma

    #+LATEX: \wu{
    From 1, if \(A_0=\emptyset\) and \(B_0\) is a basis for \(\acl(B)\). Then take arbitrary \(a\in A\) there
    is a \(b\in B_0\) s.t. \(\{a\}\cup(B_0\setminus\{b\})\) is a basis for \(\acl(B)\)
    #+LATEX: }


    #+BEGIN_proof
    1. Let \(C\subseteq B_0\) be of minimal cardinality s.t. \(a\in\acl(A_0\cup C)=\acl(A_0,b,C\setminus\{b\})\).
       #+LATEX: \wu{
       As \(C\) is minimal, \(a\notin\acl(A_0,C\setminus\{b\})\).
       #+LATEX: }
        Because \(A\) is
        independent, \(\abs{C}\ge 1\). Let \(b\in C\). By exchange, \(b\in\acl(A_0,a,C\setminus\{b\})\) and
        thus \(\acl(A_0\cup\{a\}\cup(B_0\setminus\{b\}))=\acl(B)\).

        If \(a\in\acl(A_0,B_0\setminus\{b\})\), then \(b\in\acl(A_0,B_0\setminus\{b\})\), contradicting the fact
       that \(A_0\cup B_0\) is a basis. Thus \(A_0\cup\{a\}\cup(B\setminus\{b\})\) is independent
    2. Suppose that \(B\) is finite. Suppose that \(\abs{B}=n\) and \(a_1,\dots,a_{n+1}\) are distinct
        elements of \(A\). Let \(A_0=\emptyset\) and \(B_0=B\). Using 1 inductively we can
        find \(b_1,\dots,b_n\in B\) distinct s.t. \(\{a_1,\dots,a_i\}\cup(B\setminus\{b_1,\dots,b_i\})\) is a basis for \(\acl(B)\)
        for \(i\le n\). But then \(\acl(a_1,\dots,a_n)=\acl(B)\). Because \(a_{n+1}\in\acl(B)\), this
        contradicts the independence of \(A\)

        If \(B\) is infinite, then for any finite \(B_0\subset B\), \(A\cap\acl(B_0)\) is finite and
        \begin{equation*}
        A=\bigcup_{B_0\subseteq B\text{ finite}}A\cap\acl(B_0)\subseteq\bigcup_{B_0\subseteq B\text{ finite}}\acl(B_0)=B
        \end{equation*}
        Thus \(\abs{A}\le\abs{B}\)
    3. From 2.
    #+END_proof

    [[index:dimension]]
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    If \(Y\subseteq D\), then the *dimension* of \(Y\) is the cardinality of a basis for \(Y\), denoted by \(\dim(Y)\)
    #+END_definition

    Note that if \(D\) is uncountable, then \(\dim(D)=\abs{D}\) because our language is countable
    and \(\acl(A)\) is countable for any countable \(A\subseteq D\)

    For strongly minimal theories, every model is determined up to isomorphism by its dimension

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    label:thm6.1.11
    Suppose \(T\) is a strongly minimal theory. If \(\calm,\caln\vDash T\), then \(\calm\cong\caln\) iff \(\dim(M)=\dim(N)\)

    More generally, if \(\calm,\caln\) and \phi are as in Lemma ref:lemma6.1.6 and \(\dim(\phi(\calm))=\dim(\phi(\caln))\),
    then there is a bijective partial elementary map \(f:\phi(\calm)\to\phi(\caln)\)
    #+END_theorem

    #+BEGIN_proof
    Let \(B\) be at transcendence basis for \(\phi(\calm)\) and \(C\) be a transcendence basis
    for \(\phi(\caln)\).
    #+LATEX: \wu{
    (Guess its just basis)
    #+LATEX: }
    Because \(\abs{B}=\abs{C}\), we can find a bijection \(f:B\to C\). By Corollary
    ref:cor6.1.7, \(f\) is elementary. Let
    \begin{equation*}
    I=\{g:B'\to C':B\subseteq B'\subseteq\phi(\calm),C\subseteq C'\subseteq\phi(\caln),f\subseteq g\text{ partial elementary}\}
    \end{equation*}
    By Zorn's Lemma, there is a maximal \(g:B'\to C'\). Suppose that \(b\in\phi(\calm)\setminus B'\). Because \(b\) is
    algebraic over \(B'\)
    #+LATEX: \wu{
    as \(B\subseteq B'\)
    #+LATEX: }
    , there is a formula \(\psi(v,\bard)\) isolating \(\tp^{\calm}(b/B')\) (Exercise ref:ex4.5.4).
    Because \(g\) is partial elementary, we can find \(c\in\phi(\caln)\) s.t. \(\psi(c,g(\bard))\).
    Then \(\tp^{\calm}(b/B')=\tp^{\caln}(c/C')\), and we can extend \(g\) by sending \(b\) to \(c\). This
    contradicts the maximality of \(g\). Thus \(\phi(\calm)=B'\). An analogous  argument shows that \(C'=\phi(\caln)\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    If \(T\) is a strongly minimal theory, then \(T\) is \kappa-categorical for \(\kappa\ge\aleph_1\) and \(I(T,\aleph_0)\le\aleph_0\)
    #+END_corollary

    #+BEGIN_proof
    If \(\calm\) has cardinality \(\kappa\ge\aleph_1\), then any transcendence basis for \(\calm\) has cardinality \kappa,
    whereas if \(\abs{M}=\aleph_0\), then \(\dim(M)\le\aleph_0\)
    #+END_proof
*** Existence of Strongly Minimal Formulas
    In \omega-stable theories, we can always find minimal formulas

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.1.13
    Let \(T\) be \omega-stable
    1. If \(\calm\vDash T\), then there is a minimal formula in \(\calm\)
    2. If \(\calm\vDash T\) is \(\aleph_0\)-saturated and \(\phi(\barv,\bara)\) is a minimal formula in \(\calm\),
       then \(\phi(\barv,\bara)\) is strongly minimal
    #+END_lemma

    #+BEGIN_proof
    1. Suppose not. We build a tree of formulas \((\phi_\sigma:\sigma\in 2^{<\omega})\) s.t.:
       1. if \(\sigma\subseteq\tau\), then \(\phi_\tau\vDash\phi_\sigma\)
       2. \(\phi_{\sigma,i}\vDash\neg\phi_{\sigma,1-i}\)
       3. \(\phi_\sigma(\calm)\) is infinite
       Let \(\phi_\emptyset\) be the formula \(v=v\). Suppose that we have a formula \(\phi_\sigma\) s.t. \(\phi_{\sigma}(\calm)\)
       is infinite. Because \(\phi_\sigma\)  is not minimal, we can find a formula \psi s.t. \((\phi_\sigma\wedge\psi)(\calm)\)
       and \((\phi_\sigma\wedge\neg\psi)(\calm)\) are both infinite. Let \(\phi_{\sigma,0}=\phi_\sigma\wedge\psi\) and let \(\phi_{\sigma,1}=\phi_\sigma\wedge\neg\psi\). As
       in Theorem ref:thm4.2.18 we can find a countable \(A\subseteq M\) s.t. \(\abs{S_1^{\calm}(A)}=2^{\aleph_0}\),
       contradicting \omega-stability
    2. Suppose not. Let \(\calm\prec\caln\), \(\barb\in N\) s.t. \(\psi(\caln,\barb)\) is an infinite coinfinite subset
       of \(\phi(\caln,\bara)\). Because \(\calm\) is \(\aleph_0\)-saturated, we can find \(\barb'\in M\)
       s.t. \(\tp^{\calm}(\bara,\barb')=\tp^{\caln}(\bara,\barb)\). Then \(\psi(\barv,\barb)\) defines an
       infinite coinfinite subset of \(\phi(\calm,\bara)\), a contradiction
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.1.14
    Suppose that \(T\) is an \(\call\)-theory with no Vaughtian pairs. Let \(\calm\vDash T\) and
    let \(\phi(v_1,\dots,v_k,w_1,\dots,w_m)\) be a formula with parameters from \(M\). There is a number \(n\)
    s.t. if \(\bara\in M\) and \(\abs{\phi(\calm,\bara)}>n\), then \(\phi(\calm,\bara)\) is infinite.
    #+END_lemma

    #+BEGIN_proof
    Suppose not. Then, for each \(n\in\N\), we can find \(\bara_n\) in \(M\) s.t. \(\phi(\calm,\bara_n)\) is a
    finite set of size at least \(n\). Consider the language \(\call^*=\call\cup\{U\}\) for pairs of models
    of \(T\) used in the proof of Lemma ref:lemma4.3.37, and let \(\Gamma(\barw)\supset T\) be the \(\call^*\)-type
    asserting:
    1. \(U\) defines a proper \(\call\)-elementary submodel
    2. \(\bigwedge_{i=1}^mU(w_i)\)
    3. there are infinitely many elements \(\barv\) s.t. \(\phi(\barv,\barw)\)
    4. \(\phi(\barv,\barw)\to\bigwedge_{i=1}^kU(v_i)\)


    Let \(\caln\) be a proper elementary extension of \(\calm\). Because \(\phi(\calm,\bara_n)\) is finite
    and \(\calm\prec\caln\), \(\phi(\calm,\bara_n)=\phi(\caln,\bara_n)\)
    #+LATEX: \wu{
    which realize 4
    #+LATEX: }
    . If \(\Delta\subseteq\Gamma(\barw)\) is finite, then by choosing \(n\)
    sufficiently large
    #+LATEX: \wu{
    to realize 3
    #+LATEX: }
    , \(\bara_n\) realizes \Delta in \((\caln,\calm)\). Thus by compactness, \Gamma is satisfiable.

    Suppose that \(\bara\) realizes \(\Gamma(\barw)\) in \((\caln',\calm')\) where \(\calm'\vDash T\) and \(\caln'\) is a
    proper elementary extension.
    #+LATEX: \wu{
    We can just add constants to make formulas into sentences.
    #+LATEX: }
    Then \(\phi(\calm',\bara)\) is an infinite set s.t. \(\phi(\calm',\bara)=\phi(\caln',\bara)\), contradicting the fact
    that there are no Vaughtian pairs of models of \(T\).
    #+END_proof

    Note that if \(n\) is as in Lemma ref:lemma6.1.14, then in any elementary extension \(\caln\)
    of \(\calm\), \(\abs{\phi(\caln,\barb)}\) is infinite whenever \(\abs{\phi(\caln,b)}>n\)

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor6.1.15
    If \(T\) has no Vaughtian pairs, then any minimal formula is strongly minimal
    #+END_corollary

    #+BEGIN_proof
    Let \(\phi(\barv)\) be a minimal formula over \(\calm\vDash T\) (possibly with parameters). Suppose, for
    purpose of contradiction, that there is an elementary \(\caln\) of \(\calm\), \(\barb\in N\), and
    an \(\call\)-formula \(\psi(\barv,\barw)\) s.t. \(\psi(\caln,\barb)\) is an infinite coinfinite subset
    of \(\phi(\caln)\).

    By Lemma ref:lemma6.1.14, there is a number \(n\) s.t. for any \(\calm\prec\caln'\)
    and \(\bara\in N'\), \(\psi(\caln',\bara)\) is an infinite coinfinite subset of \(\phi(\caln')\)
    iff \(\abs{\psi(\caln',\bara)\cap\phi(\caln')}>n\) and \(\abs{\neg\psi(\caln',\bara)\cap\phi(|caln')}>n\). But
    \begin{equation*}
    \calm\vDash\forall\barw(\abs{\psi(\calm,\barw)\cap\phi(\calm)}\le n\vee\abs{\neg\psi(\calm,\barw)\cap\phi(\calm)}\le n)
    \end{equation*}
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    If \(T\) is \omega-stable and has no Vaughtian pairs, then for any \(\calm\vDash T\) there is a strongly
    minimal formula over \(\calm\). In particular, there is a strongly minimal formula with parameters
    from \(\calm_0\), the prime model of \(T\).
    #+END_corollary
*** The Categoricity Theorem
    Our proof of categoricity will follow the argument in Theorem ref:thm6.1.11. We can find a
    strongly minimal formula \(\phi(v)\) over the prime model. If \(\calm\) and \(\caln\) are models of \(T\)
    of the same uncountable cardinality, then we can find a partial elementary bijection
    between \(\phi(\calm)\) and \(\phi(\caln)\). The next lemma allows to extend this to an isomorphism
    between \(\calm\) and \(\caln\).

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.1.17
    If \(T\) has no Vaughtian pairs, \(\calm\vDash T\), and \(X\subseteq M^n\) is infinite and definable, then no
    proper elementary submodel of \(\calm\) contains \(X\). If in addition, \(T\) is \omega-stable,
    then \(\calm\) is prime over \(X\)
    #+END_lemma

    #+BEGIN_proof
    Let \(\phi(\barv)\) defines \(X\). If \(\caln\) is a proper elementary submodel of \(\calm\)
    containing \(X\), then \(X=\phi(\calm)=\phi(\caln)\) and \((\calm,\caln)\) is a Vaughtian pair.

    If \(T\) is \omega-stable, then by Theorem ref:thm4.2.20, there is \(\caln\prec\calm\), a prime model over \(X\).
    Because \(T\) has no Vaughtian pairs, we must have \(\caln=\calm\), so \(\calm\) is prime over \(X\)
    #+END_proof

    We can now prove the Baldwin-Lachlan characterization of uncountably categorical theories and
    deduce Morley's Categoricity Theorem

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    Let \(T\) be a complete theory in a countable language with infinite models, and let \kappa be an
    uncountable cardinal. \(T\) is \kappa-categorical iff \(T\) is \omega-stable and has no Vaughtian pairs

    In particular, if \(T\) is \kappa-categorical for some uncountable cardinal, then \(T\) is
    \lambda-categorical for all uncountable cardinals \lambda
    #+END_theorem

    #+BEGIN_proof
    \(\Rightarrow\). If \(T\) is \kappa-categorical, then, by Corollaries ref:cor5.2.10 and
    ref:cor5.2.11, \(T\) is \omega-stable and has no Vaughtian pairs

    \(\Leftarrow\). Suppose \(T\) is \omega-stable and has no Vaughtian pairs. Because \(T\) is \omega-stable, it has a
    prime model \(\calm_0\). By Lemma ref:lemma6.1.13 and Corollary ref:cor6.1.15 , there is \(\phi(v)\), a
    strongly minimal formula with parameters from \(\calm_0\).

    Suppose that \(\calm\) and \(\caln\) are models of \(T\) of cardinality \(\kappa\ge\aleph_1\). We can view \(\calm\)
    and \(\caln\) as elementary extensions of \(\calm_0\). Then \(\dim(\phi(\calm))=\dim(\phi(\caln))=\kappa\). <<Problem9>>
    #+LATEX: \wu{
    As there is no Vaughtian pairs, \(\abs{\phi(\calm)}>\abs{\phi(\calm_0)}\) and \(\abs{\phi(\caln)}>\abs{\phi(\calm_0)}\).
    #+LATEX: }
    By Theorem
    ref:thm6.1.11 there is \(f:\phi(\calm)\to\phi(\caln)\), a partial elementary bijection. By Lemma
    ref:lemma6.1.17, \(\calm\) is prime over \(\phi(\calm)\). Thus we can extend \(f\) to an
    elementary \(f':\calm\to\caln\). But by Lemma ref:lemma6.1.17, \(\caln\) has no proper elementary submodels
    containing \(\phi(\caln)\). Thus \(f'\) is surjective and \(f'\) is an isomorphism

    Because the Baldwin-Lachlan characterization of \kappa-categorical theories does not depend on
    \kappa, \(T\) is \kappa-categorical for some uncountable cardinal iff \(T\) is \lambda-categorical for every
    uncountable cardinal \lambda
    #+END_proof

    The proof shows that if \(\calm_0\) is the prime model of \(T\), \(\phi(v)\) is a strongly minimal
    formula with parameters from some finite \(A\subset M_0\), \(\calm,\caln\vDash T\)
    and \(\dim(\phi(\calm)/A)=\dim(\phi(\caln)/A)\), then \(\calm\cong\caln\). Because there are only \(\aleph_0\) possibilities
    for \(\dim(\calm/A)\), we also get an upper bound on the number of countable models

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    If \(T\) is uncountably categorical, then \(I(T,\aleph_0)\le\aleph_0\)
    #+END_proposition

    Note that in the analysis above we did not assert that if \(\calm\cong\caln\),
    then \(\dim(\phi(\calm/A))=\dim(\phi(\caln)/A)\). This converse is true if \(A=\emptyset\). If \(\phi(v)\) is a strongly
    minimal \(\call\)-formula, then any isomorphism maps \(\phi(\calm)\) onto \(\phi(\caln)\).

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    Suppose that \(T\) is an \omega-stable \(\call\)-theory and \(\phi(v)\) is a strongly minimal \(\call\)-formula
    (with no additional parameters). Suppose that \(\calm\vDash T\) and \(\dim(\phi(\calm))=n<\aleph_0\). Then for
    all \(m\ge n\) there is \(\caln\vDash T\) with \(\dim(\phi(\caln))=m\)
    #+END_lemma

    #+BEGIN_proof
    Let \(\calm^*\vDash T\)  be an \omega-saturated elementary extension of \(\calm\). It is
    #+END_proof

** Morley Rank
    \(T\) is a complete theory with infinite models

    Suppose that \(K\) is an infinite field and \(V\subseteq K^n\) is an \(m\)-dimensional vector space.
    Suppose that \(f\) is a linear function that is not constant on \(V\). For \(a\in K\),
    let \(V_a=\{x\in V:f(x)=a\}\). Then \(\{V_a:a\in K\}\) is an infinite family of \((m-1)\)-dimensional
    affine subsets of \(V\). Morley rank is an attempt to generalize this property of dimension. The
    basic idea is that if a definable set \(X\) contains infinitely many pairwise disjoint sets of
    dimension \(m\), then \(X\) should have dimension at least \(m+1\).

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Suppose that \(\calm\) is an \(\call\)-structure and \(\phi(\barv)\) is an \(\call_M\)-formula. We will
    define \(\RM^{\calm}(\phi)\), the *Morley rank* of \phi in \(\calm\). First we inductively
    define \(\RM^{\calm}(\phi)\ge\alpha\) for \alpha an ordinal:
    1. \(\RM^{\calm}(\phi)\ge 0\) iff \(\phi(\calm)\) is nonempty
    2. if \alpha is a limit ordinal, then \(\RM^{\calm}(\phi)\ge\alpha\) iff \(\RM^{\calm}(\phi)\ge\beta\) for all \(\beta<\alpha\)
    3. for any ordinal \alpha, \(\RM^{\calm}(\phi)\ge\alpha+1\) iff there
       are \(\call_M\)-formulas \(\psi_1(\barv),\psi_2(\barv),\dots\) s.t. \(\psi_1(\calm),\psi_2(\calm),\dots\) is an infinite family
       of pairwise disjoint subsets of \(\phi(\calm)\) and \(\RM^{\calm}(\psi_i)\ge\alpha\) for all \(i\)


    If \(\phi(\calm)=\emptyset\), then \(\RM^{\calm}(\phi)=-1\). If \(\RM^{\calm}(\phi)\ge\alpha\) but \(\RM^{\calm}(\phi)\not\ge\alpha+1\),
    then \(\RM^{\calm}(\phi)=\alpha\). If \(\RM^{\calm}(\phi)\ge\alpha\) for all ordinals \alpha, then \(\RM^{\calm}(\phi)=\infty\)
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.2.2
    Suppose that \(\theta(\barv,\barw)\) is an \(\call\)-formula, \(\calm\)
    is \(\aleph_0\)-saturated, \(\bara,\barb\in M\) and \(\tp^{\calm}(\bara)=\tp^{\calm}(\barb)\).
    Then \(\RM^{\calm}(\theta(\barv,\bara))=\RM^{\calm}(\theta(\barv,\barb))\)
    #+END_lemma

    #+BEGIN_proof
    We prove by induction on \alpha that if \(\theta(\barv,\barw)\) is any \(\call\)-formula
    and \(\tp^{\calm}(\bara)=\tp^{\calm}(\barb)\), then \(\RM^{\calm}(\theta(\barv,\bara))\ge\alpha\)
    iff \(\RM^{\calm}(\theta(\barv,\barb))\ge\alpha\)

    Because \(\tp^{\calm}(\bara)=\tp^{\caln}(\barb)\), \(\theta(\calm,\bara)=\emptyset\) iff \(\calm\vDash\neg\exists\barx\theta(\barx,\bara)\)
    iff \(\calm\vDash\neg\exists\barx\theta(\barx,\barb)\) iff \(\theta(\calm,\barb)=\emptyset\)

    If \alpha is a limit ordinal, then it's trivial
    \begin{alignat*}{3}
    &\RM^{\calm}(\theta(\barv,\bara))\ge\alpha\quad&&\Leftrightarrow\quad&&\RM^{\calm}(\theta(\barv,\bara))\ge\beta\text{ for all }\beta<\alpha\\
    &&&\Leftrightarrow&&\RM^{\calm}(\theta(\barv,\barb))\ge\beta\text{ for all }\beta<\alpha\\
    &&&\Leftrightarrow&&\RM^{\calm}(\theta(\barv,\barb))\ge\alpha
    \end{alignat*}

    Suppose the claim is true for \alpha and \(\RM^{\calm}(\theta(\barv,\bara))\ge\alpha+1\). There
    are \(\call_M\)-formulas \(\psi_1,\psi_2,\dots\) s.t. \(\psi_1(\calm),\psi_2(\calm),\dots\) is an infinite sequence of pairwise
    disjoint subsets of \(\theta(\calm,\bara)\) and \(\RM^{\calm}(\psi_i)\ge\alpha\) for all \(i\). For each \(i\), there is
    an \(\call\)-formula \(\chi_i(\barv,w_1,\dots,w_{m_i})\) and \(\barc_i\in M^{m_i}\) s.t. \(\psi_i(\barv)\)
    is \(\chi_i(\barv,\barc_i)\). Because \(\calm\) is \(\aleph_0\)-saturated, we can do a _back-and-forth_
    <<Problem10>>
    argument to find \(\bard_1,\bard_2,\dots\) s.t.
    \begin{equation*}
    \tp^{\calm}(\bara,\barc_1,\dots,\barc_m)=\tp^{\calm}(\barb,\bard_1,\dots,\bard_m)
    \end{equation*}
    for all \(m<\omega\)
    #+LATEX: \wu{
    Check Proposition ref:prop4.3.3 if forgot.
    #+LATEX: }
    Then \(\chi_1(\calm,\bard_1),\chi_2(\calm,\bard_2),\dots\) is an infinite sequence of pairwise disjoint subsets
    of \(\theta(\calm,\barb)\). Thus \(\RM^{\calm}(\theta(\barv,\barb))\ge\alpha+1\)

    Consequently
    \begin{equation*}
    \RM^{\calm}(\theta(\barv,\bara))=\RM^{\calm}(\theta(\barv,\barb))
    \end{equation*}
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.2.3
    Suppose that \(\calm\) and \(\caln\) are \(\aleph_0\)-saturated models of \(T\) and \(\calm\prec\caln\). If \phi is
    an \(\call_M\)-formula, then \(\RM^{\calm}(\phi)=\RM^{\caln}(\phi)\).
    #+END_lemma

    #+BEGIN_proof
    Prove by induction on \alpha that if \phi is an \(\call_M\)-formula, then \(\RM^{\calm}(\phi)\ge\alpha\)
    iff \(\RM^{\caln}(\phi)\ge\alpha\).

    Because \(\calm\prec\caln\), \(\phi(\calm)=\emptyset\) iff \(\phi(\caln)=\emptyset\). Thus \(\RM^{\calm}(\phi)\ge 0\) iff \(\RM^{\caln}(\phi)\ge 0\)

    If \alpha is a limit ordinal...

    If \(\RM^{\calm}(\phi)\ge\alpha+1\), then we can find \(\call_M\)-formulas \(\psi_1,\psi_2,\dots\) s.t. \(\psi_1(\calm),\psi_2(\calm),\dots\) is
    an infinite sequence of pairwise disjoint subsets of \(\phi(\calm)\) and \(\RM^{\calm}(\psi_i)\ge\alpha\) for
    all \(i\). By induction, \(\RM^{\caln}(\psi_i)\ge\alpha\). Because \(\calm\prec\caln\), \(\psi_1(\caln),\psi_2(\caln),\dots\) is an infinite
    sequence of pairwise disjoint subsets of \(\phi(\caln)\)

    Suppose that \(\RM^{\caln}(\phi)\ge\alpha+1\). There are  \(\call_N\)-formulas \(\psi_1,\psi_2,\dots\) s.t. \(\psi_1(\caln),\psi_2(\caln),\dots\) is
    an infinite sequence of pairwise disjoint subsets of \(\phi(\caln)\) and \(\RM^{\caln}(\psi_i)\ge\alpha\) for
    all \(i\). Let \(\bara\) be the parameters from \(M\) occurring in the formula \phi.
    Let \(\psi_i(\barv)\) be \(\theta_i(\barv,\barb_i)\), where \(\theta_i\) is an \(\call\)-formula and \(\barb_i\in N\).
    Because \(\calm\) is \(\aleph_0\)-saturated, we can find \(\barc_1,\barc_2,\dots\) in \(M\) s.t.
    \begin{equation*}
    \tp^{\caln}(\bara,\barb_1,\dots,\barb_m)=\tp^{\calm}(\bara,\barc_1,\dots,\barc_m)=\tp^{\caln}(\bara,\barc_1,\dots,\barc_m)
    \end{equation*}
    for \(m<\omega\). By Lemma ref:lemma6.2.2, \(\RM^{\caln}(\theta_i(\barv,\barc_i))\ge\alpha\). By
    induction, \(\RM^{\calm}(\theta_i(\barv,\barc_i))\ge\alpha\). Consequently, \(\RM^{\calm}(\phi)\ge\alpha+1\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    label:cor6.2.4
    Suppose that \(\calm\) is an \(\call\)-structure, \phi is an \(\call_M\)-formula, and \(\caln_0\) and \(\caln_1\)
    are \(\aleph_0\)-saturated elementary extensions of \(\calm\). Then \(\RM^{\caln_0}(\phi)=\RM^{\caln_1}(\phi)\)
    #+END_corollary

    #+BEGIN_proof
    By Exercise ref:ex2.5.11 there is \(\caln_2\), a common elementary extension of \(\caln_0\) and \(\caln_1\).
    Let \(\caln_3\) be an \(\aleph_0\)-saturated elementary extension of \(\caln_2\). By Lemma
    ref:lemma6.2.3, \(\RM^{\caln_0}(\phi)=\RM^{\caln_3}(\phi)=\RM^{\caln_1}(\phi)\)
    #+END_proof

    Corollary ref:cor6.2.4 allows us to define the Morley rank of \phi in a way that does not depend on
    which model contains the parameters occuring in \phi

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    If \(\calm\) is an \(\call\)-structure and \phi is any \(\call\)-formula, we define \(\RM(\phi)\), the *Morley rank*
    of \phi, to be \(\RM^{\caln}(\phi)\), where \(\caln\) is any \(\aleph_0\)-saturated elementary extension of \(\calm\)
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    Suppose that \(\calm\vDash T\) and \(X\subseteq M^n\) is defined by the \(\call_M\)-formula \(\phi(\barv)\). We
    let \(\RM(X)\), the *Morley rank* of \(X\), be \(\RM(\phi)\)
    #+END_definition

    In particular, if \(\calm\) is \(\aleph_0\)-saturated and \(X\subseteq M^n\) is definable, then \(\RM(X)\ge\alpha+1\) iff
    we can find \(Y_1,Y_2,\dots\) pairwise disjoint definable subsets of \(X\) of Morley rank at least
    \alpha

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.2.7
    Let \(\calm\) be an \(\call\)-structure and let \(X\) and \(Y\) be definable subsets of \(M^n\)
    1. If \(X\subseteq Y\), then \(\RM(X)\le\RM(Y)\)
    2. \(\RM(X\cup Y)\) is the maximum of \(\RM(X)\) and \(\RM(Y)\)
    3. If \(X\) is nonempty, then \(\RM(X)=0\) iff \(X\) is finite
    #+END_lemma

    #+BEGIN_proof
    1. If \(X=\phi(\calm)\) and \(Y=\psi(\calm)\). \(X\subseteq Y\) means \(\calm\vDash\forall \barx(\phi(\barx)\to\psi(\barx))\). If \(\RM(\phi)\) has an
        infinite sequence \(\theta_1(\barx),\theta_2(\barx),\dots\), the sequence is also the infinite pairwise
       disjoint sequence for \(\RM(\psi)\).
    2. W.L.O.G, assume \(\RM(X)>\RM(Y)\), then \(\RM(X\cup Y)\ge\RM(X)>\RM(Y)=\alpha\) by 1.
       Suppose \(\RM(X\cup Y)=\gamma\). For any \(\alpha<\beta<\gamma\), we have \(\psi_1(\caln),\psi_2(\caln),\dots\) an infinite family of
       pairwise disjoint subsets of \(\varphi(\caln)\) and \(\RM(\psi_i)=\beta>\alpha\). Thus there is no infinite
       subsequence of \(Y\), hence there is an infinite subsequence \(X\cup Y-Y\). Thus \(\RM(X\cup Y)\le \RM(X)\).
    3. Let \(X=\phi(\calm)\). Because \(X\) is nonempty, \(\RM(\phi)\ge 0\). Because \(\phi(\calm)\) is finite
       iff \(\phi(\caln)\) is finite for any \(\calm\prec\caln\), we may, W.L.O.G., assume that \(\calm\)
       is \(\aleph_0\)-saturated. If \(X\) is finite, then, because \(X\) cannot be partitioned into
       infinitely many nonempty sets, \(\RM(X)\not\ge 1\). Thus \(\RM(X)=0\). If \(X\) is infinite,
       let \(a_1,a_2,\dots\) be distinct elements of \(X\). Then
       \(\{a_1\},\{a_2\},\dots\) is an infinite sequence of pairwise disjoint definable subsets of \(X\).
       Thus \(RM(X)\ge 1\).
    #+END_proof

    [[index:totally transcendental]]
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    A theory \(T\) is called *totally transcendental* if, for all \(\calm\vDash T\), if \phi is
    an \(\call_M\)-formula, then \(\RM(\phi)<\infty\)
    #+END_definition
*** The Monster Model
    Let \(\M\vDash T\) be saturated of cardinality \kappa, where \kappa is "very large". We call \(\M\) the *monster
    model* of \(T\). If \(\calm\vDash T\) and \(\abs{\M}\le\kappa\), then by Lemma ref:lemma4.3.17 there is an
    elementary embedding of \(\calm\) into \(\M\). Moreover, if \(\calm\prec\M\), \(f:\calm\to\caln\) is elementary,
    and \(\abs{N}<\kappa\), we can find \(j:\caln\to\M\) elementary s.t. \(j|M\) is the identity. Thus, if we
    focus attention on models of \(T\) of cardinality less than \kappa, we can view all models as
    elementary submodels of \(\M\).

    There are several problems with this approach.
    1. We want to prove theorems about all models of \(T\), not just the small ones.

       But if there are arbitrarily large saturated models of \(T\), then we can prove something
       about all models of \(T\) by proving it for submodels of larger and larger monster models

    2. For general theories \(T\) there may not be any saturated models.

        For the remainder of this text, we will be focusing on \omega-stable theories, and, by Theorem
        ref:thm4.3.15, there are saturated models of \(T\) of cardinality \kappa for each regular
       cardinal \kappa.


    For the remainder of the chapter, we make the following assumptions:
    * \(\M\) is a large saturated model of \(T\)
    * all \(\calm\vDash T\) that we consider are elementary submodels of \(\M\) and \(\abs{M}<\abs{\M}\)
    * all sets \(A\) of parameters that we consider are subsets of \(\M\) with \(\abs{A}<\M\)
    * if \(\phi(\barv,\bara)\) is a formula with parameters, we assume \(\bara\in\M\)
    * we write \(\tp(\bara/A)\) and \(S_n(A)\) for \(S_n^{\M}(A)\)


    Note that if \(\bara\in M\), then because \(\calm\prec\M\), \(\calm\vDash\phi(\bara)\) iff \(\M\vDash\phi(\bara)\). We will say
    that \(\phi(\bara)\) holds if \(\M\vDash\phi(\bara)\).

    Because \(\M\) is saturated, if \(A\subset\M\) and \(p\in S_n(A)\), then \(p\) is realized in \(\M\).
    Moreover, if \(f:A\to\M\) is a partial elementary map, then \(f\) extends to an automorphism
    of \(\M\).

    We could define Morley rank referring only to the monster model. The Morley rank of
    an \(\call_{\M}\)-formula is inductively defined as follows
    1. \(\RM(\phi)\ge 0\) iff \(\phi(\M)\) is nonempty
    2. \(\RM(\phi)\ge\alpha+1\) iff there are \(\call_{\M}\)-formulas \(\psi_1,\psi_2,\dots\) s.t. \(\psi_1(\M),\psi_2(\M),\dots\) is an
       infinite sequence of pairwise disjoint subsets of \(\phi(\M)\) and \(\RM(\psi_i)\ge\alpha\) for each \(i\).
    3. if \alpha is a limit ordinal, \(\RM(\phi)\ge\alpha\) iff \(\RM(\phi)\ge\beta\) for each \(\beta<\alpha\)

*** Morley Degree
    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    Let \phi be an \(\call_{\M}\)-formula with \(\RM(\phi)=\alpha\) for some ordinal \alpha. There is a natural
    number \(d\) s.t. if \(\psi_1,\dots\psi_n\) are \(\call_{\M}\)-formulas s.t. \(\psi_1(\M),\dots,\psi_n(\M)\) are disjoint
    subsets of \(\phi(\M)\) s.t. \(\RM(\psi_i)=\alpha\) for all \(i\), then \(n\le d\).

    We call \(d\) the *Morley degree* of \phi and write \(\deg_M(\phi)=d\)
    #+END_proposition

    #+BEGIN_proof
    We build \(S\subseteq 2^{<\omega}\) and \((\phi_\sigma:\sigma\in S)\) with the following properties
    1. If \(\sigma\in S\) and \(\tau\subseteq\sigma\), then \(\tau\in S\)
    2. \(\phi_\emptyset=\phi\)
    3. \(\RM(\phi_\sigma)=\alpha\) for all \(\sigma\in S\)
    4. If \(\sigma\in S\), there are two cases to consider. If there is an \(\call_{\M}\)-formula \psi
       s.t. \(\RM(\phi_\sigma\wedge\psi)=\RM(\phi_\sigma\wedge\neg\psi)=\alpha\), then \(\sigma,0\) and \(\sigma,1\) are in \(S\), \(\phi_{\sigma,0}=\phi_\sigma\wedge\psi\)
       and \(\phi_{\sigma,1}=\phi_\sigma\wedge\neg\psi\). If there is no such \psi, then no \(\tau\supset\sigma\) is in \(S\)


    The set \(S\) is a binary tree. We claim that \(S\) is finite. If \(S\) is infinite, then, by
    Kőnig's Lemma (Lemma ref:lemmaA.21), there is \(f:\omega\to 2\) s.t. \(f|n\in S\) for all \(n\).
    Let \(\psi_n\) be the formula \(\phi_{f|n}\wedge\neg\phi_{f|n+1}\) for \(n=1,2,\dots\). Then \(\RM(\psi_n)=\alpha\) for
    all \(n\)
    #+LATEX: \wu{
    \(\phi_{f\mid n+1}=\phi_{f\mid n}\wedge\psi\) for some \psi and \(\psi_n=\phi_{f\mid n}\wedge(\neg\phi_{f\mid n}\vee\neg\psi)=\phi_{f\mid n}\vee\neg\psi\supseteq\phi_{f\mid n}\) which has
    Morley rank at least \alpha
    #+LATEX: }
    and \(\psi_1(\M),\psi_2(\M),\dots\) are disjoint subsets of \(\phi(\M)\). But then \(\RM(\phi)\ge\alpha+1\), a
    contradiction. Thus \(S\) is finite

    Let \(S_0=\{\sigma\in S:\tau\notin S\text{ for all }\tau\supset\sigma\}\) be the terminal nodes of the tree \(S\).
    Let \(d=\abs{S_0}\) and let \(\psi_1,\dots,\psi_d\) be an enumeration of \(\{\phi_\sigma:\sigma\in S_0\}\).
    Then \(\RM(\psi_i)=\alpha\) for all \(i\), \(\phi(\calm)\) is the disjoint union of \(\psi_1(\M),\dots,\psi_d(\M)\) and for
    each \(i\), there is no formula \chi s.t. \(\RM(\psi_i\wedge\chi)=\RM(\psi_i\wedge\neg\chi)=\alpha\).

    Suppose that \(\theta_1,\dots,\theta_n\) is a sequence of \(\call_{\M}\)-formulas of Morley rank \alpha
    s.t. \(\theta_1(\M),\dots,\theta_n(\M)\) is a sequence of pairwise disjoint subsets of \(\phi(\M)\). We claim
    that \(n\le d\). By our choice of \(\psi_1,\dots,\psi_d\), for each \(i\le d\), there is at most one \(j\le n\)
    s.t. \(\RM(\psi_i\wedge\theta_j)=\alpha\).  If \(n>d\), there is \(\hatj\le n\) s.t. \(\RM(\psi_i\wedge\theta_{\hatj})<\alpha\) for
    all \(i\le d\). But
    \begin{equation*}
    \M\vDash\theta_{\hatj}\leftrightarrow\bigvee_{i=1}^d\psi_i\wedge\theta_{\hatj}
    \end{equation*}
    Thus by Lemma ref:lemma6.2.7, \(\RM(\theta_{\hatj})<\alpha\), a contradiction
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    A formula \phi is strongly minimal iff \(\RM(\phi)=\deg_M(\phi)=1\)
    #+END_corollary

    #+BEGIN_proof
    If \phi is strongly minimal, then, because \(\phi(\M)\) is infinite, \(\RM(\phi)\ge 1\). Because \(\phi(\M)\)
    cannot be partitioned into two definable infinite sets, \(\RM(\phi)=1\) and \(\deg_M(\phi)=1\)

    On the other hand, if \(\RM(\phi)=\deg_M(\phi)=1\), then \(\phi(\M)\) is infinite and cannot be
    partitioned into two infinite definable sets. Thus \(\phi\) is strongly minimal
    #+END_proof

    Recall from Exercise ref:ex5.5.6 that a formula \(\phi(\barv,\barw)\) has the *order property* if
    there are \(\bara_1,\barb_1,\bara_2,\barb_2,\dots\) in \(\M\) s.t. \(\M\vDash\phi(\bara_i,\barb_j)\) iff \(i<j\)

    #+ATTR_LATEX: :options []
    #+BEGIN_proposition
    If \(T\) is totally transcendental, then no formula has the order property
    #+END_proposition

    #+BEGIN_proof
    Suppose \(\phi(\barv,\barw)\) has the order property. By compactness and saturation, we can
    find \((\bara_q,\barb_q:q\in\Q)\) s.t. \(\M\vDash\phi(\bara_q,\barb_r)\) iff \(q<r\).
    #+LATEX: \wu{
    Add those constants and consider \(p(\bara_q,\barb_q)=\Diag_{\el}(\M)\cup\{\phi(\bara_q,\barb_q)\mid q\in\Q\}\)

    This is satisfiable by compactness and by viewing \((\bara_q,\barb_q)_{q\in\Q}\) as variables, this type
    are realised in \(\M\)
    #+LATEX: }
    Note that \(\{q\in\Q:\phi(\bara_q,\barb_r)\}=(-\infty,r)\) is an infinite convex set. Thus there
    is \(\psi(\barv)\), an \(\call_{\M}\)-formula of minimal rank and degree s.t. \(C=\{q\in\Q:\M\vDash\psi(\bara_q)\}\)
    is an infinite convex set.
    #+LATEX: \wu{
    \(S=\{\phi:\{q\in\Q:\phi(\bara_q,\barb_r)\}\text{ is an infinite convex set}\}\) is nonempty and thus has
    element with minimal rank and degree.
    #+LATEX: }
    Choose \(r\) in the interior of \(C\). Let \(\psi_0(\barv)\) be \(\psi(\barv)\wedge\phi(\barv,\barb_r)\), and
    let \(\psi_1(\barv)\) be \(\psi(\barv)\wedge\neg\phi(\barv,\barb_r)\). The set \(\{q\in\Q:\psi_i(\bara_q)\}\) is infinite
    and convex for \(i=0,1\), and if neither \(\psi_i\) has lower Morley rank than \psi, then both have
    lower Morley degree, a contradiction
    #+LATEX: \wu{
    So we actually build a tree:D
    #+LATEX: }
    #+END_proof
*** Ranks of Types
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    If \(p\in S_n(A)\), then \(\RM(p)=\inf\{\RM(\phi):\phi\in p\}\). If \(\RM(p)\) is an ordinal,
    then \(\deg_M(p)=\inf\{\deg_M(\phi):\phi\in p\wedge\RM(\phi)=\RM(p)\}\)
    #+END_definition

    If \(\RM(p)<\infty\), then \((\RM(p),\deg_M(p))\) is the minimum element
    of \(\{(\RM(\phi),\deg_M(\phi)):\phi\in p\}\) in the lexicographic order. For each type \(p\)
    with \(\RM(p)<\infty\), we can find a formula \(\phi_p\in p\)
    s.t. \((\RM(p),\deg_M(p))=(\RM(\phi_p),\deg_M(\phi_p))\).

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    If \(p,q\in S_n(A)\), \(\RM(p),\RM(q)<\infty\), and \(p\neq q\), then \(\phi_p\neq\phi_q\)
    #+END_lemma

    #+BEGIN_proof
    There is a formula \psi s.t. \(\psi\in p\) and \(\psi\notin q\).
    Because \(\phi_p\wedge\psi\in p\), \(\RM(\phi_p\wedge\psi)\le\RM(\phi_p)\le\RM(p)\). Because \(\RM(\phi_p)\) is minimal
    \begin{equation*}
    \RM(\phi_p\wedge\psi)=\RM(\phi_p)=\RM(p)
    \end{equation*}
    Similarly
    \begin{equation*}
    \RM(\phi_q\wedge\neg\psi)=\RM(\phi_q)=\RM(q)
    \end{equation*}
    If \(\phi_p=\phi_q\), then
    \begin{equation*}
    \RM(\phi_p\wedge\psi)=\RM(\phi_p\wedge\neg\psi)=\RM(\phi_p)
    \end{equation*}
    Thus \(\deg_M(\phi_p\wedge\psi)<\deg_M(\phi_p)\)
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    If \(T\) is \omega-stable, then \(T\) is totally transcendental. Conversely, if \(\call\) is countable
    and \(T\) is totally transcendental, then \(T\) is \omega-stable
    #+END_theorem

    #+BEGIN_proof
    \(\Rightarrow\). Suppose \(\phi(v_1,\dots,v_n)\) is an \(\call_{\M}\)-formula s.t. \(\RM(\phi)=\infty\).
    Let \(\beta=\sup\{\RM(\psi):\psi\text{ an $\call_{\M}$-formula and }\RM(\psi)<\infty\}\)

    Because \(\RM(\phi)=\infty\ge\beta+2\), we can find an \(\call_{\M}\)-formula \psi s.t. \(\RM(\phi\wedge\psi)\ge\beta+1\)
    and \(\RM(\phi\wedge\neg\psi)\ge\beta+1\)
    #+LATEX: \wu{
    As there is pairwise disjoint \(\phi\wedge\psi_1(\M),\phi\wedge\psi_2(\M),\dots\), then \(\RM(\phi\wedge\psi)=\beta+1\) and for \(\phi\wedge\neg\psi_1\)
    contains \(\phi\wedge\psi_2,\phi\wedge\psi_3,\dots\) and thus \(\RM(\phi\wedge\neg\psi)\ge\beta+2\ge\beta+1\)
    #+LATEX: }
    Then \(\RM(\phi\wedge\psi)=\RM(\phi\wedge\neg\psi)=\infty\).

    Iterating this construction we can build a binary tree of \(\call_{\M}\)-formulas \((\phi_\sigma:\sigma\in 2^{<\omega})\)
    s.t.
    1. \(\phi_\emptyset=\phi\)
    2. \(\RM(\phi_\sigma)=\infty\) for all \sigma
    3. for each \sigma there is a formula \(\psi_\sigma\) s.t. \(\phi_{\sigma,0}=\phi_\sigma\wedge\psi_\sigma\) and \(\phi_{\sigma,1}=\phi_\sigma\wedge\neg\psi_\sigma\)


    There is a countable \(A\subseteq M\) s.t. \(\phi_\sigma\) is an \(\call_A\)-formula but \(\abs{S_n(A)}=2^{\aleph_0}\)
    so \(T\) is not \omega-stable

    \(\Leftarrow\). Suppose that \(\abs{A}\le\aleph_0\). For each \(p\in S_n(A)\), \(\RM(p)<\infty\) so there is \(\phi_p\) as
    above. Because \(\phi_p\neq\phi_q\) for \(p\neq q\) and there are only countably many choices
    for \(\phi_p\), \(\abs{S_n(A)\le\aleph_0}\). Thus \(T\) is \omega-stable
    #+END_proof

    *Because we are concentrating on theories in countable languages, we will not mention totally
    transcendental theories again*

    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    If \(A\subset\M\) and \(\bara\in\M\), we write \(\RM(\bara)\) for \(\RM(\tp(\bara))\) and \(\RM(\bara/A)\)
    for \(\RM(\tp(\bara/A))\)
    #+END_definition

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    <<Problem11>>
    label:lemma6.2.16
    1. If \(X\subseteq\M^n\) is definable,
       then \(\RM(X)=\sup\{\RM(\bara/A):\bara\in X,A\subseteq\M,\abs{A}<\abs{\M},X\text{ is }A\text{-definable}\}\)
    2. If \(X\subseteq\M^n\) is definable, and \(\beta<\RM(X)\), then there is a definable \(Y\subset X\)
       with \(\RM(Y)=\beta\). In particular, if \(\RM(X)=\alpha\) and \(\beta<\alpha\) we can find disjoint definable
       sets \(Y_1,Y_2,\dots\) s.t. each \(Y_i\) has Morley rank \beta
    3. For any \(\call_A\)-formula \phi, \(\abs{\{p\in S_n(\M):\phi\in p\text{ and }\RM(p)=\RM(\phi)\}}=\deg_{\M}(\phi)\)
    #+END_lemma

    #+LATEX: \wu{
    Tent's Lemma 6.2.11
    #+LATEX: }

    #+BEGIN_proof
    1. If \(X\subseteq\M^n\) is \(A\)-definable, then \(X=\varphi(\M)\) for some \(L(A)\)-formula \varphi.

       If \(\RM(\varphi)=\infty\), then \(\{\varphi\}\cup\{\neg\psi\mid\psi\in L(A),\RM(\psi)<\infty\}\) is consistent. Any type over \(A\)
       containing this set of formulas has rank \(\infty\)

       If \(\RM(\varphi)=\alpha\), there is a decomposition of \varphi in \(L(A)\)-formulas \(\varphi_1,\dots,\varphi_k\), \alpha-minimal
       over \(A\) (\(k\) is bounded by \(\MD(\varphi)\)). Each of which determine a unique type of rank \alpha
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    label:lemma6.2.17
    Suppose that \(A\subset\M\), \(\bara,b\in\M\) and \(b\) is algebraic over \(A\cup\{\bara\}\). Then \(\RM(\bara,b/A)=\RM(\bara/A)\)
    #+END_lemma

    #+BEGIN_proof
    W.L.O.G., we will assume that \(A=\emptyset\). We leave as an exercise the proof
    that \(\RM(\bara,b)\ge\RM(\bara)\) (Exercise ref:ex6.6.11).
    We will prove by induction on \alpha that if \(\bara,b\in\M\), \(b\) is algebraic over \(\bara\), and
    if \(\RM(\bara,b)\ge\alpha\), then \(\RM(\bara)\ge\alpha\).

    By Exercise ref:ex6.6.10, \(\RM(\bara)\ge 0\). Thus the claim is true for \(\alpha=0\). If \alpha is a limit
    ordinal and the claim is true for all \(\beta<\alpha\)

    Suppose that the claim is true for \alpha and \(\RM(\bara,b)\ge\alpha+1\). By induction \(\RM(\bara)\ge\alpha\).
    Suppose, for purpose of contradiction, that \(\RM(\bara)=\alpha\). Let \(\phi(\barv)\) be
    an \(\call\)-formula s.t. \(\RM(\phi(\barv))=\alpha\) and there is no \(\call\)-formula \(\phi_1\)
    s.t. \(\RM(\phi\wedge\phi_1)=\RM(\phi\wedge\neg\phi_1)=\alpha\)
    #+LATEX: \wu{
    so \phi is actually \(\phi_{\tp(\bara)}\)
    #+LATEX: }

    Because \(b\) is algebraic over \(\bara\), there is a formula \(\psi(\barv,w)\) s.t. \(\psi(\bara,b)\)
    and \(\abs{\{x:\psi(\bara,x)\}}=n\). Let \(\hatphi(\barv,w)\) be the formula
    \begin{equation*}
    \phi(\barv)\wedge\psi(\barv,w)\wedge\abs{\{x:\psi(\barv,x)\}}=n
    \end{equation*}
    Because \(\hatphi(\bara,b)\) holds and \(\RM(\bara,b)>\alpha\), \(\RM(\hatphi)>\alpha\). Suppose
    that \(\theta_1,\theta_2,\dots\) are \(\call_{\M}\)-formulas s.t. \(\theta_1(\M),\theta_2(\M),\dots\) is a sequence of disjoint subsets
    of \(\hatphi(\M)\) and \(\RM(\theta_i)\ge\alpha\) for all \(i\). Let \(\chi_i(\barv)\) be the
    formula \(\exists w\;\theta_i(\barv,w)\).

    *Claim 1*. \(\RM(\chi_i)\ge\alpha\) for all \(i\)

    Because \(\RM(\theta_i)\ge\alpha\), there is \(\barc,d\in\M\) s.t. \(\theta_i(\barc,d)\) and \(\RM(\barc,d)\ge\alpha\).
    #+LATEX: \wu{
    Each \varphi of rank \(\beta\ge\alpha\) is equivalent to a disjunction of finitely many pairwise disjoint
    \beta-strongly minimal formulas \(\varphi_1,\dots,\varphi_d\). And each \(\varphi_i\) determines a unique type of rank \beta.
    Thus we can find such types.

    Also a remark, consider \(\RM(\varphi(\barx,y))\) and \(\RM(\exists y\;\varphi(\barx,y))\).

    Suppose \(\RM(\varphi(\barx,y))\) has a infinite family of disjoint
    subsets \(\varphi_1(\M),\varphi_2(\M),\dots\). \(\exists y\;\varphi_1(\M,y),\exists y\;\varphi_2(\M,y),\dots\) may not be still disjoint

    But the converse is true. Thus if \(\RM(\exists y\;\varphi(\barx,y))\ge\alpha\) then \(\RM(\varphi(\barx,y))\ge\alpha\).
    So \(\RM(\exists y\;\varphi(\barx,y))\le\RM(\varphi(\barx,y))\)
    #+LATEX: }
    By induction, \(\RM(\barc)\ge\alpha\)
    #+LATEX: \wu{
    \(d\) is algebraic over \(\barc\) since \(\theta_i(\M)\subset\hatphi(\M)\) and \(\hatphi(\barc,d)\)
    #+LATEX: }
    Because \(\chi_i(\barc)\), \(\RM(\chi_i)\ge\alpha\).

    *Claim 2*. \(\RM(\chi_1\wedge\dots\chi_m)\ge\alpha\) for all \(m\)

    Suppose that \(m\) is the least s.t. this fails. Then
    \begin{equation*}
    \RM(\chi_1\wedge\dots\wedge\chi_{m-1}),\RM\left( \chi_m\wedge\neg\bigwedge_{i=1}^{m-1}\chi_i \right)\ge\alpha
    \end{equation*}
    #+ATTR_LATEX: :width .5\textwidth
    #+NAME: Illustration
    #+CAPTION:
    [[../images/ModelTheoryAnIntroduction/1.jpg]]
    contradicting our assumption that we cannot find an \(\call\)-formula \(\phi_1\) s.t. \(\phi\wedge\phi_1\)
    and \(\phi\wedge\neg\phi_1\) both have rank \alpha
    #+LATEX: \wu{
    \(\chi_i(\M)\subset\phi(\M)\). Hence \(\RM(\bigwedge_{i=1}^{m-1}\chi_i)\ge\alpha\), \(\RM(\neg\bigwedge_{i=1}^{m-1}\chi_i)\ge\RM(\chi_m\wedge\neg\bigwedge\chi_i)\ge\alpha\). But
    as \(\RM(\phi)=\alpha\). Hence \(\RM(\bigwedge\chi_i)=\RM(\neg\wedge\chi_i)=\alpha\)
    #+LATEX: }

    Because  \(\M\) is saturated, we can find \(\barc\in\M\) s.t. \(\chi_i(\barc)\) for all \(i\)
    #+LATEX: \wu{
    they are finitely satisfiable since \(\RM(\bigwedge\chi_i)\ge\alpha\).
    #+LATEX: }
    For each \(i\), we can find \(d_i\) s.t. \(\theta_i(\barc,d_i)\). Because the \(\theta_i(\M)\) are
    disjoint, \(d_1,d_2,\dots\) are distinct. But \(\theta_i(\M)\subseteq\hatphi(\M)\). Thus \(\psi(\barc,d_i)\) holds for
    all \(i\), contradicting the fact that \(\abs{\{x:\psi(\barc,x)\}}=n\). Thus \(\RM(\bara)\ge\alpha+1\) and
    the lemma follows by induction
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_corollary
    Suppose that \(T\) is \omega-stable, \(\calm\vDash T\), \(X\subseteq\M^n\), \(Y\subseteq\M^m\) are definable, and \(f:X\to Y\) is a
    definable finite-to-one function from \(X\) onto \(Y\). Then \(\RM(X)=\RM(Y)\)
    #+END_corollary

    #+BEGIN_proof
    Let \(A\subset\M\) s.t. \(X,Y\) and \(f\) are definable over \(A\). Suppose that \(f(\bara)=\barb\).
    Then \(\barb\) is definable over \(A,\bara\) and, because \(f\) is finite-to-one, \(\bara\) is
    algebraic over \(A,\barb\). By Lemma ref:lemma6.2.17
    \begin{equation*}
    \RM(\bara/A)=\RM(\bara,\barb/A)=\RM(\barb/A)
    \end{equation*}
    #+LATEX: \wu{
    Definabillity is a strongly than algebraicality
    #+LATEX: }
    If \(\bara\in X\) s.t. \(\RM(\bara/A)=\RM(X)\) by Lemma ref:lemma6.2.16 then
    \begin{equation*}
    \RM(Y)\ge\RM(f(\bara)/A)=\RM(\bara/A)=\RM(X)
    \end{equation*}

    On the other hand, if \(\barb\in Y\) s.t. \(\RM(\barb/A)=\RM(Y)\), then, because \(f\) is
    surjective, there is \(\bara\in X\) s.t. \(f(\bara)=\barb\) and
    \begin{equation*}
    \RM(X)\ge\RM(\bara/A)=\RM(\barb/A)=\RM(Y)
    \end{equation*}
    Hence \(\RM(X)=\RM(Y)\)
    #+END_proof
*** Morley Rank in Strongly Minimal Theories
    #+ATTR_LATEX: :options []
    #+BEGIN_theorem
    Suppose that \(T\) is a strongly minimal theory. If \(A\subseteq\M\) and \(\bara\in\M\), then \(\RM(\bara/A)=\dim(\bara/A)\)
    #+END_theorem

    1#+BEGIN_proof
    We will first show by induction that if \(a_1,\dots,a_k\) are independent over \(A\),
    then \(\RM(\bara/A)=k\). We prove this by induction

    Suppose that \(k=1\). If \(\phi(v)\in\tp(a/A)\), then, because \(a\notin\acl(A)\), \(\phi(\M)\) is infinite
    and \(\RM(\phi)\ge 1\). Because \(T\) is strongly minimal, \(\RM(v=v)=1\). Thus \(\RM(\phi)\le 1\).

    Suppose \(k>1\) and \(a_1,\dots,a_k\) are independent over \(A\). Let \(\phi(\barv)\in\tp(\bara/A)\) be a
    formula of minimal Morley rank. We first argue that \(\RM(\bara/A)\ge k\). Let \(b_1,b_2,\dots\) be
    distinct elements of \(\M\) that are not in \(\acl(A)\).
    #+LATEX: \wu{
    \(\abs{\acl(A)}\le\max\{\abs{A},\abs{T}\}<\abs{\M}\).
    #+LATEX: }
    Let \(\psi_i(\barv)\) be the formula \(\phi(\barv)\wedge v_1=b_i\)
    #+LATEX: \wu{
    \(\phi(\M)\) is cofinite. If \(\M\vDash\neg\phi(b_i)\), then \(b_i\) is algebraic over \(A\), a contradiction
    #+LATEX: }
    Clearly \(\psi_1(\M),\psi_2(\M),\dots\) is a family of pairwise disjoint subsets of \(\phi(\M)\). If \(c_2,\dots,c_k\)
    are independent over \(A\cup\{b_i\}\) (existence by Lemma ref:lemma6.1.9) then by Lemma
    ref:lemma6.1.6, \(\tp(b_i,\barc/A)=\tp(a_1,\dots,a_k/A)\). In particular, \(\M\vDash\phi(b_i,\barc)\).
    Thus \(\M\vDash\psi_i(b_i,\barc)\). Then
    \begin{equation*}
    \RM(\psi_i)\ge\RM(b_i,\barc/A)\ge\RM(\barc/A)
    \end{equation*}
    and by induction, \(\RM(\barc/A)\ge k-1\). Thus \(\RM(\psi_i)\ge k-1\) and \(\RM(\phi)\ge k\).
    Hence \(\RM(\bara/A)\ge k\).

    Next we show that \(\RM(\bara/A)\le k\). Let \(\calm\) be an \(\aleph_0\)-saturated model containing \(A\).
    If \(d_1,\dots,d_k\) are independent over \(M\), then, by Lemma
    ref:lemma6.1.6, \(\tp^{\M}(\bara/A)=\tp^{\calm}(\bard/A)\) so we may assume W.L.O.G. that \(a_1,\dots,a_k\) are
    independent over \(M\). Suppose that \(\psi(\barv)\) is an \(\call_M\)-formula s.t. \(\psi(\M)\subset\phi(\M)\)
    and \(\neg\psi(\bara)\).
    #+LATEX: \wu{
    e.g. \(\psi(\barx):=\phi\wedge\barx\neq\bara\)
    #+LATEX: }
    It suffices to show that \(\RM(\psi)<k\).
    #+LATEX: \wu{
    \(\psi(\M)\subset\phi(\M)\) and \(\neg\psi(\bara)\) means that \(\RM(\psi)<\RM(\varphi)\). Since for
    any \(\psi\in\tp(\bara/M)\), \(\RM(\psi)\ge\RM(\varphi)\). Thus if we prove for all such \psi \(\RM(\psi)<k\)
    then \(\RM(\varphi)\le k\).
    #+LATEX: }
    If \(\psi(\barb)\), then because \(\tp(\barb/M)\neq\tp(\bara/M)\), \(b_1,\dots,b_k\) are dependent over \(M\). By permuting
    variables, we may assume that \(b_k\in\acl(M,b_1,\dots,b_{k-1})\). Let \(\theta(\barv)\) be
    an \(\call_M\)-formula s.t. \(\abs{\{w:\theta(b_1,\dots,b_{k-1},w)\}}=s\) for some \(s<\omega\). Let \(\psi'\) be
    \begin{equation*}
    \psi(\barv)\wedge\abs{\{w:\theta(v_1,\dots,v_{k-1},w)\}}=s
    \end{equation*}
    #+LATEX: \wu{
    Now we prove that \(\RM(\psi')=\RM(\psi)\).

    We prove \(\RM(\psi')\ge\alpha\) iff \(\RM(\psi)\ge\alpha\) by induction on \alpha.

    If \(\RM(\psi)\ge 0\), then also \(\RM(\psi')\ge 0\)

    Suppose \psi has a infinite family of pairwise disjoint \(\psi_i(\M)\subset\psi(\M)\). Thus for each \(\psi_i\),
    like \(\psi\), we have \(\barb_i\) and \(\theta_i\) s.t. \(\abs{\{w:\theta_i(b_{i,1},\dots,b_{i,k-1},w)\}=s_i}\) for
    some \(s_i\in\omega\). Let \(\psi'_i\) be
    \begin{equation*}
    \psi_i(\barv)\wedge\abs{\{w:\theta(v_1,\dots,v_{k-1},w)\}}=s
    \end{equation*}
    Thus we have a partition again. By induction we have \(\RM(\psi_i)\ge\beta\) iff \(\RM(\psi_i)'\ge\beta\).
    #+LATEX: }
    Thus we may view \(\psi'\) as \psi and assume that if \(\psi(\barc)\), then \(c_k\in\acl(M,c_1,\dots,c_{k-1})\)

    Choose \(c_1,\dots,c_k\) s.t. \(\psi(\barc)\) and \(\RM(\psi)=\RM(\barc/M)\).
    #+LATEX: \wu{
    \(\varphi\in L(A)\) belongs to a unique type of rank \alpha iff \varphi is \alpha-minimal over \(A\).
    #+LATEX: }
    By permuting variables, we may assume that \(c_1,\dots,c_l\) are independent over \(M\)
    and \(\barc\in\acl(M,c_1,\dots,c_l)\) for some \(l< k\). But then, by Lemma ref:lemma6.2.17,
    \begin{equation*}
    \RM(\psi)=\RM(\barc/M)=\RM(c_1,\dots,c_l/M)
    \end{equation*}
    and \(\RM(c_1,\dots,c_l/M)=l<k\) by induction
    #+END_proof

    #+ATTR_LATEX: :options []
    #+BEGIN_lemma
    Let \(T\) be strongly minimal. Suppose that \(C\subseteq\M^{m+n}\) is definable.
    Let \(C_{\bara}=\{\barx\in\M^n:(\bara,\barx)\in C\}\) for \(\bara\in\M^m\). The
    set \(Y_{n,k}=\{\bara\in\M^m:\RM(C_{\bara})\ge k\}\) is definable for each \(k\le n\)
    #+END_lemma

    1#+BEGIN_proof
    We prove this by induction on \(n\).

    Suppose that \(n=1\). We first note that there is a number \(N\) s.t. \(\abs{C_{\bara}}<N\)
    or \(\abs{\M\setminus C_{\bara}}<N\) for all \(\bara\in\M^m\)  because otherwise the type
    \begin{equation*}
    \{\exists v_1,\dots,v_{2s}\bigwedge_{i\neq j}v_i\neq v_j\wedge\bigwedge_{i=1}^s\phi(\barw,v_i)\wedge\bigwedge_{i=s+1}^{2s}\neg\phi(\barw,v_i):s=1,2,\dots\}
    \end{equation*}
    is satisfied and a realization violates strong minimality

    Thus \(\RM(C_{\bara})\ge 1\) iff \(\abs{C_{\bara}}>N\), so \(Y_{1,1}\) is definable.
    Clearly \(Y_{1,0}=\{\bara:\exists\barw\;\barw\in C_{\bara}\}\).

    Fuck the proof. Suppose \(C=\varphi(\M,\M)\), \(C_{\bara}=\varphi(\bara,\M)\).

    Suppose that \(n=s+1\). We work by induction on \(k\).
    Clearly \(Y_{n,0}=\{\bara:\abs{\varphi(\bara,\M)}>0\}\) is definable. For \(\bara\in\M^m\),
    let \(B_{\bara}=\exists y\;\varphi(\bara,\M,y)\). If \(\RM(B_{\bara})\ge k\), then \(C_{\bara}\ge k\).
    If \(\barb\in B_{\bara}\) and \((\barb,c)\in C_{\bara}\),
    then \(\dim(\barb,c)=\dim\barb+\dim(c/\barb)\).
    Let \(A_{\bara}=\{\barb\in\M^s:\varphi(\bara,\barb,\M)\text{ is infinite}\}\). As above, there is an \(N\) (independent of \(\bara\)) s.t.
    \begin{equation*}
    \barb\in A_{\bara} \quad\text{ iff }\quad\abs{\varphi(\barb,\M)}>N
    \end{equation*}
    Thus \(A_{\bara}\) is definable and \(\RM(C_{\bara})\ge k\) iff \(\RM(A_{\bara})\ge k-1\).

    Thus \(\RM(C_{\bara})\ge k\) iff \(\RM(B_{\alpha})\ge k\) or \(\RM(A_{\bara})>k-1\), so by
    induction \(Y_{n,k}\) is definable

    Suppose that \(n=s+1\). We work by induction on \(k\).
    Clearly \(Y_{n,0}=\{\bara:\exists\barw\;\barw\in C_{\bara}\}\) is definable. For \(\bara\in\M^m\),
    let \(B_{\bara}=\{\barb\in\M^s:\exists y(\barb,y)\in C_{\bara}\}\). If \(\RM(B_{\bara})\ge k\),
    then \(\RM(C_{\bara})\ge k\).
    #+LATEX: \wu{
    Suppose \(C=\varphi(\M,\M)\), then \(C_{\bara}=\varphi(\bara,\M)\), \(B_{\bara}=\exists y\varphi(\bara,\M,y)\). Hence \(\RM(C_{\bara})\ge\RM(B_{\bara})\).
    #+LATEX: }
    If \(\barb\in B_{\bara}\) and \((\barb,c)\in C_{\bara}\),
    then \(\dim(\barb,c)=\dim\barb+\dim(c/\barb)\).
    #+LATEX: \wu{
    Seems that for arbitrary \(\barb,c\), we always have \(\dim(\barb,c)=\dim\barb+\dim(c/\barb)\).
    If \(c\) is algebraic over \(\barb\), then \(\dim(c/\barb)=0\) and basis is among \(\barb\).
    If \(c\) is independent over \(\barb\), then \(\dim(c/\barb)=1\) and suppose we have a basis \(\barb'\)
    for \(\barb\), then \(\barb'\cup\{c\}\) is independent and hence a basis for \(\barb\).
    #+LATEX: }
    Let
    \(A_{\bara}=\{\barb\in\M^s:\{y:(\barb,y)\in C_{\bara}\}\text{ is infinite}\}=\{\barb\in\M^s:\varphi(\bara,\barb,\M)\text{ is infinite}\}\).
    As above, there is an \(N\) (independent of \(\bara\)) s.t.
    \begin{equation*}
    \barb\in A_{\bara} \quad\text{ iff }\quad\abs{\varphi(\barb,\M)}>N
    \end{equation*}
    Thus \(A_{\bara}\) is definable and \(\RM(C_{\bara})\ge k\) iff \(\RM(A_{\bara})\ge k-1\)
    #+END_proof
** Forking and Independence

** Exercises
    #+BEGIN_exercise
    label:ex6.6.10
    Show that \(\RM(\bara)\ge 0\) for all \(\bara\in\M\)
    #+END_exercise

    #+BEGIN_proof
    \(\tp(\bara)\) cannot be empty
    #+END_proof

    #+BEGIN_exercise
    label:ex6.6.11
    Show that \(\RM(\bara,\barb/A)\ge\RM(\bara/A)\)
    #+END_exercise

    #+BEGIN_proof
    For any \(\varphi(\barx,\bary)\in\tp(\bara,\barb/A)\), \(\exists\bary\varphi(\barx,\bary)\in\tp(\bara/A)\). Any
    infinite disjoint family of subsets of \(\exists\bary\varphi(\M,\bary)\) is also a family in \(\tp(\M,\M)\).
    #+END_proof

* Appendix :ignore:
  #+LATEX: \appendix
** Set Theory
*** Cardinals
    \(\kappa>\aleph_0\) is *inaccessible* if \kappa is a regular limit cardinal
*** Cardinal Arithmetic
   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
   label:corA.15 
   1. If \(\abs{I}=\kappa\) and \(\abs{A_i}\le\kappa\) for all \(i\in I\), then 
      \(\abs{\bigcup A_i}\le\kappa\)
   2. If \kappa is regular, \(\abs{I}<\kappa\) and \(\abs{A_i}<\kappa\) for all 
      \(i\in I\), then \(\abs{\bigcup A_i}<\kappa\)
   3. Let \kappa be an infinite cardinal. Let $X$ be a set and \(\calf\) a set of
      functions \(f:X^{n_f}\to X\). Suppose that \(\abs{\calf}\le\kappa\) and
      \(A\subseteq X\) with \(\abs{A}\le\kappa\). Let \(\cl(A)\) be the smallest
      subset of $X$ containing $A$ closed under the functions in \(\calf\). Then 
      \(\abs{\cl(A)}\le\kappa\)
   #+END_corollary

   #+ATTR_LATEX: :options []
   #+BEGIN_lemma
   Let \kappa, \lambda, and \mu be cardinals
   1. \((\kappa^\lambda)^\mu=\kappa^{\lambda\mu}\)
   2. if \(\lambda\ge\aleph_0\) and \(2\le\kappa<\lambda\), then \(2^\lambda=\kappa^\lambda=\lambda^\lambda\)
   3. if \kappa is regular and \(\lambda<\kappa\), then \(\kappa^\lambda=\sup\{\kappa,\mu^\lambda:\mu<\kappa\}\)
   #+END_lemma

   #+BEGIN_proof
   3. [@3] If \(f:\lambda\to\kappa\), because \kappa is regular, then is \(\alpha<\kappa\) s.t. \(f:\lambda\to\alpha\). Thus
      \(\kappa^\lambda=\bigcup_{\alpha<\kappa}\alpha^\lambda\). The right-hand side is the union of \kappa sets each of size \(\mu^\lambda\) for some \(\mu<\kappa\)
   #+END_proof

   An inaccessible cardinal \kappa is *storngly inaccessible* if \(2^\lambda<\kappa\) for all \(\lambda<\kappa\)

   #+ATTR_LATEX: :options []
   #+BEGIN_corollary
   If \kappa is strongly inaccessible and \(\lambda<\kappa\), then \(\kappa^\lambda=\kappa\).
   #+END_corollary
*** Finite Branching Trees
    #+ATTR_LATEX: :options []
    #+BEGIN_definition
    A *finite branching tree* is a partial order \((T,<)\) s.t.
    1. there is \(r\in T\) s.t. \(r\le x\) for all \(x\in T\)
    2. if \(x\in T\), then \(\{y:y<x\}\) is finite and linearly ordered by <
    3. if \(x\in T\), then there is a finite (possibly empty) set \(\{y_1,\dots,y_m\}\) of incomparable
       elements s.t. each \(y_i>x\) and if \(z>x\), then \(z\ge y_i\) for some \(i\)
    #+END_definition

    A *path* through \(T\) is a function \(f:\omega\to T\) s.t. \(f(n)<f(n+1)\) for all \(n\)

    #+ATTR_LATEX: :options [Kőnig's Lemma]
    #+BEGIN_lemma
    label:lemmaA.21
    If \(T\) is an infinite finite branching tree, then there is a path through \(T\)
    #+END_lemma

    #+BEGIN_proof
    Let \(S(x)=\{y:y\ge x\}\) for \(x\in T\). We inductively define \(f(n)\) s.t. \(S(f(n))\) is infinite
    for all \(n\). Let \(r\) be the minimal element of \(T\), then \(S(r)\) is infinite.
    Let \(f(0)=r\). Given \(f(n)\), let \(\{y_1,\dots,y_m\}\) be the immediate successors of \(f(n)\).
    Because \(S(f(n))=S(y_1)\cup\dots\cup S(y_n)\), \(S(y_i)\) is infinite for some \(i\). Let \(f(n+1)=y_i\).
    #+END_proof


* Reference
  bibliographystyle:alpha
  bibliography:~/notes/references.bib
* Index
  \renewcommand{\indexname}{}
  printindex:nil
  \appendix
[fn:stack]  [[https://math.stackexchange.com/questions/1170953/let-alpha-be-any-cardinal-there-are-at-most-2-alpha-cup-mathscrl][stackexchange]]
[fn:proofkappa] [[https://proofwiki.org/wiki/Field_of_Uncountable_Cardinality_K_has_Transcendence_Degree_K][proofwiki]]
* Problems :ignore:
    [[CANT UNDERSTAND]]


    [[Problem2]]: done


    [[Problem3]]: done


    [[Problem4]]: done


    [[Problem5]]

    [[Problem6]]

    [[Problem7]]

    [[Problem8]]

    [[Problem9]]

    [[Problem10]]

    ref:ex4.5.2

    [[Problem11]]

* Footnotes :ignore:

[fn:EM] \(\caln\vDash T\) on book, but \(\caln\vDash T^*\) is also true and it's used later
